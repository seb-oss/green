/*! For license information please see 852.a75651b6.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkgreen=self.webpackChunkgreen||[]).push([[852],{"./node_modules/billboard.js/dist-esm/billboard.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function pointer(event,node){if(event=function sourceEvent(event){let sourceEvent;for(;sourceEvent=event.sourceEvent;)event=sourceEvent;return event}(event),void 0===node&&(node=event.currentTarget),node){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,[(point=point.matrixTransform(node.getScreenCTM().inverse())).x,point.y]}if(node.getBoundingClientRect){var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}}return[event.pageX,event.pageY]}function none(){}function selector(selector){return null==selector?none:function(){return this.querySelector(selector)}}function array(x){return null==x?[]:Array.isArray(x)?x:Array.from(x)}function empty(){return[]}function selectorAll(selector){return null==selector?empty:function(){return this.querySelectorAll(selector)}}function matcher(selector){return function(){return this.matches(selector)}}function childMatcher(selector){return function(node){return node.matches(selector)}}__webpack_require__.d(__webpack_exports__,{Wc:()=>billboard_area,M0:()=>bar,Ay:()=>bb,nq:()=>donut,n8:()=>line,rL:()=>billboard_pie,Y7:()=>spline});var find=Array.prototype.find;function childFirst(){return this.firstElementChild}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function sparse(update){return new Array(update.length)}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue=new Map,groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=key.call(node,node.__data__,i,group)+"",nodeByKeyValue.has(keyValue)?exit[i]=node:nodeByKeyValue.set(keyValue,node));for(i=0;i<dataLength;++i)keyValue=key.call(parent,data[i],i,data)+"",(node=nodeByKeyValue.get(keyValue))?(update[i]=node,node.__data__=data[i],nodeByKeyValue.delete(keyValue)):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue.get(keyValues[i])===node&&(exit[i]=node)}function datum(node){return node.__data__}function arraylike(data){return"object"==typeof data&&"length"in data?data:Array.from(data)}function ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,value){return function(){this.setAttribute(name,value)}}function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}function src_window(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView}function styleRemove(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}}function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}function styleValue(node,name){return node.style.getPropertyValue(name)||src_window(node).getComputedStyle(node,null).getPropertyValue(name)}function propertyRemove(name){return function(){delete this[name]}}function propertyConstant(name,value){return function(){this[name]=value}}function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function classedTrue(names){return function(){classedAdd(this,names)}}function classedFalse(names){return function(){classedRemove(this,names)}}function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}function textRemove(){this.textContent=""}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}function htmlRemove(){this.innerHTML=""}function htmlConstant(value){return function(){this.innerHTML=value}}function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}}function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}function creator(name){var fullname=namespace(name);return(fullname.local?creatorFixed:creatorInherit)(fullname)}function constantNull(){return null}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function selection_cloneShallow(){var clone=this.cloneNode(!1),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function selection_cloneDeep(){var clone=this.cloneNode(!0),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.options);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,options){return function(){var o,on=this.__on,listener=function contextListener(listener){return function(event){listener.call(this,event,this.__data__)}}(value);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=listener,o.options=options),void(o.value=value);this.addEventListener(typename.type,listener,options),o={type:typename.type,name:typename.name,value,listener,options},on?on.push(o):this.__on=[o]}}function dispatchEvent(node,type,params){var window=src_window(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}}function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var root=[null];function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}Selection.prototype=selection.prototype={constructor:Selection,select:function selection_select(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)},selectAll:function selectAll(select){select="function"==typeof select?function arrayAll(select){return function(){return array(select.apply(this,arguments))}}(select):selectorAll(select);for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)},selectChild:function selectChild(match){return this.select(null==match?childFirst:function childFind(match){return function(){return find.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},selectChildren:function selectChildren(match){return this.selectAll(null==match?children:function childrenFilter(match){return function(){return filter.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},filter:function selection_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)},data:function data(value,key){if(!arguments.length)return Array.from(this,datum);var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=function src_constant(x){return function(){return x}}(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=arraylike(value.call(parent,parent&&parent.__data__,j,parents)),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return(update=new Selection(update,parents))._enter=enter,update._exit=exit,update},enter:function enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)},exit:function exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)},join:function join(onenter,onupdate,onexit){var enter=this.enter(),update=this,exit=this.exit();return"function"==typeof onenter?(enter=onenter(enter))&&(enter=enter.selection()):enter=enter.append(onenter+""),null!=onupdate&&(update=onupdate(update))&&(update=update.selection()),null==onexit?exit.remove():onexit(exit),enter&&update?enter.merge(update).order():update},merge:function merge(context){for(var selection=context.selection?context.selection():context,groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)},selection:function selection_selection(){return this},order:function order(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&4^node.compareDocumentPosition(next)&&next.parentNode.insertBefore(node,next),next=node);return this},sort:function sort(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()},call:function call(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},nodes:function nodes(){return Array.from(this)},node:function node(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},size:function size(){let size=0;for(const node of this)++size;return size},empty:function selection_empty(){return!this.node()},each:function each(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},attr:function attr(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?attrRemoveNS:attrRemove:"function"==typeof value?fullname.local?attrFunctionNS:attrFunction:fullname.local?attrConstantNS:attrConstant)(fullname,value))},style:function style(name,value,priority){return arguments.length>1?this.each((null==value?styleRemove:"function"==typeof value?styleFunction:styleConstant)(name,value,null==priority?"":priority)):styleValue(this.node(),name)},property:function property(name,value){return arguments.length>1?this.each((null==value?propertyRemove:"function"==typeof value?propertyFunction:propertyConstant)(name,value)):this.node()[name]},classed:function classed(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?classedFunction:value?classedTrue:classedFalse)(names,value))},text:function selection_text(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?textFunction:textConstant)(value)):this.node().textContent},html:function html(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?htmlFunction:htmlConstant)(value)):this.node().innerHTML},raise:function selection_raise(){return this.each(raise)},lower:function selection_lower(){return this.each(lower)},append:function append(name){var create="function"==typeof name?name:creator(name);return this.select(function(){return this.appendChild(create.apply(this,arguments))})},insert:function insert(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select(function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)})},remove:function selection_remove(){return this.each(remove)},clone:function clone(deep){return this.select(deep?selection_cloneDeep:selection_cloneShallow)},datum:function selection_datum(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function on(typename,value,options){var i,t,typenames=function parseTypenames(typenames){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name}})}(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,i=0;i<n;++i)this.each(on(typenames[i],value,options));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},dispatch:function dispatch(type,params){return this.each(("function"==typeof params?dispatchFunction:dispatchConstant)(type,params))},[Symbol.iterator]:function*iterator(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&(yield node)}};const src_selection=selection;function src_select(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)}function src_selectAll(selector){return"string"==typeof selector?new Selection([document.querySelectorAll(selector)],[document.documentElement]):new Selection([array(selector)],root)}const t0=new Date,t1=new Date;function timeInterval(floori,offseti,count,field){function interval(date){return floori(date=0===arguments.length?new Date:new Date(+date)),date}return interval.floor=date=>(floori(date=new Date(+date)),date),interval.ceil=date=>(floori(date=new Date(date-1)),offseti(date,1),floori(date),date),interval.round=date=>{const d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1},interval.offset=(date,step)=>(offseti(date=new Date(+date),null==step?1:Math.floor(step)),date),interval.range=(start,stop,step)=>{const range=[];if(start=interval.ceil(start),step=null==step?1:Math.floor(step),!(start<stop&&step>0))return range;let previous;do{range.push(previous=new Date(+start)),offseti(start,step),floori(start)}while(previous<start&&start<stop);return range},interval.filter=test=>timeInterval(date=>{if(date>=date)for(;floori(date),!test(date);)date.setTime(date-1)},(date,step)=>{if(date>=date)if(step<0)for(;++step<=0;)for(;offseti(date,-1),!test(date););else for(;--step>=0;)for(;offseti(date,1),!test(date););}),count&&(interval.count=(start,end)=>(t0.setTime(+start),t1.setTime(+end),floori(t0),floori(t1),Math.floor(count(t0,t1))),interval.every=step=>(step=Math.floor(step),isFinite(step)&&step>0?step>1?interval.filter(field?d=>field(d)%step===0:d=>interval.count(0,d)%step===0):interval:null)),interval}function timeWeekday(i){return timeInterval(date=>{date.setDate(date.getDate()-(date.getDay()+7-i)%7),date.setHours(0,0,0,0)},(date,step)=>{date.setDate(date.getDate()+7*step)},(start,end)=>(end-start-6e4*(end.getTimezoneOffset()-start.getTimezoneOffset()))/6048e5)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range,timeMonday.range,timeTuesday.range,timeWednesday.range,timeThursday.range,timeFriday.range,timeSaturday.range;function utcWeekday(i){return timeInterval(date=>{date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7),date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCDate(date.getUTCDate()+7*step)},(start,end)=>(end-start)/6048e5)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),timeDay=(utcSunday.range,utcMonday.range,utcTuesday.range,utcWednesday.range,utcThursday.range,utcFriday.range,utcSaturday.range,timeInterval(date=>date.setHours(0,0,0,0),(date,step)=>date.setDate(date.getDate()+step),(start,end)=>(end-start-6e4*(end.getTimezoneOffset()-start.getTimezoneOffset()))/864e5,date=>date.getDate()-1)),utcDay=(timeDay.range,timeInterval(date=>{date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCDate(date.getUTCDate()+step)},(start,end)=>(end-start)/864e5,date=>date.getUTCDate()-1)),unixDay=(utcDay.range,timeInterval(date=>{date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCDate(date.getUTCDate()+step)},(start,end)=>(end-start)/864e5,date=>Math.floor(date/864e5))),timeYear=(unixDay.range,timeInterval(date=>{date.setMonth(0,1),date.setHours(0,0,0,0)},(date,step)=>{date.setFullYear(date.getFullYear()+step)},(start,end)=>end.getFullYear()-start.getFullYear(),date=>date.getFullYear()));timeYear.every=k=>isFinite(k=Math.floor(k))&&k>0?timeInterval(date=>{date.setFullYear(Math.floor(date.getFullYear()/k)*k),date.setMonth(0,1),date.setHours(0,0,0,0)},(date,step)=>{date.setFullYear(date.getFullYear()+step*k)}):null;timeYear.range;const utcYear=timeInterval(date=>{date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCFullYear(date.getUTCFullYear()+step)},(start,end)=>end.getUTCFullYear()-start.getUTCFullYear(),date=>date.getUTCFullYear());utcYear.every=k=>isFinite(k=Math.floor(k))&&k>0?timeInterval(date=>{date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k),date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCFullYear(date.getUTCFullYear()+step*k)}):null;utcYear.range;function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return date.setFullYear(d.y),date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return date.setUTCFullYear(d.y),date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newDate(y,m,d){return{y,m,d,H:0,M:0,S:0,L:0}}var locale,timeFormat,timeParse,utcFormat,utcParse,pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){return new Map(names.map((name,i)=>[name.toLowerCase(),i]))}function parseWeekdayNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekdayNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.u=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberISO(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.V=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseQuarter(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.q=3*n[0]-3,i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseMicroseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+6));return n?(d.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function parseUnixTimestamp(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=+n[0],i+n[0].length):-1}function parseUnixTimestampSeconds(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.s=+n[0],i+n[0].length):-1}function formatDayOfMonth(d,p){return pad(d.getDate(),p,2)}function formatHour24(d,p){return pad(d.getHours(),p,2)}function formatHour12(d,p){return pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return pad(1+timeDay.count(timeYear(d),d),p,3)}function formatMilliseconds(d,p){return pad(d.getMilliseconds(),p,3)}function formatMicroseconds(d,p){return formatMilliseconds(d,p)+"000"}function formatMonthNumber(d,p){return pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return pad(d.getSeconds(),p,2)}function formatWeekdayNumberMonday(d){var day=d.getDay();return 0===day?7:day}function formatWeekNumberSunday(d,p){return pad(timeSunday.count(timeYear(d)-1,d),p,2)}function dISO(d){var day=d.getDay();return day>=4||0===day?timeThursday(d):timeThursday.ceil(d)}function formatWeekNumberISO(d,p){return d=dISO(d),pad(timeThursday.count(timeYear(d),d)+(4===timeYear(d).getDay()),p,2)}function formatWeekdayNumberSunday(d){return d.getDay()}function formatWeekNumberMonday(d,p){return pad(timeMonday.count(timeYear(d)-1,d),p,2)}function formatYear(d,p){return pad(d.getFullYear()%100,p,2)}function formatYearISO(d,p){return pad((d=dISO(d)).getFullYear()%100,p,2)}function formatFullYear(d,p){return pad(d.getFullYear()%1e4,p,4)}function formatFullYearISO(d,p){var day=d.getDay();return pad((d=day>=4||0===day?timeThursday(d):timeThursday.ceil(d)).getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+pad(z/60|0,"0",2)+pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return pad(1+utcDay.count(utcYear(d),d),p,3)}function formatUTCMilliseconds(d,p){return pad(d.getUTCMilliseconds(),p,3)}function formatUTCMicroseconds(d,p){return formatUTCMilliseconds(d,p)+"000"}function formatUTCMonthNumber(d,p){return pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return pad(d.getUTCSeconds(),p,2)}function formatUTCWeekdayNumberMonday(d){var dow=d.getUTCDay();return 0===dow?7:dow}function formatUTCWeekNumberSunday(d,p){return pad(utcSunday.count(utcYear(d)-1,d),p,2)}function UTCdISO(d){var day=d.getUTCDay();return day>=4||0===day?utcThursday(d):utcThursday.ceil(d)}function formatUTCWeekNumberISO(d,p){return d=UTCdISO(d),pad(utcThursday.count(utcYear(d),d)+(4===utcYear(d).getUTCDay()),p,2)}function formatUTCWeekdayNumberSunday(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return pad(utcMonday.count(utcYear(d)-1,d),p,2)}function formatUTCYear(d,p){return pad(d.getUTCFullYear()%100,p,2)}function formatUTCYearISO(d,p){return pad((d=UTCdISO(d)).getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCFullYearISO(d,p){var day=d.getUTCDay();return pad((d=day>=4||0===day?utcThursday(d):utcThursday.ceil(d)).getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(d){return+d}function formatUnixTimestampSeconds(d){return Math.floor(+d/1e3)}!function defaultLocale(definition){return locale=function formatLocale(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths,periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths),formats={a:function formatShortWeekday(d){return locale_shortWeekdays[d.getDay()]},A:function formatWeekday(d){return locale_weekdays[d.getDay()]},b:function formatShortMonth(d){return locale_shortMonths[d.getMonth()]},B:function formatMonth(d){return locale_months[d.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function formatPeriod(d){return locale_periods[+(d.getHours()>=12)]},q:function formatQuarter(d){return 1+~~(d.getMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},utcFormats={a:function formatUTCShortWeekday(d){return locale_shortWeekdays[d.getUTCDay()]},A:function formatUTCWeekday(d){return locale_weekdays[d.getUTCDay()]},b:function formatUTCShortMonth(d){return locale_shortMonths[d.getUTCMonth()]},B:function formatUTCMonth(d){return locale_months[d.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function formatUTCPeriod(d){return locale_periods[+(d.getUTCHours()>=12)]},q:function formatUTCQuarter(d){return 1+~~(d.getUTCMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},parses={a:function parseShortWeekday(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup.get(n[0].toLowerCase()),i+n[0].length):-1},A:function parseWeekday(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup.get(n[0].toLowerCase()),i+n[0].length):-1},b:function parseShortMonth(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup.get(n[0].toLowerCase()),i+n[0].length):-1},B:function parseMonth(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup.get(n[0].toLowerCase()),i+n[0].length):-1},c:function parseLocaleDateTime(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function parsePeriod(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup.get(n[0].toLowerCase()),i+n[0].length):-1},q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function parseLocaleDate(d,string,i){return parseSpecifier(d,locale_date,string,i)},X:function parseLocaleTime(d,string,i){return parseSpecifier(d,locale_time,string,i)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function newFormat(specifier,formats){return function(date){var c,pad,format,string=[],i=-1,j=0,n=specifier.length;for(date instanceof Date||(date=new Date(+date));++i<n;)37===specifier.charCodeAt(i)&&(string.push(specifier.slice(j,i)),null!=(pad=pads[c=specifier.charAt(++i)])?c=specifier.charAt(++i):pad="e"===c?" ":"0",(format=formats[c])&&(c=format(date,pad)),string.push(c),j=i+1);return string.push(specifier.slice(j,i)),string.join("")}}function newParse(specifier,Z){return function(string){var week,day,d=newDate(1900,void 0,1);if(parseSpecifier(d,specifier,string+="",0)!=string.length)return null;if("Q"in d)return new Date(d.Q);if("s"in d)return new Date(1e3*d.s+("L"in d?d.L:0));if(Z&&!("Z"in d)&&(d.Z=0),"p"in d&&(d.H=d.H%12+12*d.p),void 0===d.m&&(d.m="q"in d?d.q:0),"V"in d){if(d.V<1||d.V>53)return null;"w"in d||(d.w=1),"Z"in d?(day=(week=utcDate(newDate(d.y,0,1))).getUTCDay(),week=day>4||0===day?utcMonday.ceil(week):utcMonday(week),week=utcDay.offset(week,7*(d.V-1)),d.y=week.getUTCFullYear(),d.m=week.getUTCMonth(),d.d=week.getUTCDate()+(d.w+6)%7):(day=(week=localDate(newDate(d.y,0,1))).getDay(),week=day>4||0===day?timeMonday.ceil(week):timeMonday(week),week=timeDay.offset(week,7*(d.V-1)),d.y=week.getFullYear(),d.m=week.getMonth(),d.d=week.getDate()+(d.w+6)%7)}else("W"in d||"U"in d)&&("w"in d||(d.w="u"in d?d.u%7:"W"in d?1:0),day="Z"in d?utcDate(newDate(d.y,0,1)).getUTCDay():localDate(newDate(d.y,0,1)).getDay(),d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(day+5)%7:d.w+7*d.U-(day+6)%7);return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,utcDate(d)):localDate(d)}}function parseSpecifier(d,specifier,string,j){for(var c,parse,i=0,n=specifier.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=specifier.charCodeAt(i++))){if(c=specifier.charAt(i++),!(parse=parses[c in pads?specifier.charAt(i++):c])||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}return formats.x=newFormat(locale_date,formats),formats.X=newFormat(locale_time,formats),formats.c=newFormat(locale_dateTime,formats),utcFormats.x=newFormat(locale_date,utcFormats),utcFormats.X=newFormat(locale_time,utcFormats),utcFormats.c=newFormat(locale_dateTime,utcFormats),{format:function(specifier){var f=newFormat(specifier+="",formats);return f.toString=function(){return specifier},f},parse:function(specifier){var p=newParse(specifier+="",!1);return p.toString=function(){return specifier},p},utcFormat:function(specifier){var f=newFormat(specifier+="",utcFormats);return f.toString=function(){return specifier},f},utcParse:function(specifier){var p=newParse(specifier+="",!0);return p.toString=function(){return specifier},p}}}(definition),timeFormat=locale.format,timeParse=locale.parse,utcFormat=locale.utcFormat,utcParse=locale.utcParse,locale}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var noop={value:()=>{}};function dispatch_dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _||/[\s.]/.test(t))throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name,value:callback}),type}Dispatch.prototype=dispatch_dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=function dispatch_parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name}})}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};const src_dispatch=dispatch_dispatch,nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation(event){event.stopImmediatePropagation()}function noevent(event){event.preventDefault(),event.stopImmediatePropagation()}function nodrag(view){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",noevent,nonpassivecapture);"onselectstart"in root?selection.on("selectstart.drag",noevent,nonpassivecapture):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")}function yesdrag(view,noclick){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,nonpassivecapture),setTimeout(function(){selection.on("click.drag",null)},0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function src_define(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor}function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}var brighter=1/.7,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatRgb(){return this.rgb().formatRgb()}function color(format){var m,l;return format=(format+"").trim().toLowerCase(),(m=reHex.exec(format))?(l=m[1].length,m=parseInt(m[1],16),6===l?rgbn(m):3===l?new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):8===l?rgba(m>>24&255,m>>16&255,m>>8&255,(255&m)/255):4===l?rgba(m>>12&15|m>>8&240,m>>8&15|m>>4&240,m>>4&15|240&m,((15&m)<<4|15&m)/255):null):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function color_rgb(r,g,b,opacity){return 1===arguments.length?function rgbConvert(o){return o instanceof Color||(o=color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatRgb(){const a=clampa(this.opacity);return`${1===a?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${1===a?")":`, ${a})`}`}function clampa(opacity){return isNaN(opacity)?1:Math.max(0,Math.min(1,opacity))}function clampi(value){return Math.max(0,Math.min(255,Math.round(value)||0))}function hex(value){return((value=clampi(value))<16?"0":"")+value.toString(16)}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function clamph(value){return(value=(value||0)%360)<0?value+360:value}function clampt(value){return Math.max(0,Math.min(1,value||0))}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}src_define(Color,color,{copy(channels){return Object.assign(new this.constructor,this,channels)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:function color_formatHex8(){return this.rgb().formatHex8()},formatHsl:function color_formatHsl(){return hslConvert(this).formatHsl()},formatRgb:color_formatRgb,toString:color_formatRgb}),src_define(Rgb,color_rgb,extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),src_define(Hsl,function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)},extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const a=clampa(this.opacity);return`${1===a?"hsl(":"hsla("}${clamph(this.h)}, ${100*clampt(this.s)}%, ${100*clampt(this.l)}%${1===a?")":`, ${a})`}`}}));const d3_interpolate_src_constant=x=>()=>x;function linear(a,d){return function(t){return a+t*d}}function gamma(y){return 1===(y=+y)?nogamma:function(a,b){return b-a?function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):d3_interpolate_src_constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):d3_interpolate_src_constant(isNaN(a)?b:a)}const rgb=function rgbGamma(y){var color=gamma(y);function rgb(start,end){var r=color((start=color_rgb(start)).r,(end=color_rgb(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(spline){return function(colors){var i,color,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color=color_rgb(colors[i]),r[i]=color.r||0,g[i]=color.g||0,b[i]=color.b||0;return r=spline(r),g=spline(g),b=spline(b),color.opacity=1,function(t){return color.r=r(t),color.g=g(t),color.b=b(t),color+""}}}rgbSpline(function src_basis(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}}),rgbSpline(function basisClosed(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}});function genericArray(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(na),c=new Array(nb);for(i=0;i<na;++i)x[i]=value(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}}function date(a,b){var d=new Date;return a=+a,b=+b,function(t){return d.setTime(a*(1-t)+b*t),d}}function number(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}}function object(a,b){var k,i={},c={};for(k in null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b)k in a?i[k]=value(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function string(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i,x:number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function one(b){return function(t){return b(t)+""}}(q[0].x):function zero(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}function src_numberArray(a,b){b||(b=[]);var i,n=a?Math.min(b.length,a.length):0,c=b.slice();return function(t){for(i=0;i<n;++i)c[i]=a[i]*(1-t)+b[i]*t;return c}}function value(a,b){var c,t=typeof b;return null==b||"boolean"===t?d3_interpolate_src_constant(b):("number"===t?number:"string"===t?(c=color(b))?(b=c,rgb):string:b instanceof color?rgb:b instanceof Date?date:function numberArray_isNumberArray(x){return ArrayBuffer.isView(x)&&!(x instanceof DataView)}(b)?src_numberArray:Array.isArray(b)?genericArray:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?object:number)(a,b)}var taskHead,taskTail,timer_frame=0,timeout=0,interval=0,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function wake(){clockNow=(clockLast=clock.now())+clockSkew,timer_frame=timeout=0;try{!function timerFlush(){now(),++timer_frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(void 0,e),t=t._next;--timer_frame}()}finally{timer_frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>1e3&&(clockSkew-=delay,clockLast=now)}function sleep(time){timer_frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,1e3)),timer_frame=1,setFrame(wake)))}function src_timeout(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(elapsed=>{t.stop(),callback(elapsed+delay)},delay,time),t}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=src_dispatch("start","end","cancel","interrupt"),emptyTween=[];function schedule(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};!function create(node,id,self){var tween,schedules=node.__transition;function schedule(elapsed){self.state=1,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)}function start(elapsed){var i,j,n,o;if(1!==self.state)return stop();for(i in schedules)if((o=schedules[i]).name===self.name){if(3===o.state)return src_timeout(start);4===o.state?(o.state=6,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=6,o.timer.stop(),o.on.call("cancel",node,node.__data__,o.index,o.group),delete schedules[i])}if(src_timeout(function(){3===self.state&&(self.state=4,self.timer.restart(tick,self.delay,self.time),tick(elapsed))}),self.state=2,self.on.call("start",node,node.__data__,self.index,self.group),2===self.state){for(self.state=3,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=5,1),i=-1,n=tween.length;++i<n;)tween[i].call(node,t);5===self.state&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){for(var i in self.state=6,self.timer.stop(),delete schedules[id],schedules)return;delete node.__transition}schedules[id]=self,self.timer=timer(schedule,0,self.time)}(node,id,{name,index,group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:0})}function init(node,id){var schedule=schedule_get(node,id);if(schedule.state>0)throw new Error("too late; already scheduled");return schedule}function schedule_set(node,id){var schedule=schedule_get(node,id);if(schedule.state>3)throw new Error("too late; already running");return schedule}function schedule_get(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}function interrupt(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){for(i in name=null==name?null:name+"",schedules)(schedule=schedules[i]).name===name?(active=schedule.state>2&&schedule.state<5,schedule.state=6,schedule.timer.stop(),schedule.on.call(active?"interrupt":"cancel",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}}var svgNode,degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX,scaleY}}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform(function parseCss(value){const m=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(value+"");return m.isIdentity?identity:decompose(m.a,m.b,m.c,m.d,m.e,m.f)},"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(function parseSvg(value){return null==value?identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?decompose((value=value.matrix).a,value.b,value.c,value.d,value.e,value.f):identity)},", ",")",")");function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0)for(var i=0,n=(tween1=tween0=tween).length;i<n;++i)if(tween1[i].name===name){(tween1=tween1.slice()).splice(i,1);break}schedule.tween=tween1}}function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name,value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}}function tweenValue(transition,name,value){var id=transition._id;return transition.each(function(){var schedule=schedule_set(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)}),function(node){return schedule_get(node,id).value[name]}}function interpolate(a,b){var c;return("number"==typeof b?number:b instanceof color?rgb:(c=color(b))?(b=c,rgb):string)(a,b)}function attr_attrRemove(name){return function(){this.removeAttribute(name)}}function attr_attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attr_attrConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttribute(name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrConstantNS(fullname,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttributeNS(fullname.space,fullname.local);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttribute(name))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttribute(name)}}function attr_attrFunctionNS(fullname,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttributeNS(fullname.space,fullname.local))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttributeNS(fullname.space,fullname.local)}}function attrTweenNS(fullname,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolateNS(fullname,i){return function(t){this.setAttributeNS(fullname.space,fullname.local,i.call(this,t))}}(fullname,i)),t0}return tween._value=value,tween}function attrTween(name,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolate(name,i){return function(t){this.setAttribute(name,i.call(this,t))}}(name,i)),t0}return tween._value=value,tween}function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}}function durationFunction(id,value){return function(){schedule_set(this,id).duration=+value.apply(this,arguments)}}function durationConstant(id,value){return value=+value,function(){schedule_set(this,id).duration=value}}var selection_Selection=src_selection.prototype.constructor;function style_styleRemove(name){return function(){this.style.removeProperty(name)}}var id=0;function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function transition_transition(name){return src_selection().transition(name)}function newId(){return++id}var selection_prototype=src_selection.prototype;Transition.prototype=transition_transition.prototype={constructor:Transition,select:function transition_select(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,schedule_get(node,id)));return new Transition(subgroups,this._parents,name,id)},selectAll:function transition_selectAll(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=schedule_get(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:function transition_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},merge:function transition_merge(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},selection:function transition_selection(){return new selection_Selection(this._groups,this._parents)},transition:function transition(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=schedule_get(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:function transition_on(name,listener){var id=this._id;return arguments.length<2?schedule_get(this.node(),id).on.on(name):this.each(function onFunction(id,name,listener){var on0,on1,sit=function start(name){return(name+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t})}(name)?init:schedule_set;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}(id,name,listener))},attr:function transition_attr(name,value){var fullname=namespace(name),i="transform"===fullname?interpolateTransformSvg:interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?attr_attrFunctionNS:attr_attrFunction)(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?attr_attrRemoveNS:attr_attrRemove)(fullname):(fullname.local?attr_attrConstantNS:attr_attrConstant)(fullname,i,value))},attrTween:function transition_attrTween(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=namespace(name);return this.tween(key,(fullname.local?attrTweenNS:attrTween)(fullname,value))},style:function transition_style(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:interpolate;return null==value?this.styleTween(name,function styleNull(name,interpolate){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),string1=(this.style.removeProperty(name),styleValue(this,name));return string0===string1?null:string0===string00&&string1===string10?interpolate0:interpolate0=interpolate(string00=string0,string10=string1)}}(name,i)).on("end.style."+name,style_styleRemove(name)):"function"==typeof value?this.styleTween(name,function style_styleFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),value1=value(this),string1=value1+"";return null==value1&&(this.style.removeProperty(name),string1=value1=styleValue(this,name)),string0===string1?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1))}}(name,i,tweenValue(this,"style."+name,value))).each(function styleMaybeRemove(id,name){var on0,on1,listener0,remove,key="style."+name,event="end."+key;return function(){var schedule=schedule_set(this,id),on=schedule.on,listener=null==schedule.value[key]?remove||(remove=style_styleRemove(name)):void 0;on===on0&&listener0===listener||(on1=(on0=on).copy()).on(event,listener0=listener),schedule.on=on1}}(this._id,name)):this.styleTween(name,function style_styleConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=styleValue(this,name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}(name,i,value),priority).on("end.style."+name,null)},styleTween:function transition_styleTween(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function styleTween(name,value,priority){var t,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t=(i0=i)&&function styleInterpolate(name,i,priority){return function(t){this.style.setProperty(name,i.call(this,t),priority)}}(name,i,priority)),t}return tween._value=value,tween}(name,value,null==priority?"":priority))},text:function transition_text(value){return this.tween("text","function"==typeof value?function text_textFunction(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}(tweenValue(this,"text",value)):function text_textConstant(value){return function(){this.textContent=value}}(null==value?"":value+""))},textTween:function transition_textTween(value){var key="text";if(arguments.length<1)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function textTween(value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function textInterpolate(i){return function(t){this.textContent=i.call(this,t)}}(i)),t0}return tween._value=value,tween}(value))},remove:function transition_remove(){return this.on("end.remove",function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}(this._id))},tween:function tween(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=schedule_get(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?tweenRemove:tweenFunction)(id,name,value))},delay:function delay(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?delayFunction:delayConstant)(id,value)):schedule_get(this.node(),id).delay},duration:function duration(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?durationFunction:durationConstant)(id,value)):schedule_get(this.node(),id).duration},ease:function ease(value){var id=this._id;return arguments.length?this.each(function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){schedule_set(this,id).ease=value}}(id,value)):schedule_get(this.node(),id).ease},easeVarying:function transition_easeVarying(value){if("function"!=typeof value)throw new Error;return this.each(function easeVarying(id,value){return function(){var v=value.apply(this,arguments);if("function"!=typeof v)throw new Error;schedule_set(this,id).ease=v}}(this._id,value))},end:function end(){var on0,on1,that=this,id=that._id,size=that.size();return new Promise(function(resolve,reject){var cancel={value:reject},end={value:function(){0===--size&&resolve()}};that.each(function(){var schedule=schedule_set(this,id),on=schedule.on;on!==on0&&((on1=(on0=on).copy())._.cancel.push(cancel),on1._.interrupt.push(cancel),on1._.end.push(end)),schedule.on=on1}),0===size&&resolve()})},[Symbol.iterator]:selection_prototype[Symbol.iterator]};var defaultTiming={time:null,delay:0,duration:250,ease:function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))throw new Error(`transition ${id} not found`);return timing}src_selection.prototype.interrupt=function selection_interrupt(name){return this.each(function(){interrupt(this,name)})},src_selection.prototype.transition=function selection_transition(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};const{abs,max,min}=Math;function number1(e){return[+e[0],+e[1]]}function number2(e){return[number1(e[0]),number1(e[1])]}["w","e"].map(type),["n","s"].map(type),["n","w","e","s","nw","ne","sw","se"].map(type);function type(t){return{type:t}}function brushSelection(node){var state=node.__brush;return state?state.dim.output(state.selection):null}var EOL={},EOF={};function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+'] || ""'}).join(",")+"}")}function inferColumns(rows){var columnSet=Object.create(null),columns=[];return rows.forEach(function(row){for(var column in row)column in columnSet||columns.push(columnSet[column]=column)}),columns}function dsv_pad(value,width){var s=value+"",length=s.length;return length<width?new Array(width-length+1).join(0)+s:s}function formatDate(date){var hours=date.getUTCHours(),minutes=date.getUTCMinutes(),seconds=date.getUTCSeconds(),milliseconds=date.getUTCMilliseconds();return isNaN(date)?"Invalid Date":function dsv_formatYear(year){return year<0?"-"+dsv_pad(-year,6):year>9999?"+"+dsv_pad(year,6):dsv_pad(year,4)}(date.getUTCFullYear())+"-"+dsv_pad(date.getUTCMonth()+1,2)+"-"+dsv_pad(date.getUTCDate(),2)+(milliseconds?"T"+dsv_pad(hours,2)+":"+dsv_pad(minutes,2)+":"+dsv_pad(seconds,2)+"."+dsv_pad(milliseconds,3)+"Z":seconds?"T"+dsv_pad(hours,2)+":"+dsv_pad(minutes,2)+":"+dsv_pad(seconds,2)+"Z":minutes||hours?"T"+dsv_pad(hours,2)+":"+dsv_pad(minutes,2)+"Z":"")}function dsv(delimiter){var reFormat=new RegExp('["'+delimiter+"\n\r]"),DELIMITER=delimiter.charCodeAt(0);function parseRows(text,f){var t,rows=[],N=text.length,I=0,n=0,eof=N<=0,eol=!1;function token(){if(eof)return EOF;if(eol)return eol=!1,EOL;var i,c,j=I;if(34===text.charCodeAt(j)){for(;I++<N&&34!==text.charCodeAt(I)||34===text.charCodeAt(++I););return(i=I)>=N?eof=!0:10===(c=text.charCodeAt(I++))?eol=!0:13===c&&(eol=!0,10===text.charCodeAt(I)&&++I),text.slice(j+1,i-1).replace(/""/g,'"')}for(;I<N;){if(10===(c=text.charCodeAt(i=I++)))eol=!0;else if(13===c)eol=!0,10===text.charCodeAt(I)&&++I;else if(c!==DELIMITER)continue;return text.slice(j,i)}return eof=!0,text.slice(j,N)}for(10===text.charCodeAt(N-1)&&--N,13===text.charCodeAt(N-1)&&--N;(t=token())!==EOF;){for(var row=[];t!==EOL&&t!==EOF;)row.push(t),t=token();f&&null==(row=f(row,n++))||rows.push(row)}return rows}function preformatBody(rows,columns){return rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(value){return null==value?"":value instanceof Date?formatDate(value):reFormat.test(value+="")?'"'+value.replace(/"/g,'""')+'"':value}return{parse:function parse(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?function customConverter(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}(row,f):objectConverter(row)});return rows.columns=columns||[],rows},parseRows,format:function format(rows,columns){return null==columns&&(columns=inferColumns(rows)),[columns.map(formatValue).join(delimiter)].concat(preformatBody(rows,columns)).join("\n")},formatBody:function formatBody(rows,columns){return null==columns&&(columns=inferColumns(rows)),preformatBody(rows,columns).join("\n")},formatRows:function formatRows(rows){return rows.map(formatRow).join("\n")},formatRow,formatValue}}var csv=dsv(","),csvParse=csv.parse,csvParseRows=csv.parseRows,tsv=(csv.format,csv.formatBody,csv.formatRows,csv.formatRow,csv.formatValue,dsv("\t")),tsvParse=tsv.parse,tsvParseRows=tsv.parseRows;tsv.format,tsv.formatBody,tsv.formatRows,tsv.formatRow,tsv.formatValue;const d3_drag_src_constant=x=>()=>x;function DragEvent(type,{sourceEvent,subject,target,identifier,active,x,y,dx,dy,dispatch}){Object.defineProperties(this,{type:{value:type,enumerable:!0,configurable:!0},sourceEvent:{value:sourceEvent,enumerable:!0,configurable:!0},subject:{value:subject,enumerable:!0,configurable:!0},target:{value:target,enumerable:!0,configurable:!0},identifier:{value:identifier,enumerable:!0,configurable:!0},active:{value:active,enumerable:!0,configurable:!0},x:{value:x,enumerable:!0,configurable:!0},y:{value:y,enumerable:!0,configurable:!0},dx:{value:dx,enumerable:!0,configurable:!0},dy:{value:dy,enumerable:!0,configurable:!0},_:{value:dispatch}})}function drag_defaultFilter(event){return!event.ctrlKey&&!event.button}function defaultContainer(){return this.parentNode}function defaultSubject(event,d){return null==d?{x:event.x,y:event.y}:d}function drag_defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var mousedownx,mousedowny,mousemoving,touchending,filter=drag_defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=drag_defaultTouchable,gestures={},listeners=src_dispatch("start","drag","end"),active=0,clickDistance2=0;function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved,nonpassive).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(event,d){if(!touchending&&filter.call(this,event,d)){var gesture=beforestart(this,container.call(this,event,d),event,d,"mouse");gesture&&(src_select(event.view).on("mousemove.drag",mousemoved,nonpassivecapture).on("mouseup.drag",mouseupped,nonpassivecapture),nodrag(event.view),nopropagation(event),mousemoving=!1,mousedownx=event.clientX,mousedowny=event.clientY,gesture("start",event))}}function mousemoved(event){if(noevent(event),!mousemoving){var dx=event.clientX-mousedownx,dy=event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag",event)}function mouseupped(event){src_select(event.view).on("mousemove.drag mouseup.drag",null),yesdrag(event.view,mousemoving),noevent(event),gestures.mouse("end",event)}function touchstarted(event,d){if(filter.call(this,event,d)){var i,gesture,touches=event.changedTouches,c=container.call(this,event,d),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(this,c,event,d,touches[i].identifier,touches[i]))&&(nopropagation(event),gesture("start",event,touches[i]))}}function touchmoved(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(event),gesture("drag",event,touches[i]))}function touchended(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(event),gesture("end",event,touches[i]))}function beforestart(that,container,event,d,identifier,touch){var dx,dy,s,dispatch=listeners.copy(),p=pointer(touch||event,container);if(null!=(s=subject.call(that,new DragEvent("beforestart",{sourceEvent:event,target:drag,identifier,active,x:p[0],y:p[1],dx:0,dy:0,dispatch}),d)))return dx=s.x-p[0]||0,dy=s.y-p[1]||0,function gesture(type,event,touch){var n,p0=p;switch(type){case"start":gestures[identifier]=gesture,n=active++;break;case"end":delete gestures[identifier],--active;case"drag":p=pointer(touch||event,container),n=active}dispatch.call(type,that,new DragEvent(type,{sourceEvent:event,subject:s,target:drag,identifier,active:n,x:p[0]+dx,y:p[1]+dy,dx:p[0]-p0[0],dy:p[1]-p0[1],dispatch}),d)}}return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_drag_src_constant(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:d3_drag_src_constant(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:d3_drag_src_constant(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_drag_src_constant(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag}DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};class InternMap extends Map{constructor(entries,key=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:key}}),null!=entries)for(const[key,value]of entries)this.set(key,value)}get(key){return super.get(intern_get(this,key))}has(key){return super.has(intern_get(this,key))}set(key,value){return super.set(intern_set(this,key),value)}delete(key){return super.delete(intern_delete(this,key))}}Set;function intern_get({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):value}function intern_set({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):(_intern.set(key,value),value)}function intern_delete({_intern,_key},value){const key=_key(value);return _intern.has(key)&&(value=_intern.get(key),_intern.delete(key)),value}function keyof(value){return null!==value&&"object"==typeof value?value.valueOf():value}function initRange(domain,range){switch(arguments.length){case 0:break;case 1:this.range(domain);break;default:this.range(range).domain(domain)}return this}const implicit=Symbol("implicit");function ordinal(){var index=new InternMap,domain=[],range=[],unknown=implicit;function scale(d){let i=index.get(d);if(void 0===i){if(unknown!==implicit)return unknown;index.set(d,i=domain.push(d)-1)}return range[i%range.length]}return scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=new InternMap;for(const value of _)index.has(value)||index.set(value,domain.push(value)-1);return scale},scale.range=function(_){return arguments.length?(range=Array.from(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal(domain,range).unknown(unknown)},initRange.apply(scale,arguments),scale}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(start,stop,count){const step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log10(step)),error=step/Math.pow(10,power),factor=error>=e10?10:error>=e5?5:error>=e2?2:1;let i1,i2,inc;return power<0?(inc=Math.pow(10,-power)/factor,i1=Math.round(start*inc),i2=Math.round(stop*inc),i1/inc<start&&++i1,i2/inc>stop&&--i2,inc=-inc):(inc=Math.pow(10,power)*factor,i1=Math.round(start/inc),i2=Math.round(stop/inc),i1*inc<start&&++i1,i2*inc>stop&&--i2),i2<i1&&.5<=count&&count<2?tickSpec(start,stop,2*count):[i1,i2,inc]}function ticks(start,stop,count){if(!((count=+count)>0))return[];if((start=+start)===(stop=+stop))return[start];const reverse=stop<start,[i1,i2,inc]=reverse?tickSpec(stop,start,count):tickSpec(start,stop,count);if(!(i2>=i1))return[];const n=i2-i1+1,ticks=new Array(n);if(reverse)if(inc<0)for(let i=0;i<n;++i)ticks[i]=(i2-i)/-inc;else for(let i=0;i<n;++i)ticks[i]=(i2-i)*inc;else if(inc<0)for(let i=0;i<n;++i)ticks[i]=(i1+i)/-inc;else for(let i=0;i<n;++i)ticks[i]=(i1+i)*inc;return ticks}function tickIncrement(start,stop,count){return tickSpec(start=+start,stop=+stop,count=+count)[2]}function tickStep(start,stop,count){count=+count;const reverse=(stop=+stop)<(start=+start),inc=reverse?tickIncrement(stop,start,count):tickIncrement(start,stop,count);return(reverse?-1:1)*(inc<0?1/-inc:inc)}function ascending_ascending(a,b){return null==a||null==b?NaN:a<b?-1:a>b?1:a>=b?0:NaN}function descending(a,b){return null==a||null==b?NaN:b<a?-1:b>a?1:b>=a?0:NaN}function bisector(f){let compare1,compare2,delta;function left(a,x,lo=0,hi=a.length){if(lo<hi){if(0!==compare1(x,x))return hi;do{const mid=lo+hi>>>1;compare2(a[mid],x)<0?lo=mid+1:hi=mid}while(lo<hi)}return lo}return 2!==f.length?(compare1=ascending_ascending,compare2=(d,x)=>ascending_ascending(f(d),x),delta=(d,x)=>f(d)-x):(compare1=f===ascending_ascending||f===descending?f:bisector_zero,compare2=f,delta=f),{left,center:function center(a,x,lo=0,hi=a.length){const i=left(a,x,lo,hi-1);return i>lo&&delta(a[i-1],x)>-delta(a[i],x)?i-1:i},right:function right(a,x,lo=0,hi=a.length){if(lo<hi){if(0!==compare1(x,x))return hi;do{const mid=lo+hi>>>1;compare2(a[mid],x)<=0?lo=mid+1:hi=mid}while(lo<hi)}return lo}}}function bisector_zero(){return 0}const ascendingBisect=bisector(ascending_ascending),bisectRight=ascendingBisect.right,bisect=(ascendingBisect.left,bisector(function number_number(x){return null===x?NaN:+x}).center,bisectRight);function round(a,b){return a=+a,b=+b,function(t){return Math.round(a*(1-t)+b*t)}}function src_number_number(x){return+x}var unit=[0,1];function continuous_identity(x){return x}function normalize(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:function constants(x){return function(){return x}}(isNaN(b)?NaN:.5)}function bimap(domain,range,interpolate){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1];return d1<d0?(d0=normalize(d1,d0),r0=interpolate(r1,r0)):(d0=normalize(d0,d1),r0=interpolate(r0,r1)),function(x){return r0(d0(x))}}function polymap(domain,range,interpolate){var j=Math.min(domain.length,range.length)-1,d=new Array(j),r=new Array(j),i=-1;for(domain[j]<domain[0]&&(domain=domain.slice().reverse(),range=range.slice().reverse());++i<j;)d[i]=normalize(domain[i],domain[i+1]),r[i]=interpolate(range[i],range[i+1]);return function(x){var i=bisect(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp()).unknown(source.unknown())}function transformer(){var transform,untransform,unknown,piecewise,output,input,domain=unit,range=unit,interpolate=value,clamp=continuous_identity;function rescale(){var n=Math.min(domain.length,range.length);return clamp!==continuous_identity&&(clamp=function clamper(a,b){var t;return a>b&&(t=a,a=b,b=t),function(x){return Math.max(a,Math.min(b,x))}}(domain[0],domain[n-1])),piecewise=n>2?polymap:bimap,output=input=null,scale}function scale(x){return null==x||isNaN(x=+x)?unknown:(output||(output=piecewise(domain.map(transform),range,interpolate)))(transform(clamp(x)))}return scale.invert=function(y){return clamp(untransform((input||(input=piecewise(range,domain.map(transform),number)))(y)))},scale.domain=function(_){return arguments.length?(domain=Array.from(_,src_number_number),rescale()):domain.slice()},scale.range=function(_){return arguments.length?(range=Array.from(_),rescale()):range.slice()},scale.rangeRound=function(_){return range=Array.from(_),interpolate=round,rescale()},scale.clamp=function(_){return arguments.length?(clamp=!!_||continuous_identity,rescale()):clamp!==continuous_identity},scale.interpolate=function(_){return arguments.length?(interpolate=_,rescale()):interpolate},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},function(t,u){return transform=t,untransform=u,rescale()}}function continuous(){return transformer()(continuous_identity,continuous_identity)}var prefixExponent,re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match;return new FormatSpecifier({fill:match[1],align:match[2],sign:match[3],symbol:match[4],zero:match[5],width:match[6],comma:match[7],precision:match[8]&&match[8].slice(1),trim:match[9],type:match[10]})}function FormatSpecifier(specifier){this.fill=void 0===specifier.fill?" ":specifier.fill+"",this.align=void 0===specifier.align?">":specifier.align+"",this.sign=void 0===specifier.sign?"-":specifier.sign+"",this.symbol=void 0===specifier.symbol?"":specifier.symbol+"",this.zero=!!specifier.zero,this.width=void 0===specifier.width?void 0:+specifier.width,this.comma=!!specifier.comma,this.precision=void 0===specifier.precision?void 0:+specifier.precision,this.trim=!!specifier.trim,this.type=void 0===specifier.type?"":specifier.type+""}function formatDecimalParts(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]}function exponent(x){return(x=formatDecimalParts(Math.abs(x)))?x[1]:NaN}function formatRounded(x,p){var d=formatDecimalParts(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const formatTypes={"%":(x,p)=>(100*x).toFixed(p),b:x=>Math.round(x).toString(2),c:x=>x+"",d:function formatDecimal(x){return Math.abs(x=Math.round(x))>=1e21?x.toLocaleString("en").replace(/,/g,""):x.toString(10)},e:(x,p)=>x.toExponential(p),f:(x,p)=>x.toFixed(p),g:(x,p)=>x.toPrecision(p),o:x=>Math.round(x).toString(8),p:(x,p)=>formatRounded(100*x,p),r:formatRounded,s:function formatPrefixAuto(x,p){var d=formatDecimalParts(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(exponent/3))))+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+formatDecimalParts(x,Math.max(0,p+i-1))[0]},X:x=>Math.round(x).toString(16).toUpperCase(),x:x=>Math.round(x).toString(16)};function src_identity(x){return x}var defaultLocale_locale,format,formatPrefix,map=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function src_locale(locale){var group=void 0===locale.grouping||void 0===locale.thousands?src_identity:function formatGroup(grouping,thousands){return function(value,width){for(var i=value.length,t=[],j=0,g=grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=grouping[j=(j+1)%grouping.length];return t.reverse().join(thousands)}}(map.call(locale.grouping,Number),locale.thousands+""),currencyPrefix=void 0===locale.currency?"":locale.currency[0]+"",currencySuffix=void 0===locale.currency?"":locale.currency[1]+"",decimal=void 0===locale.decimal?".":locale.decimal+"",numerals=void 0===locale.numerals?src_identity:function formatNumerals(numerals){return function(value){return value.replace(/[0-9]/g,function(i){return numerals[+i]})}}(map.call(locale.numerals,String)),percent=void 0===locale.percent?"%":locale.percent+"",minus=void 0===locale.minus?"":locale.minus+"",nan=void 0===locale.nan?"NaN":locale.nan+"";function newFormat(specifier){var fill=(specifier=formatSpecifier(specifier)).fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,trim=specifier.trim,type=specifier.type;"n"===type?(comma=!0,type="g"):formatTypes[type]||(void 0===precision&&(precision=12),trim=!0,type="g"),(zero||"0"===fill&&"="===align)&&(zero=!0,fill="0",align="=");var prefix="$"===symbol?currencyPrefix:"#"===symbol&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix="$"===symbol?currencySuffix:/[%p]/.test(type)?percent:"",formatType=formatTypes[type],maybeSuffix=/[defgprs%]/.test(type);function format(value){var i,n,c,valuePrefix=prefix,valueSuffix=suffix;if("c"===type)valueSuffix=formatType(value)+valueSuffix,value="";else{var valueNegative=(value=+value)<0||1/value<0;if(value=isNaN(value)?nan:formatType(Math.abs(value),precision),trim&&(value=function formatTrim(s){out:for(var i1,n=s.length,i=1,i0=-1;i<n;++i)switch(s[i]){case".":i0=i1=i;break;case"0":0===i0&&(i0=i),i1=i;break;default:if(!+s[i])break out;i0>0&&(i0=0)}return i0>0?s.slice(0,i0)+s.slice(i1+1):s}(value)),valueNegative&&0===+value&&"+"!==sign&&(valueNegative=!1),valuePrefix=(valueNegative?"("===sign?sign:minus:"-"===sign||"("===sign?"":sign)+valuePrefix,valueSuffix=("s"===type?prefixes[8+prefixExponent/3]:"")+valueSuffix+(valueNegative&&"("===sign?")":""),maybeSuffix)for(i=-1,n=value.length;++i<n;)if(48>(c=value.charCodeAt(i))||c>57){valueSuffix=(46===c?decimal+value.slice(i+1):value.slice(i))+valueSuffix,value=value.slice(0,i);break}}comma&&!zero&&(value=group(value,1/0));var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";switch(comma&&zero&&(value=group(padding+value,padding.length?width-valueSuffix.length:1/0),padding=""),align){case"<":value=valuePrefix+value+valueSuffix+padding;break;case"=":value=valuePrefix+padding+value+valueSuffix;break;case"^":value=padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length);break;default:value=padding+valuePrefix+value+valueSuffix}return numerals(value)}return precision=void 0===precision?6:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision)),format.toString=function(){return specifier+""},format}return{format:newFormat,formatPrefix:function formatPrefix(specifier,value){var f=newFormat(((specifier=formatSpecifier(specifier)).type="f",specifier)),e=3*Math.max(-8,Math.min(8,Math.floor(exponent(value)/3))),k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}}}function tickFormat(start,stop,count,specifier){var precision,step=tickStep(start,stop,count);switch((specifier=formatSpecifier(null==specifier?",f":specifier)).type){case"s":var value=Math.max(Math.abs(start),Math.abs(stop));return null!=specifier.precision||isNaN(precision=function precisionPrefix(step,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent(value)/3)))-exponent(Math.abs(step)))}(step,value))||(specifier.precision=precision),formatPrefix(specifier,value);case"":case"e":case"g":case"p":case"r":null!=specifier.precision||isNaN(precision=function precisionRound(step,max){return step=Math.abs(step),max=Math.abs(max)-step,Math.max(0,exponent(max)-exponent(step))+1}(step,Math.max(Math.abs(start),Math.abs(stop))))||(specifier.precision=precision-("e"===specifier.type));break;case"f":case"%":null!=specifier.precision||isNaN(precision=function precisionFixed(step){return Math.max(0,-exponent(Math.abs(step)))}(step))||(specifier.precision=precision-2*("%"===specifier.type))}return format(specifier)}function linearish(scale){var domain=scale.domain;return scale.ticks=function(count){var d=domain();return ticks(d[0],d[d.length-1],null==count?10:count)},scale.tickFormat=function(count,specifier){var d=domain();return tickFormat(d[0],d[d.length-1],null==count?10:count,specifier)},scale.nice=function(count){null==count&&(count=10);var prestep,step,d=domain(),i0=0,i1=d.length-1,start=d[i0],stop=d[i1],maxIter=10;for(stop<start&&(step=start,start=stop,stop=step,step=i0,i0=i1,i1=step);maxIter-- >0;){if((step=tickIncrement(start,stop,count))===prestep)return d[i0]=start,d[i1]=stop,domain(d);if(step>0)start=Math.floor(start/step)*step,stop=Math.ceil(stop/step)*step;else{if(!(step<0))break;start=Math.ceil(start*step)/step,stop=Math.floor(stop*step)/step}prestep=step}return scale},scale}function linear_linear(){var scale=continuous();return scale.copy=function(){return copy(scale,linear_linear())},initRange.apply(scale,arguments),linearish(scale)}function transformSymlog(c){return function(x){return Math.sign(x)*Math.log1p(Math.abs(x/c))}}function transformSymexp(c){return function(x){return Math.sign(x)*Math.expm1(Math.abs(x))*c}}function symlog(){var scale=function symlogish(transform){var c=1,scale=transform(transformSymlog(c),transformSymexp(c));return scale.constant=function(_){return arguments.length?transform(transformSymlog(c=+_),transformSymexp(c)):c},linearish(scale)}(transformer());return scale.copy=function(){return copy(scale,symlog()).constant(scale.constant())},initRange.apply(scale,arguments)}function nice(domain,interval){var t,i0=0,i1=(domain=domain.slice()).length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(t=i0,i0=i1,i1=t,t=x0,x0=x1,x1=t),domain[i0]=interval.floor(x0),domain[i1]=interval.ceil(x1),domain}function transformLog(x){return Math.log(x)}function transformExp(x){return Math.exp(x)}function transformLogn(x){return-Math.log(-x)}function transformExpn(x){return-Math.exp(-x)}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function reflect(f){return(x,k)=>-f(-x,k)}function loggish(transform){const scale=transform(transformLog,transformExp),domain=scale.domain;let logs,pows,base=10;function rescale(){return logs=function logp(base){return base===Math.E?Math.log:10===base&&Math.log10||2===base&&Math.log2||(base=Math.log(base),x=>Math.log(x)/base)}(base),pows=function powp(base){return 10===base?pow10:base===Math.E?Math.exp:x=>Math.pow(base,x)}(base),domain()[0]<0?(logs=reflect(logs),pows=reflect(pows),transform(transformLogn,transformExpn)):transform(transformLog,transformExp),scale}return scale.base=function(_){return arguments.length?(base=+_,rescale()):base},scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.ticks=count=>{const d=domain();let u=d[0],v=d[d.length-1];const r=v<u;r&&([u,v]=[v,u]);let k,t,i=logs(u),j=logs(v);const n=null==count?10:+count;let z=[];if(!(base%1)&&j-i<n){if(i=Math.floor(i),j=Math.ceil(j),u>0){for(;i<=j;++i)for(k=1;k<base;++k)if(t=i<0?k/pows(-i):k*pows(i),!(t<u)){if(t>v)break;z.push(t)}}else for(;i<=j;++i)for(k=base-1;k>=1;--k)if(t=i>0?k/pows(-i):k*pows(i),!(t<u)){if(t>v)break;z.push(t)}2*z.length<n&&(z=ticks(u,v,n))}else z=ticks(i,j,Math.min(j-i,n)).map(pows);return r?z.reverse():z},scale.tickFormat=(count,specifier)=>{if(null==count&&(count=10),null==specifier&&(specifier=10===base?"s":","),"function"!=typeof specifier&&(base%1||null!=(specifier=formatSpecifier(specifier)).precision||(specifier.trim=!0),specifier=format(specifier)),count===1/0)return specifier;const k=Math.max(1,base*count/scale.ticks().length);return d=>{let i=d/pows(Math.round(logs(d)));return i*base<base-.5&&(i*=base),i<=k?specifier(d):""}},scale.nice=()=>domain(nice(domain(),{floor:x=>pows(Math.floor(logs(x))),ceil:x=>pows(Math.ceil(logs(x)))})),scale}function log(){const scale=loggish(transformer()).domain([1,10]);return scale.copy=()=>copy(scale,log()).base(scale.base()),initRange.apply(scale,arguments),scale}!function defaultLocale_defaultLocale(definition){return defaultLocale_locale=src_locale(definition),format=defaultLocale_locale.format,formatPrefix=defaultLocale_locale.formatPrefix,defaultLocale_locale}({thousands:",",grouping:[3],currency:["$",""]});const millisecond=timeInterval(()=>{},(date,step)=>{date.setTime(+date+step)},(start,end)=>end-start);millisecond.every=k=>(k=Math.floor(k),isFinite(k)&&k>0?k>1?timeInterval(date=>{date.setTime(Math.floor(date/k)*k)},(date,step)=>{date.setTime(+date+step*k)},(start,end)=>(end-start)/k):millisecond:null);millisecond.range;const second=timeInterval(date=>{date.setTime(date-date.getMilliseconds())},(date,step)=>{date.setTime(+date+1e3*step)},(start,end)=>(end-start)/1e3,date=>date.getUTCSeconds()),timeMinute=(second.range,timeInterval(date=>{date.setTime(date-date.getMilliseconds()-1e3*date.getSeconds())},(date,step)=>{date.setTime(+date+6e4*step)},(start,end)=>(end-start)/6e4,date=>date.getMinutes())),utcMinute=(timeMinute.range,timeInterval(date=>{date.setUTCSeconds(0,0)},(date,step)=>{date.setTime(+date+6e4*step)},(start,end)=>(end-start)/6e4,date=>date.getUTCMinutes())),timeHour=(utcMinute.range,timeInterval(date=>{date.setTime(date-date.getMilliseconds()-1e3*date.getSeconds()-6e4*date.getMinutes())},(date,step)=>{date.setTime(+date+36e5*step)},(start,end)=>(end-start)/36e5,date=>date.getHours())),utcHour=(timeHour.range,timeInterval(date=>{date.setUTCMinutes(0,0,0)},(date,step)=>{date.setTime(+date+36e5*step)},(start,end)=>(end-start)/36e5,date=>date.getUTCHours())),timeMonth=(utcHour.range,timeInterval(date=>{date.setDate(1),date.setHours(0,0,0,0)},(date,step)=>{date.setMonth(date.getMonth()+step)},(start,end)=>end.getMonth()-start.getMonth()+12*(end.getFullYear()-start.getFullYear()),date=>date.getMonth())),utcMonth=(timeMonth.range,timeInterval(date=>{date.setUTCDate(1),date.setUTCHours(0,0,0,0)},(date,step)=>{date.setUTCMonth(date.getUTCMonth()+step)},(start,end)=>end.getUTCMonth()-start.getUTCMonth()+12*(end.getUTCFullYear()-start.getUTCFullYear()),date=>date.getUTCMonth()));utcMonth.range;function ticker(year,month,week,day,hour,minute){const tickIntervals=[[second,1,1e3],[second,5,5e3],[second,15,15e3],[second,30,3e4],[minute,1,6e4],[minute,5,3e5],[minute,15,9e5],[minute,30,18e5],[hour,1,36e5],[hour,3,108e5],[hour,6,216e5],[hour,12,432e5],[day,1,864e5],[day,2,1728e5],[week,1,6048e5],[month,1,2592e6],[month,3,7776e6],[year,1,31536e6]];function tickInterval(start,stop,count){const target=Math.abs(stop-start)/count,i=bisector(([,,step])=>step).right(tickIntervals,target);if(i===tickIntervals.length)return year.every(tickStep(start/31536e6,stop/31536e6,count));if(0===i)return millisecond.every(Math.max(tickStep(start,stop,count),1));const[t,step]=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i];return t.every(step)}return[function ticks(start,stop,count){const reverse=stop<start;reverse&&([start,stop]=[stop,start]);const interval=count&&"function"==typeof count.range?count:tickInterval(start,stop,count),ticks=interval?interval.range(start,+stop+1):[];return reverse?ticks.reverse():ticks},tickInterval]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function time_date(t){return new Date(t)}function time_number(t){return t instanceof Date?+t:+new Date(+t)}function calendar(ticks,tickInterval,year,month,week,day,hour,minute,second,format){var scale=continuous(),invert=scale.invert,domain=scale.domain,formatMillisecond=format(".%L"),formatSecond=format(":%S"),formatMinute=format("%I:%M"),formatHour=format("%I %p"),formatDay=format("%a %d"),formatWeek=format("%b %d"),formatMonth=format("%B"),formatYear=format("%Y");function tickFormat(date){return(second(date)<date?formatMillisecond:minute(date)<date?formatSecond:hour(date)<date?formatMinute:day(date)<date?formatHour:month(date)<date?week(date)<date?formatDay:formatWeek:year(date)<date?formatMonth:formatYear)(date)}return scale.invert=function(y){return new Date(invert(y))},scale.domain=function(_){return arguments.length?domain(Array.from(_,time_number)):domain().map(time_date)},scale.ticks=function(interval){var d=domain();return ticks(d[0],d[d.length-1],null==interval?10:interval)},scale.tickFormat=function(count,specifier){return null==specifier?tickFormat:format(specifier)},scale.nice=function(interval){var d=domain();return interval&&"function"==typeof interval.range||(interval=tickInterval(d[0],d[d.length-1],null==interval?10:interval)),interval?domain(nice(d,interval)):scale},scale.copy=function(){return copy(scale,calendar(ticks,tickInterval,year,month,week,day,hour,minute,second,format))},scale}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function point(that,x,y){that._context.bezierCurveTo((2*that._x0+that._x1)/3,(2*that._y0+that._y1)/3,(that._x0+2*that._x1)/3,(that._y0+2*that._y1)/3,(that._x0+4*that._x1+x)/6,(that._y0+4*that._y1+y)/6)}function Basis(context){this._context=context}function curve_basis(context){return new Basis(context)}function src_noop(){}function BasisClosed(context){this._context=context}function curve_basisClosed(context){return new BasisClosed(context)}function BasisOpen(context){this._context=context}function basisOpen(context){return new BasisOpen(context)}function Bundle(context,beta){this._basis=new Basis(context),this._beta=beta}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},BasisClosed.prototype={areaStart:src_noop,areaEnd:src_noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x2=x,this._y2=y;break;case 1:this._point=2,this._x3=x,this._y3=y;break;case 2:this._point=3,this._x4=x,this._y4=y,this._context.moveTo((this._x0+4*this._x1+x)/6,(this._y0+4*this._y1+y)/6);break;default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var x0=(this._x0+4*this._x1+x)/6,y0=(this._y0+4*this._y1+y)/6;this._line?this._context.lineTo(x0,y0):this._context.moveTo(x0,y0);break;case 3:this._point=4;default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var x=this._x,y=this._y,j=x.length-1;if(j>0)for(var t,x0=x[0],y0=y[0],dx=x[j]-x0,dy=y[j]-y0,i=-1;++i<=j;)t=i/j,this._basis.point(this._beta*x[i]+(1-this._beta)*(x0+t*dx),this._beta*y[i]+(1-this._beta)*(y0+t*dy));this._x=this._y=null,this._basis.lineEnd()},point:function(x,y){this._x.push(+x),this._y.push(+y)}};const bundle=function custom(beta){function bundle(context){return 1===beta?new Basis(context):new Bundle(context,beta)}return bundle.beta=function(beta){return custom(+beta)},bundle}(.85);function cardinal_point(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context,this._k=(1-tension)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:cardinal_point(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const cardinal=function custom(tension){function cardinal(context){return new Cardinal(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);function CardinalClosed(context,tension){this._context=context,this._k=(1-tension)/6}CardinalClosed.prototype={areaStart:src_noop,areaEnd:src_noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:cardinal_point(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const cardinalClosed=function custom(tension){function cardinal(context){return new CardinalClosed(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);function CardinalOpen(context,tension){this._context=context,this._k=(1-tension)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cardinal_point(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const cardinalOpen=function custom(tension){function cardinal(context){return new CardinalOpen(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0),math_abs=Math.abs,atan2=Math.atan2,cos=Math.cos,math_max=Math.max,math_min=Math.min,sin=Math.sin,sqrt=Math.sqrt,pi=Math.PI,halfPi=pi/2,tau=2*pi;function asin(x){return x>=1?halfPi:x<=-1?-halfPi:Math.asin(x)}function catmullRom_point(that,x,y){var x1=that._x1,y1=that._y1,x2=that._x2,y2=that._y2;if(that._l01_a>1e-12){var a=2*that._l01_2a+3*that._l01_a*that._l12_a+that._l12_2a,n=3*that._l01_a*(that._l01_a+that._l12_a);x1=(x1*a-that._x0*that._l12_2a+that._x2*that._l01_2a)/n,y1=(y1*a-that._y0*that._l12_2a+that._y2*that._l01_2a)/n}if(that._l23_a>1e-12){var b=2*that._l23_2a+3*that._l23_a*that._l12_a+that._l12_2a,m=3*that._l23_a*(that._l23_a+that._l12_a);x2=(x2*b+that._x1*that._l23_2a-x*that._l12_2a)/m,y2=(y2*b+that._y1*that._l23_2a-y*that._l12_2a)/m}that._context.bezierCurveTo(x1,y1,x2,y2,that._x2,that._y2)}function CatmullRom(context,alpha){this._context=context,this._alpha=alpha}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:catmullRom_point(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const catmullRom=function custom(alpha){function catmullRom(context){return alpha?new CatmullRom(context,alpha):new Cardinal(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);function CatmullRomClosed(context,alpha){this._context=context,this._alpha=alpha}CatmullRomClosed.prototype={areaStart:src_noop,areaEnd:src_noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:catmullRom_point(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const catmullRomClosed=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomClosed(context,alpha):new CardinalClosed(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);function CatmullRomOpen(context,alpha){this._context=context,this._alpha=alpha}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:catmullRom_point(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};const catmullRomOpen=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomOpen(context,alpha):new CardinalOpen(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);function sign(x){return x<0?-1:1}function slope3(that,x2,y2){var h0=that._x1-that._x0,h1=x2-that._x1,s0=(that._y1-that._y0)/(h0||h1<0&&-0),s1=(y2-that._y1)/(h1||h0<0&&-0),p=(s0*h1+s1*h0)/(h0+h1);return(sign(s0)+sign(s1))*Math.min(Math.abs(s0),Math.abs(s1),.5*Math.abs(p))||0}function slope2(that,t){var h=that._x1-that._x0;return h?(3*(that._y1-that._y0)/h-t)/2:t}function monotone_point(that,t0,t1){var x0=that._x0,y0=that._y0,x1=that._x1,y1=that._y1,dx=(x1-x0)/3;that._context.bezierCurveTo(x0+dx,y0+dx*t0,x1-dx,y1-dx*t1,x1,y1)}function MonotoneX(context){this._context=context}function MonotoneY(context){this._context=new ReflectContext(context)}function ReflectContext(context){this._context=context}function monotoneX(context){return new MonotoneX(context)}function monotoneY(context){return new MonotoneY(context)}function Natural(context){this._context=context}function controlPoints(x){var i,m,n=x.length-1,a=new Array(n),b=new Array(n),r=new Array(n);for(a[0]=0,b[0]=2,r[0]=x[0]+2*x[1],i=1;i<n-1;++i)a[i]=1,b[i]=4,r[i]=4*x[i]+2*x[i+1];for(a[n-1]=2,b[n-1]=7,r[n-1]=8*x[n-1]+x[n],i=1;i<n;++i)m=a[i]/b[i-1],b[i]-=m,r[i]-=m*r[i-1];for(a[n-1]=r[n-1]/b[n-1],i=n-2;i>=0;--i)a[i]=(r[i]-a[i+1])/b[i];for(b[n-1]=(x[n]+a[n-1])/2,i=0;i<n-1;++i)b[i]=2*x[i+1]-a[i+1];return[a,b]}function natural(context){return new Natural(context)}function LinearClosed(context){this._context=context}function linearClosed(context){return new LinearClosed(context)}function Linear(context){this._context=context}function curve_linear(context){return new Linear(context)}function Step(context,t){this._context=context,this._t=t}function step(context){return new Step(context,.5)}function stepBefore(context){return new Step(context,0)}function stepAfter(context){return new Step(context,1)}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:monotone_point(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){var t1=NaN;if(y=+y,(x=+x)!==this._x1||y!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,monotone_point(this,slope2(this,t1=slope3(this,x,y)),t1);break;default:monotone_point(this,this._t0,t1=slope3(this,x,y))}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y,this._t0=t1}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(x,y){MonotoneX.prototype.point.call(this,y,x)},ReflectContext.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._context.bezierCurveTo(y1,x1,y2,x2,y,x)}},Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var x=this._x,y=this._y,n=x.length;if(n)if(this._line?this._context.lineTo(x[0],y[0]):this._context.moveTo(x[0],y[0]),2===n)this._context.lineTo(x[1],y[1]);else for(var px=controlPoints(x),py=controlPoints(y),i0=0,i1=1;i1<n;++i0,++i1)this._context.bezierCurveTo(px[0][i0],py[0][i0],px[1][i0],py[1][i0],x[i1],y[i1]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(x,y){this._x.push(+x),this._y.push(+y)}},LinearClosed.prototype={areaStart:src_noop,areaEnd:src_noop,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(x,y){x=+x,y=+y,this._point?this._context.lineTo(x,y):(this._point=1,this._context.moveTo(x,y))}},Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}},Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y),this._context.lineTo(x1,y)}}this._x=x,this._y=y}};Array.prototype.slice;function d3_shape_src_array(x){return"object"==typeof x&&"length"in x?x:Array.from(x)}function d3_shape_src_constant(x){return function constant(){return x}}function src_descending(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}function d3_shape_src_identity(d){return d}const path_pi=Math.PI,path_tau=2*path_pi,tauEpsilon=path_tau-1e-6;function path_append(strings){this._+=strings[0];for(let i=1,n=strings.length;i<n;++i)this._+=arguments[i]+strings[i]}class Path{constructor(digits){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==digits?path_append:function appendRound(digits){let d=Math.floor(digits);if(!(d>=0))throw new Error(`invalid digits: ${digits}`);if(d>15)return path_append;const k=10**d;return function(strings){this._+=strings[0];for(let i=1,n=strings.length;i<n;++i)this._+=Math.round(arguments[i]*k)/k+strings[i]}}(digits)}moveTo(x,y){this._append`M${this._x0=this._x1=+x},${this._y0=this._y1=+y}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(x,y){this._append`L${this._x1=+x},${this._y1=+y}`}quadraticCurveTo(x1,y1,x,y){this._append`Q${+x1},${+y1},${this._x1=+x},${this._y1=+y}`}bezierCurveTo(x1,y1,x2,y2,x,y){this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1=+x},${this._y1=+y}`}arcTo(x1,y1,x2,y2,r){if(x1=+x1,y1=+y1,x2=+x2,y2=+y2,(r=+r)<0)throw new Error(`negative radius: ${r}`);let x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(null===this._x1)this._append`M${this._x1=x1},${this._y1=y1}`;else if(l01_2>1e-6)if(Math.abs(y01*x21-y21*x01)>1e-6&&r){let x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((path_pi-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;Math.abs(t01-1)>1e-6&&this._append`L${x1+t01*x01},${y1+t01*y01}`,this._append`A${r},${r},0,0,${+(y01*x20>x01*y20)},${this._x1=x1+t21*x21},${this._y1=y1+t21*y21}`}else this._append`L${this._x1=x1},${this._y1=y1}`;else;}arc(x,y,r,a0,a1,ccw){if(x=+x,y=+y,ccw=!!ccw,(r=+r)<0)throw new Error(`negative radius: ${r}`);let dx=r*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;null===this._x1?this._append`M${x0},${y0}`:(Math.abs(this._x1-x0)>1e-6||Math.abs(this._y1-y0)>1e-6)&&this._append`L${x0},${y0}`,r&&(da<0&&(da=da%path_tau+path_tau),da>tauEpsilon?this._append`A${r},${r},0,1,${cw},${x-dx},${y-dy}A${r},${r},0,1,${cw},${this._x1=x0},${this._y1=y0}`:da>1e-6&&this._append`A${r},${r},0,${+(da>=path_pi)},${cw},${this._x1=x+r*Math.cos(a1)},${this._y1=y+r*Math.sin(a1)}`)}rect(x,y,w,h){this._append`M${this._x0=this._x1=+x},${this._y0=this._y1=+y}h${w=+w}v${+h}h${-w}Z`}toString(){return this._}}function withPath(shape){let digits=3;return shape.digits=function(_){if(!arguments.length)return digits;if(null==_)digits=null;else{const d=Math.floor(_);if(!(d>=0))throw new RangeError(`invalid digits: ${_}`);digits=d}return shape},()=>new Path(digits)}function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*sqrt(math_max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function arc(){var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=d3_shape_src_constant(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null,path=withPath(arc);function arc(){var buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-halfPi,a1=endAngle.apply(this,arguments)-halfPi,da=math_abs(a1-a0),cw=a1>a0;if(context||(context=buffer=path()),r1<r0&&(r=r1,r1=r0,r0=r),r1>1e-12)if(da>tau-1e-12)context.moveTo(r1*cos(a0),r1*sin(a0)),context.arc(0,0,r1,a0,a1,!cw),r0>1e-12&&(context.moveTo(r0*cos(a1),r0*sin(a1)),context.arc(0,0,r0,a1,a0,cw));else{var t0,t1,a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>1e-12&&(padRadius?+padRadius.apply(this,arguments):sqrt(r0*r0+r1*r1)),rc=math_min(math_abs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc;if(rp>1e-12){var p0=asin(rp/r0*sin(ap)),p1=asin(rp/r1*sin(ap));(da0-=2*p0)>1e-12?(a00+=p0*=cw?1:-1,a10-=p0):(da0=0,a00=a10=(a0+a1)/2),(da1-=2*p1)>1e-12?(a01+=p1*=cw?1:-1,a11-=p1):(da1=0,a01=a11=(a0+a1)/2)}var x01=r1*cos(a01),y01=r1*sin(a01),x10=r0*cos(a10),y10=r0*sin(a10);if(rc>1e-12){var oc,x11=r1*cos(a11),y11=r1*sin(a11),x00=r0*cos(a00),y00=r0*sin(a00);if(da<pi)if(oc=function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=y32*x10-x32*y10;if(!(t*t<1e-12))return[x0+(t=(x32*(y0-y2)-y32*(x0-x2))/t)*x10,y0+t*y10]}(x01,y01,x00,y00,x11,y11,x10,y10)){var ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/sin(function acos(x){return x>1?0:x<-1?pi:Math.acos(x)}((ax*bx+ay*by)/(sqrt(ax*ax+ay*ay)*sqrt(bx*bx+by*by)))/2),lc=sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=math_min(rc,(r0-lc)/(kc-1)),rc1=math_min(rc,(r1-lc)/(kc+1))}else rc0=rc1=0}da1>1e-12?rc1>1e-12?(t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw),t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw),context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01),rc1<rc?context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r1,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),!cw),context.arc(t1.cx,t1.cy,rc1,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):(context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw)):context.moveTo(x01,y01),r0>1e-12&&da0>1e-12?rc0>1e-12?(t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw),t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw),context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01),rc0<rc?context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r0,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),cw),context.arc(t1.cx,t1.cy,rc0,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):context.arc(0,0,r0,a10,a00,cw):context.lineTo(x10,y10)}else context.moveTo(0,0);if(context.closePath(),buffer)return context=null,buffer+""||null}return arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-pi/2;return[cos(a)*r,sin(a)*r]},arc.innerRadius=function(_){return arguments.length?(innerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):innerRadius},arc.outerRadius=function(_){return arguments.length?(outerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):outerRadius},arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):cornerRadius},arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),arc):padRadius},arc.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):startAngle},arc.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):endAngle},arc.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):padAngle},arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context},arc}function point_x(p){return p[0]}function point_y(p){return p[1]}function src_line(x,y){var defined=d3_shape_src_constant(!0),context=null,curve=curve_linear,output=null,path=withPath(line);function line(data){var i,d,buffer,n=(data=d3_shape_src_array(data)).length,defined0=!1;for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i)!(i<n&&defined(d=data[i],i,data))===defined0&&((defined0=!defined0)?output.lineStart():output.lineEnd()),defined0&&output.point(+x(d,i,data),+y(d,i,data));if(buffer)return output=null,buffer+""||null}return x="function"==typeof x?x:void 0===x?point_x:d3_shape_src_constant(x),y="function"==typeof y?y:void 0===y?point_y:d3_shape_src_constant(y),line.x=function(_){return arguments.length?(x="function"==typeof _?_:d3_shape_src_constant(+_),line):x},line.y=function(_){return arguments.length?(y="function"==typeof _?_:d3_shape_src_constant(+_),line):y},line.defined=function(_){return arguments.length?(defined="function"==typeof _?_:d3_shape_src_constant(!!_),line):defined},line.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),line):curve},line.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),line):context},line}function d3_axis_src_identity(x){return x}function translateX(x){return"translate("+x+",0)"}function translateY(y){return"translate(0,"+y+")"}function axis_number(scale){return d=>+scale(d)}function center(scale,offset){return offset=Math.max(0,scale.bandwidth()-2*offset)/2,scale.round()&&(offset=Math.round(offset)),d=>+scale(d)+offset}function entering(){return!this.__axis}function axis(orient,scale){var tickArguments=[],tickValues=null,tickFormat=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3,offset="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,k=1===orient||4===orient?-1:1,x=4===orient||2===orient?"x":"y",transform=1===orient||3===orient?translateX:translateY;function axis(context){var values=null==tickValues?scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain():tickValues,format=null==tickFormat?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):d3_axis_src_identity:tickFormat,spacing=Math.max(tickSizeInner,0)+tickPadding,range=scale.range(),range0=+range[0]+offset,range1=+range[range.length-1]+offset,position=(scale.bandwidth?center:axis_number)(scale.copy(),offset),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),line=tick.select("line"),text=tick.select("text");path=path.merge(path.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),tick=tick.merge(tickEnter),line=line.merge(tickEnter.append("line").attr("stroke","currentColor").attr(x+"2",k*tickSizeInner)),text=text.merge(tickEnter.append("text").attr("fill","currentColor").attr(x,k*spacing).attr("dy",1===orient?"0em":3===orient?"0.71em":"0.32em")),context!==selection&&(path=path.transition(context),tick=tick.transition(context),line=line.transition(context),text=text.transition(context),tickExit=tickExit.transition(context).attr("opacity",1e-6).attr("transform",function(d){return isFinite(d=position(d))?transform(d+offset):this.getAttribute("transform")}),tickEnter.attr("opacity",1e-6).attr("transform",function(d){var p=this.parentNode.__axis;return transform((p&&isFinite(p=p(d))?p:position(d))+offset)})),tickExit.remove(),path.attr("d",4===orient||2===orient?tickSizeOuter?"M"+k*tickSizeOuter+","+range0+"H"+offset+"V"+range1+"H"+k*tickSizeOuter:"M"+offset+","+range0+"V"+range1:tickSizeOuter?"M"+range0+","+k*tickSizeOuter+"V"+offset+"H"+range1+"V"+k*tickSizeOuter:"M"+range0+","+offset+"H"+range1),tick.attr("opacity",1).attr("transform",function(d){return transform(position(d)+offset)}),line.attr(x+"2",k*tickSizeInner),text.attr(x,k*spacing).text(format),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===orient?"start":4===orient?"end":"middle"),selection.each(function(){this.__axis=position})}return axis.scale=function(_){return arguments.length?(scale=_,axis):scale},axis.ticks=function(){return tickArguments=Array.from(arguments),axis},axis.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:Array.from(_),axis):tickArguments.slice()},axis.tickValues=function(_){return arguments.length?(tickValues=null==_?null:Array.from(_),axis):tickValues&&tickValues.slice()},axis.tickFormat=function(_){return arguments.length?(tickFormat=_,axis):tickFormat},axis.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,axis):tickSizeInner},axis.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,axis):tickSizeInner},axis.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,axis):tickSizeOuter},axis.tickPadding=function(_){return arguments.length?(tickPadding=+_,axis):tickPadding},axis.offset=function(_){return arguments.length?(offset=+_,axis):offset},axis}function axisTop(scale){return axis(1,scale)}function axisRight(scale){return axis(2,scale)}function axisBottom(scale){return axis(3,scale)}function axisLeft(scale){return axis(4,scale)}const src_linear_linear=t=>+t;function count(node){var sum=0,children=node.children,i=children&&children.length;if(i)for(;--i>=0;)sum+=children[i].value;else sum=1;node.value=sum}function hierarchy(data,children){data instanceof Map?(data=[void 0,data],void 0===children&&(children=mapChildren)):void 0===children&&(children=objectChildren);for(var node,child,childs,i,n,root=new Node(data),nodes=[root];node=nodes.pop();)if((childs=children(node.data))&&(n=(childs=Array.from(childs)).length))for(node.children=childs,i=n-1;i>=0;--i)nodes.push(child=childs[i]=new Node(childs[i])),child.parent=node,child.depth=node.depth+1;return root.eachBefore(computeHeight)}function objectChildren(d){return d.children}function mapChildren(d){return Array.isArray(d)?d[1]:null}function copyData(node){void 0!==node.data.value&&(node.value=node.data.value),node.data=node.data.data}function computeHeight(node){var height=0;do{node.height=height}while((node=node.parent)&&node.height<++height)}function Node(data){this.data=data,this.depth=this.height=0,this.parent=null}function dice(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(x1-x0)/parent.value;++i<n;)(node=nodes[i]).y0=y0,node.y1=y1,node.x0=x0,node.x1=x0+=node.value*k}function treemap_slice(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(y1-y0)/parent.value;++i<n;)(node=nodes[i]).x0=x0,node.x1=x1,node.y0=y0,node.y1=y0+=node.value*k}Node.prototype=hierarchy.prototype={constructor:Node,count:function hierarchy_count(){return this.eachAfter(count)},each:function hierarchy_each(callback,that){let index=-1;for(const node of this)callback.call(that,node,++index,this);return this},eachAfter:function eachAfter(callback,that){for(var children,i,n,node=this,nodes=[node],next=[],index=-1;node=nodes.pop();)if(next.push(node),children=node.children)for(i=0,n=children.length;i<n;++i)nodes.push(children[i]);for(;node=next.pop();)callback.call(that,node,++index,this);return this},eachBefore:function eachBefore(callback,that){for(var children,i,node=this,nodes=[node],index=-1;node=nodes.pop();)if(callback.call(that,node,++index,this),children=node.children)for(i=children.length-1;i>=0;--i)nodes.push(children[i]);return this},find:function hierarchy_find(callback,that){let index=-1;for(const node of this)if(callback.call(that,node,++index,this))return node},sum:function sum(value){return this.eachAfter(function(node){for(var sum=+value(node.data)||0,children=node.children,i=children&&children.length;--i>=0;)sum+=children[i].value;node.value=sum})},sort:function hierarchy_sort(compare){return this.eachBefore(function(node){node.children&&node.children.sort(compare)})},path:function hierarchy_path(end){for(var start=this,ancestor=function leastCommonAncestor(a,b){if(a===b)return a;var aNodes=a.ancestors(),bNodes=b.ancestors(),c=null;a=aNodes.pop(),b=bNodes.pop();for(;a===b;)c=a,a=aNodes.pop(),b=bNodes.pop();return c}(start,end),nodes=[start];start!==ancestor;)start=start.parent,nodes.push(start);for(var k=nodes.length;end!==ancestor;)nodes.splice(k,0,end),end=end.parent;return nodes},ancestors:function ancestors(){for(var node=this,nodes=[node];node=node.parent;)nodes.push(node);return nodes},descendants:function descendants(){return Array.from(this)},leaves:function leaves(){var leaves=[];return this.eachBefore(function(node){node.children||leaves.push(node)}),leaves},links:function links(){var root=this,links=[];return root.each(function(node){node!==root&&links.push({source:node.parent,target:node})}),links},copy:function node_copy(){return hierarchy(this).eachBefore(copyData)},[Symbol.iterator]:function*hierarchy_iterator(){var current,children,i,n,node=this,next=[node];do{for(current=next.reverse(),next=[];node=current.pop();)if(yield node,children=node.children)for(i=0,n=children.length;i<n;++i)next.push(children[i])}while(next.length)}};var phi=(1+Math.sqrt(5))/2;function squarifyRatio(ratio,parent,x0,y0,x1,y1){for(var row,nodeValue,dx,dy,sumValue,minValue,maxValue,newRatio,minRatio,alpha,beta,rows=[],nodes=parent.children,i0=0,i1=0,n=nodes.length,value=parent.value;i0<n;){dx=x1-x0,dy=y1-y0;do{sumValue=nodes[i1++].value}while(!sumValue&&i1<n);for(minValue=maxValue=sumValue,beta=sumValue*sumValue*(alpha=Math.max(dy/dx,dx/dy)/(value*ratio)),minRatio=Math.max(maxValue/beta,beta/minValue);i1<n;++i1){if(sumValue+=nodeValue=nodes[i1].value,nodeValue<minValue&&(minValue=nodeValue),nodeValue>maxValue&&(maxValue=nodeValue),beta=sumValue*sumValue*alpha,(newRatio=Math.max(maxValue/beta,beta/minValue))>minRatio){sumValue-=nodeValue;break}minRatio=newRatio}rows.push(row={value:sumValue,dice:dx<dy,children:nodes.slice(i0,i1)}),row.dice?dice(row,x0,y0,x1,value?y0+=dy*sumValue/value:y1):treemap_slice(row,x0,y0,value?x0+=dx*sumValue/value:x1,y1),value-=sumValue,i0=i1}return rows}(function custom(ratio){function squarify(parent,x0,y0,x1,y1){squarifyRatio(ratio,parent,x0,y0,x1,y1)}return squarify.ratio=function(x){return custom((x=+x)>1?x:1)},squarify})(phi);(function custom(ratio){function resquarify(parent,x0,y0,x1,y1){if((rows=parent._squarify)&&rows.ratio===ratio)for(var rows,row,nodes,i,n,j=-1,m=rows.length,value=parent.value;++j<m;){for(nodes=(row=rows[j]).children,i=row.value=0,n=nodes.length;i<n;++i)row.value+=nodes[i].value;row.dice?dice(row,x0,y0,x1,value?y0+=(y1-y0)*row.value/value:y1):treemap_slice(row,x0,y0,value?x0+=(x1-x0)*row.value/value:x1,y1),value-=row.value}else parent._squarify=rows=squarifyRatio(ratio,parent,x0,y0,x1,y1),rows.ratio=ratio}return resquarify.ratio=function(x){return custom((x=+x)>1?x:1)},resquarify})(phi);function cosh(x){return((x=Math.exp(x))+1/x)/2}(function zoomRho(rho,rho2,rho4){function zoom(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+rho4*d2)/(2*w0*rho2*d1),b1=(w1*w1-w0*w0-rho4*d2)/(2*w1*rho2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(rho2*d1)*(coshr0*function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}(rho*s+r0)-function sinh(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S*rho/Math.SQRT2,i}return zoom.rho=function(_){var _1=Math.max(.001,+_),_2=_1*_1;return zoomRho(_1,_2,_2*_2)},zoom})(Math.SQRT2,2,4);function Transform(k,x,y){this.k=k,this.x=x,this.y=y}Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var transform_identity=new Transform(1,0,0);function transform(node){for(;!node.__zoom;)if(!(node=node.parentNode))return transform_identity;return node.__zoom}transform.prototype=Transform.prototype;var __assign=function(){return __assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};function __spreadArray(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))}"function"==typeof SuppressedError&&SuppressedError;var $COMMON={button:"bb-button",chart:"bb-chart",empty:"bb-empty",main:"bb-main",target:"bb-target",EXPANDED:"_expanded_",dummy:"_dummy_"},$ARC={arc:"bb-arc",arcLabelLine:"bb-arc-label-line",arcRange:"bb-arc-range",arcs:"bb-arcs",chartArc:"bb-chart-arc",chartArcs:"bb-chart-arcs",chartArcsBackground:"bb-chart-arcs-background",chartArcsTitle:"bb-chart-arcs-title",needle:"bb-needle"},$AREA={area:"bb-area",areas:"bb-areas"},$AXIS={axis:"bb-axis",axisX:"bb-axis-x",axisXLabel:"bb-axis-x-label",axisY:"bb-axis-y",axisY2:"bb-axis-y2",axisY2Label:"bb-axis-y2-label",axisYLabel:"bb-axis-y-label",axisXTooltip:"bb-axis-x-tooltip",axisYTooltip:"bb-axis-y-tooltip",axisY2Tooltip:"bb-axis-y2-tooltip",axisTooltipX:"bb-axis-tooltip-x",axisTooltipY:"bb-axis-tooltip-y"},$BAR={bar:"bb-bar",bars:"bb-bars",chartBar:"bb-chart-bar",chartBars:"bb-chart-bars",barConnectLine:"bb-bar-connectLine"},$CANDLESTICK={candlestick:"bb-candlestick",candlesticks:"bb-candlesticks",chartCandlestick:"bb-chart-candlestick",chartCandlesticks:"bb-chart-candlesticks",valueDown:"bb-value-down",valueUp:"bb-value-up"},$CIRCLE={chartCircles:"bb-chart-circles",circle:"bb-circle",circles:"bb-circles"},$COLOR={colorPattern:"bb-color-pattern",colorScale:"bb-colorscale"},$DRAG={dragarea:"bb-dragarea",INCLUDED:"_included_"},$FUNNEL={funnel:"bb-funnel",chartFunnel:"bb-chart-funnel",chartFunnels:"bb-chart-funnels",funnelBackground:"bb-funnel-background"},$GAUGE={chartArcsGaugeMax:"bb-chart-arcs-gauge-max",chartArcsGaugeMin:"bb-chart-arcs-gauge-min",chartArcsGaugeUnit:"bb-chart-arcs-gauge-unit",chartArcsGaugeTitle:"bb-chart-arcs-gauge-title",gaugeValue:"bb-gauge-value"},$LEGEND={legend:"bb-legend",legendBackground:"bb-legend-background",legendItem:"bb-legend-item",legendItemEvent:"bb-legend-item-event",legendItemHidden:"bb-legend-item-hidden",legendItemPoint:"bb-legend-item-point",legendItemTile:"bb-legend-item-tile"},$LINE={chartLine:"bb-chart-line",chartLines:"bb-chart-lines",line:"bb-line",lines:"bb-lines"},$EVENT={eventRect:"bb-event-rect",eventRects:"bb-event-rects",eventRectsMultiple:"bb-event-rects-multiple",eventRectsSingle:"bb-event-rects-single"},$FOCUS={focused:"bb-focused",defocused:"bb-defocused",legendItemFocused:"bb-legend-item-focused",xgridFocus:"bb-xgrid-focus",ygridFocus:"bb-ygrid-focus"},$GRID={grid:"bb-grid",gridLines:"bb-grid-lines",xgrid:"bb-xgrid",xgridLine:"bb-xgrid-line",xgridLines:"bb-xgrid-lines",xgrids:"bb-xgrids",ygrid:"bb-ygrid",ygridLine:"bb-ygrid-line",ygridLines:"bb-ygrid-lines",ygrids:"bb-ygrids"},$RADAR={chartRadar:"bb-chart-radar",chartRadars:"bb-chart-radars"},$REGION={region:"bb-region",regions:"bb-regions"},$SELECT={selectedCircle:"bb-selected-circle",selectedCircles:"bb-selected-circles",SELECTED:"_selected_"},$SHAPE={shape:"bb-shape",shapes:"bb-shapes"},$SUBCHART={brush:"bb-brush",subchart:"bb-subchart"},$TEXT={chartText:"bb-chart-text",chartTexts:"bb-chart-texts",text:"bb-text",texts:"bb-texts",title:"bb-title",textBorderRect:"bb-text-border",textLabelImage:"bb-text-label-image",TextOverlapping:"text-overlapping"},$TOOLTIP={tooltip:"bb-tooltip",tooltipContainer:"bb-tooltip-container",tooltipName:"bb-tooltip-name"},$TREEMAP={treemap:"bb-treemap",chartTreemap:"bb-chart-treemap",chartTreemaps:"bb-chart-treemaps"},$ZOOM={buttonZoomReset:"bb-zoom-reset",zoomBrush:"bb-zoom-brush"},CLASS=__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign({},$COMMON),$ARC),$AREA),$AXIS),$BAR),$CANDLESTICK),$CIRCLE),$COLOR),$DRAG),$GAUGE),$LEGEND),$LINE),$EVENT),$FOCUS),$FUNNEL),$GRID),$RADAR),$REGION),$SELECT),$SHAPE),$SUBCHART),$TEXT),$TOOLTIP),$TREEMAP),$ZOOM),boost={boost_useCssRule:!1,boost_useWorker:!1},color$1={color_pattern:[],color_tiles:void 0,color_threshold:{},color_onover:void 0},legend$2={legend_contents_bindto:void 0,legend_contents_template:"<span style='color:#fff;padding:5px;background-color:{=COLOR}'>{=TITLE}</span>",legend_equally:!1,legend_hide:!1,legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_interaction:!0,legend_item_dblclick:!1,legend_item_onclick:void 0,legend_item_onover:void 0,legend_item_onout:void 0,legend_item_tile_width:10,legend_item_tile_height:10,legend_item_tile_r:5,legend_item_tile_type:"rectangle",legend_format:void 0,legend_padding:0,legend_position:"bottom",legend_show:!0,legend_tooltip:!1,legend_usePoint:!1},main={bindto:"#chart",background:{},clipPath:!0,svg_classname:void 0,size_width:void 0,size_height:void 0,padding:!0,padding_mode:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,resize_timer:!0,onclick:void 0,onover:void 0,onout:void 0,onresize:void 0,onresized:void 0,onbeforeinit:void 0,oninit:void 0,onafterinit:void 0,onrendered:void 0,transition_duration:250,plugins:[],render:{},regions:[]},title$1={title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"center"},tooltip$2={tooltip_show:!0,tooltip_doNotHide:!1,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:{},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:void 0,tooltip_linked:!1,tooltip_linked_name:"",tooltip_onshow:function(){},tooltip_onhide:function(){},tooltip_onshown:function(){},tooltip_onhidden:function(){},tooltip_order:null},data$2={data_x:void 0,data_idConverter:function(id){return id},data_names:{},data_classes:{},data_type:void 0,data_types:{},data_order:"desc",data_groups:[],data_groupsZeroAs:"positive",data_color:void 0,data_colors:{},data_labels:{},data_labels_backgroundColors:void 0,data_labels_colors:void 0,data_labels_position:{},data_labels_imgUrl:void 0,data_hide:!1,data_filter:void 0,data_onclick:function(){},data_onover:function(){},data_onout:function(){},data_onshown:void 0,data_onhidden:void 0,data_onmin:void 0,data_onmax:void 0,data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:"csv",data_keys:void 0,data_empty_label_text:""},interaction$1={interaction_enabled:!0,interaction_brighten:!0,interaction_inputType_mouse:!0,interaction_inputType_touch:{},interaction_onout:!0};var win=function getGlobal(){return"object"==typeof globalThis&&null!==globalThis&&globalThis.Object===Object&&globalThis||"object"==typeof __webpack_require__.g&&null!==__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g||"object"==typeof self&&null!==self&&self.Object===Object&&self||Function("return this")()}(),doc=null==win?void 0:win.document,_a=function getFallback(w){var hasRAF="function"==typeof(null==w?void 0:w.requestAnimationFrame)&&"function"==typeof(null==w?void 0:w.cancelAnimationFrame),hasRIC="function"==typeof(null==w?void 0:w.requestIdleCallback)&&"function"==typeof(null==w?void 0:w.cancelIdleCallback),request=function(cb){return setTimeout(cb,1)},cancel=function(id){return clearTimeout(id)};return[hasRAF?w.requestAnimationFrame:request,hasRAF?w.cancelAnimationFrame:cancel,hasRIC?w.requestIdleCallback:request,hasRIC?w.cancelIdleCallback:cancel]}(win),requestAnimationFrame=_a[0],requestIdleCallback=_a[2],isValue=function(v){return v||0===v},isFunction=function(v){return"function"==typeof v},isString=function(v){return"string"==typeof v},isNumber=function(v){return"number"==typeof v},isUndefined=function(v){return void 0===v},isDefined=function(v){return void 0!==v},isBoolean=function(v){return"boolean"==typeof v},asHalfPixel=function(n){return Math.ceil(n)+.5},diffDomain=function(d){return d[1]-d[0]},isObjectType=function(v){return"object"==typeof v},isEmpty=function(o){return isUndefined(o)||null===o||isString(o)&&0===o.length||isObjectType(o)&&!(o instanceof Date)&&function(obj){for(var x in obj)return!1;return!0}(o)||isNumber(o)&&isNaN(o)},notEmpty=function(o){return!isEmpty(o)},isArray=function(arr){return Array.isArray(arr)},isObject=function(obj){return obj&&!(null==obj?void 0:obj.nodeType)&&isObjectType(obj)&&!isArray(obj)};function getOption(options,key,defaultValue){return isDefined(options[key])?options[key]:defaultValue}function callFn(fn,thisArg){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];var isFn=isFunction(fn);return isFn&&fn.call.apply(fn,__spreadArray([thisArg],args,!1)),isFn}function endall(transition,cb){var n=0,end=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];! --n&&cb.apply.apply(cb,__spreadArray([this],args,!1))};"duration"in transition?transition.each(function(){return++n}).on("end",end):(++n,transition.call(end))}function sanitize(str){return isString(str)?str.replace(/<(script|img)?/gi,"&lt;").replace(/(script)?>/gi,"&gt;"):str}function setTextValue(node,text,dy,toMiddle){if(void 0===dy&&(dy=[-1,1]),void 0===toMiddle&&(toMiddle=!1),node&&isString(text))if(-1===text.indexOf("\n"))node.text(text);else{var diff=[node.text(),text].map(function(v){return v.replace(/[\s\n]/g,"")});if(diff[0]!==diff[1]){var multiline=text.split("\n"),len_1=toMiddle?multiline.length-1:1;node.html(""),multiline.forEach(function(v,i){node.append("tspan").attr("x",0).attr("dy","".concat(0===i?dy[0]*len_1:dy[1],"em")).text(v)})}}}function getRectSegList(path){var _a=path.getBBox(),x=_a.x,y=_a.y,width=_a.width,height=_a.height;return[{x,y:y+height},{x,y},{x:x+width,y},{x:x+width,y:y+height}]}function getPathBox(path){var _a=getBoundingRect(path),width=_a.width,height=_a.height,items=getRectSegList(path);return{x:items[0].x,y:Math.min(items[0].y,items[1].y),width,height}}function getPointer(event,element){var _a,touches=event&&(null===(_a=event.touches||event.sourceEvent&&event.sourceEvent.touches)||void 0===_a?void 0:_a[0]),pointer$1=[0,0];try{pointer$1=pointer(touches||event,element)}catch(_b){}return pointer$1.map(function(v){return isNaN(v)?0:v})}function getBrushSelection(ctx){var selection,event=ctx.event,$el=ctx.$el,main=$el.subchart.main||$el.main;return event&&"brush"===event.type?selection=event.selection:main&&(selection=main.select(".bb-brush").node())&&(selection=brushSelection(selection)),selection}function getRect(relativeViewport,node,forceEval){void 0===forceEval&&(forceEval=!1);var _=function(n){return n[relativeViewport?"getBoundingClientRect":"getBBox"]()};return forceEval?_(node):!("rect"in node)||"rect"in node&&node.hasAttribute("width")&&node.rect.width!==+(node.getAttribute("width")||0)?node.rect=_(node):node.rect}function getBoundingRect(node,forceEval){return void 0===forceEval&&(forceEval=!1),getRect(!0,node,forceEval)}function getBBox(node,forceEval){return void 0===forceEval&&(forceEval=!1),getRect(!1,node,forceEval)}function getRandom(asStr,min,max){void 0===asStr&&(asStr=!0),void 0===min&&(min=0),void 0===max&&(max=1e4);var crpt=win.crypto||win.msCrypto,rand=crpt?min+crpt.getRandomValues(new Uint32Array(1))[0]%(max-min+1):Math.floor(Math.random()*(max-min)+min);return asStr?String(rand):rand}function findIndex(arr,v,start,end,isRotated){if(start>end)return-1;var mid=Math.floor((start+end)/2),_a=arr[mid],x=_a.x,_b=_a.w,w=void 0===_b?0:_b;return isRotated&&(x=arr[mid].y,w=arr[mid].h),v>=x&&v<=x+w?mid:v<x?findIndex(arr,v,start,mid-1,isRotated):findIndex(arr,v,mid+1,end,isRotated)}function brushEmpty(ctx){var selection=getBrushSelection(ctx);return!selection||selection[0]===selection[1]}function billboard_extend(target,source){for(var p in void 0===target&&(target={}),isArray(source)&&source.forEach(function(v){return billboard_extend(target,v)}),source)/^\d+$/.test(p)||p in target||(target[p]=source[p]);return target}var capitalize=function(str){return str.charAt(0).toUpperCase()+str.slice(1)};var toArray=function(v){return[].slice.call(v)};function getScrollPosition(node){var _a,_b,_c,_d,_e,_f;return{x:(null!==(_b=null!==(_a=win.pageXOffset)&&void 0!==_a?_a:win.scrollX)&&void 0!==_b?_b:0)+(null!==(_c=node.scrollLeft)&&void 0!==_c?_c:0),y:(null!==(_e=null!==(_d=win.pageYOffset)&&void 0!==_d?_d:win.scrollY)&&void 0!==_e?_e:0)+(null!==(_f=node.scrollTop)&&void 0!==_f?_f:0)}}function getTransformCTM(node,x,y,inverse){void 0===x&&(x=0),void 0===y&&(y=0),void 0===inverse&&(inverse=!0);var point=new DOMPoint(x,y),screen=node.getScreenCTM(),res=point.matrixTransform(inverse?null==screen?void 0:screen.inverse():screen);if(!1===inverse){var rect=getBoundingRect(node);res.x-=rect.x,res.y-=rect.y}return res}function getTranslation(node){var transform=node?node.transform:null,baseVal=transform&&transform.baseVal;return baseVal&&baseVal.numberOfItems?baseVal.getItem(0).matrix:{a:0,b:0,c:0,d:0,e:0,f:0}}function getUnique(data){var isDate=data[0]instanceof Date,d=(isDate?data.map(Number):data).filter(function(v,i,self){return self.indexOf(v)===i});return isDate?d.map(function(v){return new Date(v)}):d}function mergeArray(arr){return arr&&arr.length?arr.reduce(function(p,c){return p.concat(c)}):[]}function mergeObj(target){for(var objectN=[],_i=1;_i<arguments.length;_i++)objectN[_i-1]=arguments[_i];if(!objectN.length||1===objectN.length&&!objectN[0])return target;var source=objectN.shift();return isObject(target)&&isObject(source)&&Object.keys(source).forEach(function(key){if(!/^(__proto__|constructor|prototype)$/i.test(key)){var value=source[key];isObject(value)?(!target[key]&&(target[key]={}),target[key]=mergeObj(target[key],value)):target[key]=isArray(value)?value.concat():value}}),mergeObj.apply(void 0,__spreadArray([target],objectN,!1))}function sortValue(data,isAsc){var fn;return void 0===isAsc&&(isAsc=!0),data[0]instanceof Date?fn=isAsc?function(a,b){return a-b}:function(a,b){return b-a}:isAsc&&!data.every(isNaN)?fn=function(a,b){return a-b}:isAsc||(fn=function(a,b){return(a>b?-1:a<b&&1)||a===b&&0}),data.concat().sort(fn)}function getMinMax$1(type,data){var res=data.filter(function(v){return notEmpty(v)});return res.length?isNumber(res[0])?res=Math[type].apply(Math,res):res[0]instanceof Date&&(res=sortValue(res,"min"===type)[0]):res=void 0,res}var emulateEvent={mouse:function(){try{return new MouseEvent("t"),function(el,eventType,params){void 0===params&&(params={bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0}),el.dispatchEvent(new MouseEvent(eventType,params))}}catch(_a){return function(el,eventType,params){void 0===params&&(params={bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0});var mouseEvent=doc.createEvent("MouseEvent");mouseEvent.initMouseEvent(eventType,params.bubbles,params.cancelable,win,0,params.screenX,params.screenY,params.clientX,params.clientY,!1,!1,!1,!1,0,null),el.dispatchEvent(mouseEvent)}}}(),touch:function(el,eventType,params){var touchObj=new Touch(mergeObj({identifier:Date.now(),target:el,radiusX:2.5,radiusY:2.5,rotationAngle:10,force:.5},params));el.dispatchEvent(new TouchEvent(eventType,{cancelable:!0,bubbles:!0,shiftKey:!0,touches:[touchObj],targetTouches:[],changedTouches:[touchObj]}))}};function tplProcess(tpl,data){var res=tpl;for(var x in data)res=res.replace(new RegExp("{=".concat(x,"}"),"g"),data[x]);return res}function parseDate(date){var _a,parsedDate;if(date instanceof Date)parsedDate=date;else if(isString(date)){var config=this.config;parsedDate=null!==(_a=this.format.dataTime(config.data_xFormat)(date))&&void 0!==_a?_a:new Date(date)}else isNumber(date)&&!isNaN(date)&&(parsedDate=new Date(+date));return parsedDate&&!isNaN(+parsedDate)||console&&console.error&&console.error("Failed to parse x '".concat(date,"' to Date object")),parsedDate}function hasViewBox(svg){var attr=svg.attr("viewBox");return!!attr&&/(\d+(\.\d+)?){3}/.test(attr)}function isTabVisible(){return!1===(null==doc?void 0:doc.hidden)||"visible"===(null==doc?void 0:doc.visibilityState)}function runUntil(fn,conditionFn){!1===conditionFn()?requestAnimationFrame(function(){return runUntil(fn,conditionFn)}):fn()}var Options=function(){function Options(){return function deepClone(){for(var objectN=[],_i=0;_i<arguments.length;_i++)objectN[_i]=arguments[_i];var clone=function(v){if(isObject(v)&&v.constructor){var r=new v.constructor;for(var k in v)r[k]=clone(v[k]);return r}return v};return objectN.map(function(v){return clone(v)}).reduce(function(a,c){return __assign(__assign({},a),c)})}(main,boost,data$2,color$1,interaction$1,legend$2,title$1,tooltip$2,Options.data)}return Options.setOptions=function(options){this.data=options.reduce(function(a,c){return __assign(__assign({},a),c)},this.data)},Options.data={},Options}(),classes={element:function Element(){return{chart:null,main:null,svg:null,axis:{x:null,y:null,y2:null,subX:null},axisTooltip:{x:null,y:null,y2:null},defs:null,tooltip:null,legend:null,title:null,subchart:{main:null,bar:null,line:null,area:null},arcs:null,bar:null,candlestick:null,line:null,area:null,circle:null,radar:null,text:null,grid:{main:null,x:null,y:null},gridLines:{main:null,x:null,y:null},region:{main:null,list:null},eventRect:null,zoomResetBtn:null}},state:function State(){return{width:0,width2:0,height:0,height2:0,margin:{top:0,bottom:0,left:0,right:0},margin2:{top:0,bottom:0,left:0,right:0},margin3:{top:0,bottom:0,left:0,right:0},arcWidth:0,arcHeight:0,xAxisHeight:0,hasAxis:!1,hasFunnel:!1,hasRadar:!1,hasTreemap:!1,cssRule:{},current:{domain:void 0,width:0,height:0,dataMax:0,maxTickSize:{x:{width:0,height:0,ticks:[],clipPath:0,domain:""},y:{width:0,height:0,domain:""},y2:{width:0,height:0,domain:""}},types:[],needle:void 0,zoomDomain:null},isLegendRight:!1,isLegendInset:!1,isLegendTop:!1,isLegendLeft:!1,legendStep:0,legendItemWidth:0,legendItemHeight:0,legendHasRendered:!1,eventReceiver:{currentIdx:-1,rect:{},data:[],coords:[]},axis:{x:{padding:{left:0,right:0},tickCount:0}},rotatedPadding:{left:30,right:0,top:5},withoutFadeIn:{},inputType:"",datetimeId:"",clip:{id:"",idXAxis:"",idYAxis:"",idXAxisTickTexts:"",idGrid:"",idSubchart:"",path:"",pathXAxis:"",pathYAxis:"",pathXAxisTickTexts:"",pathGrid:""},event:null,dragStart:null,dragging:!1,flowing:!1,cancelClick:!1,mouseover:!1,rendered:!1,transiting:!1,redrawing:!1,resizing:!1,toggling:!1,zooming:!1,hasNegativeValue:!1,hasPositiveValue:!0,orgAreaOpacity:"0.2",orgConfig:{},hiddenTargetIds:[],hiddenLegendIds:[],focusedTargetIds:[],defocusedTargetIds:[],radius:0,innerRadius:0,outerRadius:void 0,innerRadiusRatio:0,gaugeArcWidth:0,radiusExpanded:0,xgridAttr:{x1:null,x2:null,y1:null,y2:null}}}},Store=function(){function Store(){var _this=this;Object.keys(classes).forEach(function(v){_this[v]=new classes[v]})}return Store.prototype.getStore=function(name){return this[name]},Store}(),KEY_colorPattern="__colorPattern__",KEY_dataMinMax="$dataMinMax",KEY_dataTotalSum="$dataTotalSum",KEY_dataTotalPerIndex="$totalPerIndex",KEY_legendItemTextBox="legendItemTextBox",KEY_radarTextWidth="$radarTextWidth",KEY_setOverOut="setOverOut",KEY_callOverOutForTouch="callOverOutForTouch",KEY_textRect="textRect",Cache=function(){function Cache(){this.cache={}}return Cache.prototype.add=function(key,value,isDataType){return void 0===isDataType&&(isDataType=!1),this.cache[key]=isDataType?this.cloneTarget(value):value,this.cache[key]},Cache.prototype.remove=function(key){var _this=this;(isString(key)?[key]:key).forEach(function(v){return delete _this.cache[v]})},Cache.prototype.get=function(key,isDataType){if(void 0===isDataType&&(isDataType=!1),isDataType&&Array.isArray(key)){for(var targets=[],i=0,id=void 0;id=key[i];i++)id in this.cache&&targets.push(this.cloneTarget(this.cache[id]));return targets}var value=this.cache[key];return isValue(value)?value:null},Cache.prototype.reset=function(all){for(var x in this.cache)(all||/^\$/.test(x))&&(this.cache[x]=null)},Cache.prototype.cloneTarget=function(target){return{id:target.id,id_org:target.id_org,values:target.values.map(function(d){return{x:d.x,value:d.value,id:d.id}})}},Cache}(),TYPE={AREA:"area",AREA_LINE_RANGE:"area-line-range",AREA_SPLINE:"area-spline",AREA_SPLINE_RANGE:"area-spline-range",AREA_STEP:"area-step",AREA_STEP_RANGE:"area-step-range",BAR:"bar",BUBBLE:"bubble",CANDLESTICK:"candlestick",DONUT:"donut",FUNNEL:"funnel",GAUGE:"gauge",LINE:"line",PIE:"pie",POLAR:"polar",RADAR:"radar",SCATTER:"scatter",SPLINE:"spline",STEP:"step",TREEMAP:"treemap"},TYPE_METHOD_NEEDED={AREA:"initArea",AREA_LINE_RANGE:"initArea",AREA_SPLINE:"initArea",AREA_SPLINE_RANGE:"initArea",AREA_STEP:"initArea",AREA_STEP_RANGE:"initArea",BAR:"initBar",BUBBLE:"initCircle",CANDLESTICK:"initCandlestick",DONUT:"initArc",FUNNEL:"initFunnel",GAUGE:"initArc",LINE:"initLine",PIE:"initArc",POLAR:"initPolar",RADAR:"initCircle",SCATTER:"initCircle",SPLINE:"initLine",STEP:"initLine",TREEMAP:"initTreemap"},TYPE_BY_CATEGORY={Area:[TYPE.AREA,TYPE.AREA_SPLINE,TYPE.AREA_SPLINE_RANGE,TYPE.AREA_LINE_RANGE,TYPE.AREA_STEP,TYPE.AREA_STEP_RANGE],AreaRange:[TYPE.AREA_SPLINE_RANGE,TYPE.AREA_LINE_RANGE,TYPE.AREA_STEP_RANGE],Arc:[TYPE.PIE,TYPE.DONUT,TYPE.GAUGE,TYPE.POLAR,TYPE.RADAR],Line:[TYPE.LINE,TYPE.SPLINE,TYPE.AREA,TYPE.AREA_SPLINE,TYPE.AREA_SPLINE_RANGE,TYPE.AREA_LINE_RANGE,TYPE.STEP,TYPE.AREA_STEP,TYPE.AREA_STEP_RANGE],Step:[TYPE.STEP,TYPE.AREA_STEP,TYPE.AREA_STEP_RANGE],Spline:[TYPE.SPLINE,TYPE.AREA_SPLINE,TYPE.AREA_SPLINE_RANGE]};function checkModuleImport(ctx){var $$=ctx,config=$$.config,type="";if(isEmpty(config.data_type||config.data_types)&&!$$[TYPE_METHOD_NEEDED.LINE])type="line";else for(var x in TYPE_METHOD_NEEDED){var t=TYPE[x];if($$.hasType(t)&&!$$[TYPE_METHOD_NEEDED[x]]){type=t;break}}type&&function logError(head,tail,info){var _a,prefix="[billboard.js]",hasConsole=null===(_a=win.console)||void 0===_a?void 0:_a.error;if(hasConsole){var tailMsg=["background:red;color:white;display:block;font-size:15px",tail];console.error.apply(console,__spreadArray([" ".concat(prefix," ").concat(head),"background:red;color:white;display:block;font-size:15px"],tailMsg,!1)),console.info("%c","font-size:15px",info)}throw Error("".concat(prefix," ").concat(head.replace(/\%c([a-z-]+)/i,"'$1' ")," ").concat(tail))}("Please, make sure if %c".concat(function camelize(str,separator){return void 0===separator&&(separator="-"),str.split(separator).map(function(v,i){return i?v.charAt(0).toUpperCase()+v.slice(1).toLowerCase():v.toLowerCase()}).join("")}(type)),"module has been imported and specified correctly.","https://github.com/naver/billboard.js/wiki/CHANGELOG-v2#modularization-by-its-functionality")}var setTimeout$1=win.setTimeout,clearTimeout$1=win.clearTimeout;function generateWait(){var transitionsToWait=[],f=function(selection,callback){runUntil(function(){null==callback||callback()},function loop(){for(var _a,done=0,i=0,t=void 0;t=transitionsToWait[i];i++)if(!0===t||(null===(_a=t.empty)||void 0===_a?void 0:_a.call(t)))done++;else{if(!1===isTabVisible()){done=transitionsToWait.length;break}try{t.transition()}catch(_b){done++}}return done===transitionsToWait.length})};return f.add=function(t){isArray(t)?transitionsToWait=transitionsToWait.concat(t):transitionsToWait.push(t)},f}var blob={};function runWorker(useWorker,fn,callback,depsFn){void 0===useWorker&&(useWorker=!0);var runFn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var res=fn.apply(void 0,args);callback(res)};if(win.Worker&&useWorker){var src_1=function getObjectURL(fn,depsFn){var _a,fnString=fn.toString(),key=fnString.replace(/(function|[\s\W\n])/g,"").substring(0,15);return key in blob||(blob[key]=new win.Blob(["".concat(null!==(_a=null==depsFn?void 0:depsFn.map(String).join(";"))&&void 0!==_a?_a:"","\n\n\t\t\tself.onmessage=function({data}) {\n\t\t\t\tconst result = (").concat(fnString,").apply(null, data);\n\t\t\t\tself.postMessage(result);\n\t\t\t};")],{type:"text/javascript"})),win.URL.createObjectURL(blob[key])}(fn,depsFn),worker_1=function getWorker(src){var worker=new win.Worker(src);return worker.onerror=function(e){console.error?console.error(e):console.log(e)},worker}(src_1);runFn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];worker_1.postMessage(args),worker_1.onmessage=function(e){return win.URL.revokeObjectURL(src_1),callback(e.data)}}}return runFn}function columns(columns){var newRows=[];return columns.forEach(function(col,i){var key=col[0];col.forEach(function(v,j){if(j>0){if(void 0===newRows[j-1]&&(newRows[j-1]={}),void 0===v)throw new Error("Source data is missing a component at (".concat(i,", ").concat(j,")!"));newRows[j-1][key]=v}})}),newRows}function rows(rows){var keys=rows[0],newRows=[];return rows.forEach(function(row,i){if(i>0){var newRow_1={};row.forEach(function(v,j){if(void 0===v)throw new Error("Source data is missing a component at (".concat(i,", ").concat(j,")!"));newRow_1[keys[j]]=v}),newRows.push(newRow_1)}}),newRows}function json(json,keysParam){var targetKeys,data,newRows=[];if(Array.isArray(json)){targetKeys=keysParam.x?keysParam.value.concat(keysParam.x):keysParam.value,newRows.push(targetKeys),json.forEach(function(o){var newRow=targetKeys.map(function(key){var v=function(object,path){if(void 0!==object[path])return object[path];var pathArray=path.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split("."),target=object;return pathArray.some(function(k){return!(target=target&&k in target?target[k]:void 0)}),target}(o,key);return void 0===v&&(v=null),v});newRows.push(newRow)}),data=rows(newRows)}else Object.keys(json).forEach(function(key){var _a,tmp=json[key].concat();null===(_a=tmp.unshift)||void 0===_a||_a.call(tmp,key),newRows.push(tmp)}),data=columns(newRows);return data}function convertCsvTsvToData(parser,xsv){var d,rows=parser.rows(xsv);return 1===rows.length?(d=[{}],rows[0].forEach(function(id){d[0][id]=null})):d=parser.parse(xsv),d}function billboard_csv(xsv){return convertCsvTsvToData({rows:csvParseRows,parse:csvParse},xsv)}function billboard_tsv(tsv){return convertCsvTsvToData({rows:tsvParseRows,parse:tsvParse},tsv)}function getDataKeyForJson(keysParam,config){var keys=keysParam||(null==config?void 0:config.data_keys);return(null==keys?void 0:keys.x)&&(config.data_x=keys.x),keys}function setXS(ids,data,params){var xsData,_this=this,$$=this,config=$$.config;ids.forEach(function(id){var xKey=$$.getXKey(id);if(params.customX||params.timeSeries?params.xs.indexOf(xKey)>=0?xsData=(params.appendXs&&$$.data.xs[id]||[]).concat(data.map(function(d,i){var rawX=isValue(d[xKey]);return!!rawX&&$$.generateTargetX(rawX,id,i)}).filter(function(v){return!1!==v})):config.data_x?xsData=_this.getOtherTargetXs():notEmpty(config.data_xs)&&(xsData=$$.getXValuesOfXKey(xKey,$$.data.targets)):xsData=data.map(function(d,i){return i}),!xsData)throw new Error('x is not defined for id = "'.concat(id,'".'));$$.data.xs[id]=xsData})}var dataConvert={convertData:function(args,callback){var config=this.config,useWorker=function(d){return!(!(null==d?void 0:d.length)||isEmpty(d[0]))&&config.boost_useWorker},data=args;if(args.bindto&&(data={},["url","mimeType","headers","keys","json","keys","rows","columns"].forEach(function(v){var key="data_".concat(v);key in args&&(data[v]=args[key])})),data.url&&callback)!function url(url,mimeType,headers,keys,done){void 0===mimeType&&(mimeType="csv");var req=new XMLHttpRequest,converter={csv:billboard_csv,tsv:billboard_tsv,json};req.open("GET",url),headers&&Object.keys(headers).forEach(function(key){req.setRequestHeader(key,headers[key])}),req.onreadystatechange=function(){if(4===req.readyState){if(200!==req.status)throw new Error("".concat(url,": Something went wrong loading!"));var response=req.responseText;response&&done.call(this,converter[mimeType]("json"===mimeType?JSON.parse(response):response,keys))}},req.send()}(data.url,data.mimeType,data.headers,getDataKeyForJson(data.keys,config),callback);else if(data.json)runWorker(useWorker(data.json),json,callback,[columns,rows])(data.json,getDataKeyForJson(data.keys,config));else if(data.rows)runWorker(useWorker(data.rows),rows,callback)(data.rows);else if(data.columns)runWorker(useWorker(data.columns),columns,callback)(data.columns);else if(args.bindto)throw Error("url or json or rows or columns is required.")},convertDataToTargets:function(data,appendXs){var $$=this,axis=$$.axis,config=$$.config,state=$$.state,chartType=config.data_type,dataKeys=Object.keys(data[0]||{}),_a=dataKeys.length?dataKeys.reduce(function(acc,key){return $$.isX.call($$,key)?acc.xs.push(key):$$.isNotX.call($$,key)&&acc.ids.push(key),acc},{ids:[],xs:[]}):{ids:[],xs:[]},ids=_a.ids,params={appendXs,xs:_a.xs,idConverter:config.data_idConverter.bind($$.api),categorized:null==axis?void 0:axis.isCategorized(),timeSeries:null==axis?void 0:axis.isTimeSeries(),customX:null==axis?void 0:axis.isCustomX()};setXS.bind($$)(ids,data,params);var targets=ids.map(function(id,index){var categorySet,convertedId=config.data_idConverter.bind($$.api)(id),xKey=$$.getXKey(id),isCategory=params.customX&&params.categorized,hasCategory=isCategory&&(categorySet=new Set(config.axis_x_categories),data.every(function(v){return categorySet.has(v.x)})),isDataAppend=data.__append__,xIndex=null===xKey&&isDataAppend?$$.api.data.values(id).length:0;return{id:convertedId,id_org:id,values:data.map(function(d,i){var x,rawX=d[xKey],value=d[id];return value=null===value||isNaN(value)||isObject(value)?isArray(value)||isObject(value)?value:null:+value,!isCategory&&!state.hasRadar||0!==index||isUndefined(rawX)?x=$$.generateTargetX(rawX,id,xIndex+i):(hasCategory||0!==index||0!==i||isDataAppend||(config.axis_x_categories=[]),-1===(x=config.axis_x_categories.indexOf(rawX))&&(x=config.axis_x_categories.length,config.axis_x_categories.push(rawX))),(isUndefined(value)||$$.data.xs[id].length<=i)&&(x=void 0),{x,value,id:convertedId,index:-1}}).filter(function(v){return isDefined(v.x)})}});if(targets.forEach(function(t){var _a;config.data_xSort&&(t.values=t.values.sort(function(v1,v2){return(v1.x||0===v1.x?v1.x:1/0)-(v2.x||0===v2.x?v2.x:1/0)})),t.values.forEach(function(v,i){return v.index=i}),null===(_a=$$.data.xs[t.id])||void 0===_a||_a.sort(function(v1,v2){return v1-v2})}),state.hasNegativeValue=$$.hasNegativeValueInTargets(targets),state.hasPositiveValue=$$.hasPositiveValueInTargets(targets),chartType&&$$.isValidChartType(chartType)){var targetIds=$$.mapToIds(targets).filter(function(id){return!(id in config.data_types)||!$$.isValidChartType(config.data_types[id])});$$.setTargetType(targetIds,chartType)}return targets.forEach(function(d){return $$.cache.add(d.id_org,d,!0)}),targets}},data$1={isX:function(key){var config=this.config,dataKey=config.data_x&&key===config.data_x,existValue=notEmpty(config.data_xs)&&function hasValue(dict,value){var found=!1;return Object.keys(dict).forEach(function(key){return dict[key]===value&&(found=!0)}),found}(config.data_xs,key);return dataKey||existValue},isNotX:function(key){return!this.isX(key)},isStackNormalized:function(){var config=this.config;return!(!config.data_stack_normalize||!config.data_groups.length)},isGrouped:function(id){var groups=this.config.data_groups;return id?groups.some(function(v){return v.indexOf(id)>=0&&v.length>1}):groups.length>0},getXKey:function(id){var config=this.config;return config.data_x?config.data_x:notEmpty(config.data_xs)?config.data_xs[id]:null},getXValuesOfXKey:function(key,targets){var xValues,$$=this;return(targets&&notEmpty(targets)?$$.mapToIds(targets):[]).forEach(function(id){$$.getXKey(id)===key&&(xValues=$$.data.xs[id])}),xValues},getIndexByX:function(x,basedX){return basedX?basedX.indexOf(isString(x)?x:+x):(this.filterByX(this.data.targets,x)[0]||{index:null}).index},getXValue:function(id,i){return id in this.data.xs&&this.data.xs[id]&&isValue(this.data.xs[id][i])?this.data.xs[id][i]:i},getOtherTargetXs:function(){var idsForX=Object.keys(this.data.xs);return idsForX.length?this.data.xs[idsForX[0]]:null},getOtherTargetX:function(index){var xs=this.getOtherTargetXs();return xs&&index<xs.length?xs[index]:null},addXs:function(xs){var config=this.config;Object.keys(xs).forEach(function(id){config.data_xs[id]=xs[id]})},isMultipleX:function(){return!this.config.axis_x_forceAsSingle&&(notEmpty(this.config.data_xs)||this.hasType("bubble")||this.hasType("scatter"))},addName:function(data){var name,config=this.config;return data&&(name=config.data_names[data.id],data.name=void 0!==name?name:data.id),data},getAllValuesOnIndex:function(index,filterNull){void 0===filterNull&&(filterNull=!1);var $$=this,value=$$.filterTargetsToShow($$.data.targets).map(function(t){return $$.addName($$.getValueOnIndex(t.values,index))});return filterNull&&(value=value.filter(function(v){return v&&"value"in v&&isValue(v.value)})),value},getValueOnIndex:function(values,index){var valueOnIndex=values.filter(function(v){return v.index===index});return valueOnIndex.length?valueOnIndex[0]:null},updateTargetX:function(targets,x){var $$=this;targets.forEach(function(t){t.values.forEach(function(v,i){v.x=$$.generateTargetX(x[i],t.id,i)}),$$.data.xs[t.id]=x})},updateTargetXs:function(targets,xs){var $$=this;targets.forEach(function(t){xs[t.id]&&$$.updateTargetX([t],xs[t.id])})},generateTargetX:function(rawX,id,index){var axis=this.axis,x=(null==axis?void 0:axis.isCategorized())?index:rawX||index;if(null==axis?void 0:axis.isTimeSeries()){var fn=parseDate.bind(this);x=fn(rawX||this.getXValue(id,index))}else(null==axis?void 0:axis.isCustomX())&&!(null==axis?void 0:axis.isCategorized())&&(x=isValue(rawX)?+rawX:this.getXValue(id,index));return x},updateXs:function(values){values.length&&(this.axis.xs=values.map(function(v){return v.x}))},getPrevX:function(i){var x=this.axis.xs[i-1];return isDefined(x)?x:null},getNextX:function(i){var x=this.axis.xs[i+1];return isDefined(x)?x:null},getBaseValue:function(data){var $$=this,hasAxis=$$.state.hasAxis,value=data.value;return value&&hasAxis&&($$.isAreaRangeType(data)?value=$$.getRangedData(data,"mid"):$$.isBubbleZType(data)&&(value=$$.getBubbleZData(value,"y"))),value},getMinMaxValue:function(data){var min,max,getBaseValue=this.getBaseValue.bind(this);return(data||this.data.targets.map(function(t){return t.values})).forEach(function(v,i){var value=v.map(getBaseValue).filter(isNumber);min=Math.min.apply(Math,__spreadArray([i?min:1/0],value,!1)),max=Math.max.apply(Math,__spreadArray([i?max:-1/0],value,!1))}),{min,max}},getMinMaxData:function(){var $$=this,cacheKey=KEY_dataMinMax,minMaxData=$$.cache.get(cacheKey);if(!minMaxData){var data=$$.data.targets.map(function(t){return t.values}),minMax=$$.getMinMaxValue(data),min_1=[],max_1=[],minVal_1=minMax.min,maxVal_1=minMax.max;data.forEach(function(v){var minData=$$.getFilteredDataByValue(v,minVal_1),maxData=$$.getFilteredDataByValue(v,maxVal_1);minData.length&&(min_1=min_1.concat(minData)),maxData.length&&(max_1=max_1.concat(maxData))}),$$.cache.add(cacheKey,minMaxData={min:min_1,max:max_1})}return minMaxData},getTotalPerIndex:function(){var cacheKey=KEY_dataTotalPerIndex,sum=this.cache.get(cacheKey);return!this.config.data_groups.length&&!this.isStackNormalized()||sum||(sum=[],this.data.targets.forEach(function(row){row.values.forEach(function(v,i){sum[i]||(sum[i]=0),sum[i]+=~~v.value})})),sum},getTotalDataSum:function(subtractHidden){var cacheKey=KEY_dataTotalSum,total=this.cache.get(cacheKey);return isNumber(total)||(total=this.data.targets.reduce(function(acc,t){return acc+t.values.reduce(function(sum,v){return sum+~~v.value},0)},0),this.cache.add(cacheKey,total)),subtractHidden&&(total-=this.getHiddenTotalDataSum()),total},getHiddenTotalDataSum:function(){var api=this.api,hiddenTargetIds=this.state.hiddenTargetIds,total=0;return hiddenTargetIds.length&&(total=api.data.values.bind(api)(hiddenTargetIds).reduce(function(p,c){return p+c})),total},getFilteredDataByValue:function(data,value){var _this=this;return data.filter(function(t){return _this.getBaseValue(t)===value})},getMaxDataCount:function(){return Math.max.apply(Math,__spreadArray(__spreadArray([],this.data.targets.map(function(t){return t.values.length}),!1),[0],!1))},getMaxDataCountTarget:function(){var target=this.filterTargetsToShow()||[],length=target.length,isInverted=this.config.axis_x_inverted;return length>1?target=sortValue(getUnique(target=target.map(function(t){return t.values}).reduce(function(a,b){return a.concat(b)}).map(function(v){return v.x}))).map(function(x,index,array){return{x,index:isInverted?array.length-index-1:index}}):length&&(target=target[0].values.concat()),target},mapToIds:function(targets){return targets.map(function(d){return d.id})},mapToTargetIds:function(ids){return ids?isArray(ids)?ids.concat():[ids]:this.mapToIds(this.data.targets)},hasTarget:function(targets,id){for(var ids=this.mapToIds(targets),i=0,val=void 0;val=ids[i];i++)if(val===id)return!0;return!1},isTargetToShow:function(targetId){return this.state.hiddenTargetIds.indexOf(targetId)<0},isLegendToShow:function(targetId){return this.state.hiddenLegendIds.indexOf(targetId)<0},filterTargetsToShow:function(targets){var $$=this;return(targets||$$.data.targets).filter(function(t){return $$.isTargetToShow(t.id)})},mapTargetsToUniqueXs:function(targets){var axis=this.axis,xs=[];return(null==targets?void 0:targets.length)&&(xs=getUnique(mergeArray(targets.map(function(t){return t.values.map(function(v){return+v.x})}))),xs=(null==axis?void 0:axis.isTimeSeries())?xs.map(function(x){return new Date(+x)}):xs.map(Number)),sortValue(xs)},addTargetIds:function(type,targetIds){var state=this.state;(isArray(targetIds)?targetIds:[targetIds]).forEach(function(v){state[type].indexOf(v)<0&&state[type].push(v)})},removeTargetIds:function(type,targetIds){var state=this.state;(isArray(targetIds)?targetIds:[targetIds]).forEach(function(v){var index=state[type].indexOf(v);index>=0&&state[type].splice(index,1)})},addHiddenTargetIds:function(targetIds){this.addTargetIds("hiddenTargetIds",targetIds)},removeHiddenTargetIds:function(targetIds){this.removeTargetIds("hiddenTargetIds",targetIds)},addHiddenLegendIds:function(targetIds){this.addTargetIds("hiddenLegendIds",targetIds)},removeHiddenLegendIds:function(targetIds){this.removeTargetIds("hiddenLegendIds",targetIds)},getValuesAsIdKeyed:function(targets){var $$=this,hasAxis=$$.state.hasAxis,ys={},isMultipleX=$$.isMultipleX(),xs=isMultipleX?$$.mapTargetsToUniqueXs(targets).map(function(v){return isString(v)?v:+v}):null;return targets.forEach(function(t){var data=[];t.values.filter(function(_a){var value=_a.value;return isValue(value)||null===value}).forEach(function(v){var value=v.value;null!==value&&$$.isCandlestickType(v)&&(value=isArray(value)?value.slice(0,4):[value.open,value.high,value.low,value.close]),isArray(value)?data.push.apply(data,value):isObject(value)&&"high"in value?data.push.apply(data,Object.values(value)):$$.isBubbleZType(v)?data.push(hasAxis&&$$.getBubbleZData(value,"y")):isMultipleX?data[$$.getIndexByX(v.x,xs)]=value:data.push(value)}),ys[t.id]=data}),ys},checkValueInTargets:function(targets,checker){return Object.keys(targets).some(function(id){return targets[id].values.some(function(v){return checker(v.value)})})},hasMultiTargets:function(){return this.filterTargetsToShow().length>1},hasNegativeValueInTargets:function(targets){return this.checkValueInTargets(targets,function(v){return v<0})},hasPositiveValueInTargets:function(targets){return this.checkValueInTargets(targets,function(v){return v>0})},orderTargets:function(targetsValue){var targets=__spreadArray([],targetsValue,!0),fn=this.getSortCompareFn();return fn&&targets.sort(fn),targets},getSortCompareFn:function(isReversed){void 0===isReversed&&(isReversed=!1);var fn,order=this.config.data_order,orderAsc=/asc/i.test(order),orderDesc=/desc/i.test(order);if(orderAsc||orderDesc){var reducer_1=function(p,c){return p+Math.abs(c.value)},sum_1=function(v){return isNumber(v)?v:"values"in v?v.values.reduce(reducer_1,0):v.value};fn=function(t1,t2){var t1Sum=sum_1(t1),t2Sum=sum_1(t2);return isReversed?orderAsc?t1Sum-t2Sum:t2Sum-t1Sum:orderAsc?t2Sum-t1Sum:t1Sum-t2Sum}}else isFunction(order)&&(fn=order.bind(this.api));return fn||null},filterByX:function(targets,x){return mergeArray(targets.map(function(t){return t.values})).filter(function(v){return v.x-x===0})},filterNullish:function(data){var filter=function(v){return isValue(v.value)};return data?data.filter(function(v){return"value"in v?filter(v):v.values.some(filter)}):data},filterRemoveNull:function(data){var _this=this;return data.filter(function(d){return isValue(_this.getBaseValue(d))})},filterByXDomain:function(targets,xDomain){return targets.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(v){return xDomain[0]<=v.x&&v.x<=xDomain[1]})}})},hasDataLabel:function(){var dataLabels=this.config.data_labels;return isBoolean(dataLabels)&&dataLabels||isObjectType(dataLabels)&&notEmpty(dataLabels)},hasNullDataValue:function(targets){return targets.some(function(_a){return null===_a.value})},getDataIndexFromEvent:function(event){var index,$el=this.$el,config=this.config,_a=this.state,hasRadar=_a.hasRadar,inputType=_a.inputType,_b=_a.eventReceiver,coords=_b.coords,rect=_b.rect;if(hasRadar){var target=event.target;/tspan/i.test(target.tagName)&&(target=target.parentNode);var d=src_select(target).datum();index=d&&1===Object.keys(d).length?d.index:void 0}else{var isRotated=config.axis_rotated,scrollPos=getScrollPosition($el.chart.node()),e="touch"===inputType&&event.changedTouches?event.changedTouches[0]:event,point=isRotated?e.clientY+scrollPos.y:e.clientX+scrollPos.x;if(hasViewBox($el.svg)){var pos=[point,0];isRotated&&pos.reverse(),point=getTransformCTM.apply(void 0,__spreadArray([$el.eventRect.node()],pos,!1))[isRotated?"y":"x"]}else point-=isRotated?rect.top:rect.left;index=findIndex(coords,point,0,coords.length-1,isRotated)}return index},getDataLabelLength:function(min,max,key){var _a,$$=this;return(null===(_a=$$.getTextRect([min,max].map(function(v){return $$.dataLabelFormat()(v)})))||void 0===_a?void 0:_a.map(function(rect){return 1.3*rect[key]}))||[0,0]},isNoneArc:function(d){return this.hasTarget(this.data.targets,d.id)},isArc:function(d){return"data"in d&&this.hasTarget(this.data.targets,d.data.id)},findSameXOfValues:function(values,index){var i,targetX=values[index].x,sames=[];for(i=index-1;i>=0&&targetX===values[i].x;i--)sames.push(values[i]);for(i=index;i<values.length&&targetX===values[i].x;i++)sames.push(values[i]);return sames},findClosestFromTargets:function(targets,pos){var $$=this,candidates=targets.map(function(target){return $$.findClosest(target.values,pos)});return $$.findClosest(candidates,pos)},findClosest:function(values,pos){var closest,$$=this,main=$$.$el.main,data=values.filter(function(v){return v&&isValue(v.value)});return data.filter(function(v){return $$.isBarType(v.id)||$$.isCandlestickType(v.id)}).forEach(function(v){var selector=$$.isBarType(v.id)?".".concat($BAR.chartBar,".").concat($COMMON.target).concat($$.getTargetSelectorSuffix(v.id)," .").concat($BAR.bar,"-").concat(v.index):".".concat($CANDLESTICK.chartCandlestick,".").concat($COMMON.target).concat($$.getTargetSelectorSuffix(v.id)," .").concat($CANDLESTICK.candlestick,"-").concat(v.index," path");!closest&&$$.isWithinBar(main.select(selector).node())&&(closest=v)}),data.filter(function(v){return!$$.isBarType(v.id)&&!$$.isCandlestickType(v.id)}).forEach(function(v){var d=$$.dist(v,pos);d<$$.getPointSensitivity(v)&&(closest=v)}),closest},dist:function(data,pos){var isRotated=this.config.axis_rotated,scale=this.scale,xIndex=+isRotated,yIndex=+!isRotated,y=this.circleY(data,data.index),x=(scale.zoom||scale.x)(data.x);return Math.sqrt(Math.pow(x-pos[xIndex],2)+Math.pow(y-pos[yIndex],2))},convertValuesToStep:function(values){var axis=this.axis,stepType=this.config.line_step_type,isCategorized=!!axis&&axis.isCategorized(),converted=isArray(values)?values.concat():[values];if(!isCategorized&&!/step\-(after|before)/.test(stepType))return values;if(converted.length){var head=converted[0],tail=converted[converted.length-1],id=head.id,x=head.x;converted.unshift({x:--x,value:head.value,id}),isCategorized&&"step-after"===stepType&&converted.unshift({x:--x,value:head.value,id}),x=tail.x,converted.push({x:++x,value:tail.value,id}),isCategorized&&"step-before"===stepType&&converted.push({x:++x,value:tail.value,id})}return converted},convertValuesToRange:function(values){var converted=isArray(values)?values.concat():[values],ranges=[];return converted.forEach(function(range){var x=range.x,id=range.id;ranges.push({x,id,value:range.value[0]}),ranges.push({x,id,value:range.value[2]})}),ranges},updateDataAttributes:function(name,attrs){var current=this.config["data_".concat(name)];return isUndefined(attrs)||(Object.keys(attrs).forEach(function(id){current[id]=attrs[id]}),this.redraw({withLegend:!0})),current},getRangedData:function(d,key,type){void 0===key&&(key=""),void 0===type&&(type="areaRange");var value=null==d?void 0:d.value;if(isArray(value)){if("bar"===type)return value.reduce(function(a,c){return c-a});var index={areaRange:["high","mid","low"],candlestick:["open","high","low","close","volume"]}[type].indexOf(key);return index>=0&&value?value[index]:void 0}return value&&key?value[key]:value},setRatioForGroupedData:function(data){var $$=this;if($$.config.data_groups.length&&data.some(function(d){return $$.isGrouped(d.id)})){var setter_1=function(d){return $$.getRatio("index",d,!0)};data.forEach(function(v){"values"in v?v.values.forEach(setter_1):setter_1(v)})}},getRatio:function(type,d,asPercent){void 0===asPercent&&(asPercent=!1);var $$=this,config=$$.config,state=$$.state,api=$$.api,ratio=0;if(d&&api.data.shown().length)if(ratio=d.ratio||d.value,"arc"===type)if($$.pie.padAngle()())ratio=d.value/$$.getTotalDataSum(!0);else{var gaugeArcLength=config.gauge_fullCircle?$$.getArcLength():-2*$$.getStartingAngle(),arcLength=$$.hasType("gauge")?gaugeArcLength:2*Math.PI;ratio=(d.endAngle-d.startAngle)/arcLength}else if("index"===type){var dataValues=api.data.values.bind(api),total=this.getTotalPerIndex();if(state.hiddenTargetIds.length){var hiddenSum_1=dataValues(state.hiddenTargetIds,!1);hiddenSum_1.length&&(hiddenSum_1=hiddenSum_1.reduce(function(acc,curr){return acc.map(function(v,i){return~~v+curr[i]})}),total=total.map(function(v,i){return v-hiddenSum_1[i]}))}var divisor=total[d.index];d.ratio=isNumber(d.value)&&total&&divisor?d.value/divisor:0,ratio=d.ratio}else if("radar"===type)ratio=parseFloat(String(Math.max(d.value,0)))/state.current.dataMax*config.radar_size_ratio;else if("bar"===type){var max=$$.getYScaleById.bind($$)(d.id).domain().reduce(function(a,c){return c-a});ratio=0===max?0:Math.abs($$.getRangedData(d,null,type)/max)}else"treemap"===type&&(ratio/=$$.getTotalDataSum(!0));return asPercent&&ratio?100*ratio:ratio},updateDataIndexByX:function(tickValues){var tickValueMap=tickValues.reduce(function(out,tick,index){return out[Number(tick.x)]=index,out},{});this.data.targets.forEach(function(t){t.values.forEach(function(value,valueIndex){var index=tickValueMap[Number(value.x)];void 0===index&&(index=valueIndex),value.index=index})})},isBubbleZType:function(d){return this.isBubbleType(d)&&(isObject(d.value)&&("z"in d.value||"y"in d.value)||isArray(d.value)&&d.value.length>=2)},isBarRangeType:function(d){var value=d.value;return this.isBarType(d)&&isArray(value)&&value.length>=2&&value.every(isNumber)},getDataById:function(id){var _a,d=this.cache.get(id)||this.api.data(id);return null!==(_a=null==d?void 0:d[0])&&void 0!==_a?_a:d}};function callDone(fn,resizeAfter){void 0===resizeAfter&&(resizeAfter=!1);var api=this.api;resizeAfter&&this.api.flush(!0),null==fn||fn.call(api)}var dataLoad={load:function(rawTargets,args){var $$=this,axis=$$.axis,data=$$.data,org=$$.org,scale=$$.scale,append=args.append,zoomState={domain:null,currentDomain:null,x:null},targets=rawTargets;targets&&(args.filter&&(targets=targets.filter(args.filter)),(args.type||args.types)&&targets.forEach(function(t){var _a,type=(null===(_a=args.types)||void 0===_a?void 0:_a[t.id])||args.type;$$.setTargetType(t.id,type)}),data.targets.forEach(function(d){for(var i=0;i<targets.length;i++)if(d.id===targets[i].id){d.values=append?d.values.concat(targets[i].values):targets[i].values,targets.splice(i,1);break}}),data.targets=data.targets.concat(targets)),$$.updateTargets(data.targets),scale.zoom&&(zoomState.x=axis.isCategorized()?scale.x.orgScale():(org.xScale||scale.x).copy(),zoomState.domain=$$.getXDomain(data.targets),zoomState.x.domain(zoomState.domain),zoomState.currentDomain=$$.zoom.getDomain(),$$.withinRange(zoomState.currentDomain,void 0,zoomState.domain)||(scale.x.domain(zoomState.domain),scale.zoom=null,$$.$el.eventRect.property("__zoom",null))),$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),scale.zoom?(org.xDomain=zoomState.domain,org.xScale=zoomState.x,axis.isCategorized()&&(zoomState.currentDomain=$$.getZoomDomainValue(zoomState.currentDomain),org.xDomain=$$.getZoomDomainValue(org.xDomain),org.xScale=zoomState.x.domain(org.xDomain)),$$.updateCurrentZoomTransform(zoomState.x,zoomState.currentDomain)):org.xScale&&org.xScale.domain(org.xDomain),$$.updateTypesElements(),callDone.call($$,args.done,args.resizeAfter)},loadFromArgs:function(args){var $$=this;$$.config&&($$.cache.reset(),$$.convertData(args,function(d){var data=args.data||d;args.append&&(data.__append__=!0),data&&$$.load($$.convertDataToTargets.call($$,data),args)}))},unload:function(rawTargetIds,customDoneCb){var _a,$$=this,state=$$.state,$el=$$.$el,$T=$$.$T,hasLegendDefsPoint=!!(null===(_a=$$.hasLegendDefsPoint)||void 0===_a?void 0:_a.call($$)),done=customDoneCb,targetIds=rawTargetIds;if($$.cache.reset(),done||(done=function(){}),targetIds=targetIds.filter(function(id){return $$.hasTarget($$.data.targets,id)}),targetIds&&0!==targetIds.length){var targets=$el.svg.selectAll(targetIds.map(function(id){return $$.selectorTarget(id)}));$T(targets).style("opacity","0").remove().call(endall,done),targetIds.forEach(function(id){var _a,suffixId=$$.getTargetSelectorSuffix(id);state.withoutFadeIn[id]=!1,$el.legend&&$el.legend.selectAll(".".concat($LEGEND.legendItem).concat(suffixId)).remove(),$$.data.targets=$$.data.targets.filter(function(t){return t.id!==id}),hasLegendDefsPoint&&(null===(_a=$el.defs)||void 0===_a||_a.select("#".concat($$.getDefsPointId(suffixId))).remove())}),state.hasFunnel&&$$.updateFunnel($$.data.targets),state.hasTreemap&&$$.updateTargetsForTreemap($$.data.targets),$$.updateTypesElements()}else done()}},interaction={setExpand:function(index,id,reset){var config=this.config;this.$el.circle&&config.point_focus_expand_enabled&&this.expandCircles(index,id,reset),this.expandBarTypeShapes(!0,index,id,reset)},expandBarTypeShapes:function(expand,i,id,reset){void 0===expand&&(expand=!0);var $$=this;["bar","candlestick"].filter(function(v){return $$.$el[v]}).forEach(function(v){reset&&$$.$el[v].classed($COMMON.EXPANDED,!1),$$.getShapeByIndex(v,i,id).classed($COMMON.EXPANDED,expand)})},setOverOut:function(isOver,d){var $$=this,config=$$.config,_a=$$.state,hasFunnel=_a.hasFunnel,hasRadar=_a.hasRadar,hasTreemap=_a.hasTreemap,main=$$.$el.main,isArcishData=isObject(d);if(isArcishData||-1!==d){var callback_1=config[isOver?"data_onover":"data_onout"].bind($$.api);if(config.color_onover&&$$.setOverColor(isOver,d,isArcishData),isArcishData){var suffix=$$.getTargetSelectorSuffix(d.id),selector=hasFunnel||hasTreemap?"".concat($COMMON.target+suffix," .").concat($SHAPE.shape):$ARC.arc+suffix;callback_1(d,main.select(".".concat(selector)).node())}else if(config.tooltip_grouped)isOver&&(hasRadar&&$$.isPointFocusOnly()?$$.showCircleFocus($$.getAllValuesOnIndex(d,!0)):$$.setExpand(d,null,!0)),!$$.isMultipleX()&&main.selectAll(".".concat($SHAPE.shape,"-").concat(d)).each(function(d){callback_1(d,this)});else{var last_1=$$.cache.get(KEY_setOverOut)||[],shapesAtIndex=main.selectAll(".".concat($SHAPE.shape,"-").concat(d)).filter(function(d){return $$.isWithinShape(this,d)}),shape=shapesAtIndex.filter(function(){var _this=this;return last_1.every(function(v){return v!==_this})});if(!isOver||shapesAtIndex.empty()||last_1.length===shape.size()&&shape.nodes().every(function(v,i){return v!==last_1[i]}))for(;last_1.length;){var target=last_1.pop();config.data_onout.bind($$.api)(src_select(target).datum(),target)}shape.each(function(){isOver&&(callback_1(src_select(this).datum(),this),last_1.push(this))}),$$.cache.add(KEY_setOverOut,last_1)}}},callOverOutForTouch:function(d){var last=this.cache.get(KEY_callOverOutForTouch);(isObject(d)&&last?d.id!==last.id:d!==last)&&((last||isNumber(last))&&this.setOverOut(!1,last),(d||isNumber(d))&&this.setOverOut(!0,d),this.cache.add(KEY_callOverOutForTouch,d))},getDraggableSelection:function(){var $$=this,config=$$.config,state=$$.state;return config.interaction_enabled&&config.data_selection_draggable&&$$.drag?drag().on("drag",function(event){state.event=event,$$.drag(getPointer(event,this))}).on("start",function(event){state.event=event,$$.dragstart(getPointer(event,this))}).on("end",function(event){state.event=event,$$.dragend()}):function(){}},dispatchEvent:function(type,index,mouse){var _a,_b,_c,$$=this,config=$$.config,_d=$$.state,eventReceiver=_d.eventReceiver,hasAxis=_d.hasAxis,hasFunnel=_d.hasFunnel,hasRadar=_d.hasRadar,hasTreemap=_d.hasTreemap,_e=$$.$el,eventRect=_e.eventRect,funnel=_e.funnel,radar=_e.radar,svg=_e.svg,treemap=_e.treemap,element=null===(_c=null===(_b=(hasFunnel||hasTreemap)&&eventReceiver.rect||hasRadar&&radar.axes.select(".".concat($AXIS.axis,"-").concat(index," text"))||eventRect||(null===(_a=$$.getArcElementByIdOrIndex)||void 0===_a?void 0:_a.call($$,index)))||void 0===_b?void 0:_b.node)||void 0===_c?void 0:_c.call(_b);if(element){var isMultipleX=$$.isMultipleX(),isRotated=config.axis_rotated,_f=getBoundingRect(element),width=_f.width,left=_f.left,top_1=_f.top;if(hasAxis&&!hasRadar&&!isMultipleX){var coords=eventReceiver.coords[index];coords?(width=coords.w,left+=coords.x,top_1+=coords.y):(width=0,left=0,top_1=0)}var x=left+(mouse?mouse[0]:0)+(isMultipleX||isRotated?0:width/2),y=top_1+(mouse?mouse[1]:0)+(isRotated?4:0);if(hasViewBox(svg)){var ctm=getTransformCTM($$.$el.eventRect.node(),x,y,!1);x=ctm.x,y=ctm.y}var params={screenX:x,screenY:y,clientX:x,clientY:y,bubbles:hasRadar};(hasFunnel||hasTreemap)&&(element=(null!=funnel?funnel:treemap).node()),emulateEvent[/^(mouse|click)/.test(type)?"mouse":"touch"](element,type,params)}},setDragStatus:function(isDragging){this.state.dragging=isDragging},unbindZoomEvent:function(){var _a=this.$el,eventRect=_a.eventRect,zoomResetBtn=_a.zoomResetBtn;null==eventRect||eventRect.on(".zoom wheel.zoom .drag",null),null==zoomResetBtn||zoomResetBtn.on("click",null).style("display","none")},unbindAllEvents:function(){var _a,_b=this.$el,arcs=_b.arcs,eventRect=_b.eventRect,legend=_b.legend,region=_b.region,svg=_b.svg,treemap=_b.treemap,brush=this.brush,list=["wheel","click","mouseover","mousemove","mouseout","touchstart","touchmove","touchend","touchstart.eventRect","touchmove.eventRect","touchend.eventRect",".brush",".drag",".zoom","wheel.zoom","dblclick.zoom"].join(" ");[svg,eventRect,null==region?void 0:region.list,null==brush?void 0:brush.getSelection(),null==arcs?void 0:arcs.selectAll("path"),null==legend?void 0:legend.selectAll("g"),treemap].forEach(function(v){return null==v?void 0:v.on(list,null)}),null===(_a=this.unbindZoomEvent)||void 0===_a||_a.call(this)}},classModule={generateClass:function(prefix,targetId){return" ".concat(prefix," ").concat(prefix+this.getTargetSelectorSuffix(targetId))},getClass:function(type,withShape){var _this=this,isPlural=/s$/.test(type),useIdKey=/^(area|arc|line|funnel|treemap)s?$/.test(type),key=isPlural?"id":"index";return function(d){var data=d.data||d;return((withShape?_this.generateClass(CLASS[isPlural?"shapes":"shape"],data[key]):"")+_this.generateClass(CLASS[type],data[useIdKey?"id":key])).trim()}},getChartClass:function(type){var _this=this;return function(d){return CLASS["chart".concat(type)]+_this.classTarget((d.data?d.data:d).id)}},generateExtraLineClass:function(){var classes=this.config.line_classes||[],ids=[];return function(d){var _a,id=d.id||(null===(_a=d.data)||void 0===_a?void 0:_a.id)||d;return ids.indexOf(id)<0&&ids.push(id),classes[ids.indexOf(id)%classes.length]}},classRegion:function(d,i){return"".concat(this.generateClass(CLASS.region,i)," ").concat("class"in d?d.class:"")},classTarget:function(id){var additionalClassSuffix=this.config.data_classes[id],additionalClass="";return additionalClassSuffix&&(additionalClass=" ".concat(CLASS.target,"-").concat(additionalClassSuffix)),this.generateClass(CLASS.target,id)+additionalClass},classFocus:function(d){return this.classFocused(d)+this.classDefocused(d)},classFocused:function(d){return" ".concat(this.state.focusedTargetIds.indexOf(d.id)>=0?CLASS.focused:"")},classDefocused:function(d){return" ".concat(this.state.defocusedTargetIds.indexOf(d.id)>=0?CLASS.defocused:"")},getTargetSelectorSuffix:function(targetId){return(targetId||0===targetId?"-".concat(targetId):"").replace(/[\x00-\x20\x7F-\xA0\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-")},selectorTarget:function(id,prefix,postfix){void 0===prefix&&(prefix=""),void 0===postfix&&(postfix="");var target=this.getTargetSelectorSuffix(id);return"".concat(prefix,".").concat(CLASS.target+target," ").concat(postfix,", ").concat(prefix,".").concat(CLASS.circles+target," ").concat(postfix)},selectorTargets:function(idsValue,prefix){var _this=this,ids=idsValue||[];return ids.length?ids.map(function(id){return _this.selectorTarget(id,prefix)}):null},selectorLegend:function(id){return".".concat(CLASS.legendItem+this.getTargetSelectorSuffix(id))},selectorLegends:function(ids){var _this=this;return(null==ids?void 0:ids.length)?ids.map(function(id){return _this.selectorLegend(id)}):null}};var schemeCategory10=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],billboard_color={generateColor:function(){var $$=this,$el=$$.$el,config=$$.config,ids=[],pattern=notEmpty(config.color_pattern)?config.color_pattern:ordinal(function getColorFromCss(element){var cacheKey=KEY_colorPattern,body=doc.body,pattern=body[cacheKey];if(!pattern){var content=element.classed($COLOR.colorPattern,!0).style("background-image");element.classed($COLOR.colorPattern,!1),content.indexOf(";")>-1&&(pattern=content.replace(/url[^#]*|["'()]|(\s|%20)/g,"").split(";").map(function(v){return v.trim().replace(/[\"'\s]/g,"")}).filter(Boolean),body[cacheKey]=pattern)}return pattern}($el.chart)||schemeCategory10).range(),originalColorPattern=pattern;if(isFunction(config.color_tiles)){var tiles_1=config.color_tiles.bind($$.api)(),colorizedPatterns=pattern.map(function(p,index){var color=p.replace(/[#\(\)\s,]/g,""),id="".concat($$.state.datetimeId,"-pattern-").concat(color,"-").concat(index);return function(pattern,color,id){var node=src_select(pattern.cloneNode(!0));return node.attr("id",id).insert("rect",":first-child").attr("width",node.attr("width")).attr("height",node.attr("height")).style("fill",color),{id,node:node.node()}}(tiles_1[index%tiles_1.length],p,id)});pattern=colorizedPatterns.map(function(p){return"url(#".concat(p.id,")")}),$$.patterns=colorizedPatterns}return function(d){var _a,color,colors=config.data_colors,callback=config.data_color,id=d.id||(null===(_a=d.data)||void 0===_a?void 0:_a.id)||d,isLine=$$.isTypeOf(id,["line","spline","step"])||!config.data_types[id];return isFunction(colors[id])?color=colors[id].bind($$.api)(d):colors[id]?color=colors[id]:(ids.indexOf(id)<0&&ids.push(id),color=isLine?originalColorPattern[ids.indexOf(id)%originalColorPattern.length]:pattern[ids.indexOf(id)%pattern.length],colors[id]=color),isFunction(callback)?callback.bind($$.api)(color,d):color}},generateLevelColor:function(){var config=this.config,colors=config.color_pattern,threshold=config.color_threshold,asValue="value"===threshold.unit,max=threshold.max||100,values=threshold.values&&threshold.values.length?threshold.values:[];return notEmpty(threshold)?function(value){for(var v=asValue?value:100*value/max,color=colors[colors.length-1],i=0,l=values.length;i<l;i++)if(v<=values[i]){color=colors[i];break}return color}:null},generateTextBGColorFilter:function(color,attr){void 0===attr&&(attr={x:0,y:0,width:1,height:1});var $$=this,defs=$$.$el.defs,state=$$.state;if(color){var ids=[];isString(color)?ids.push(""):isObject(color)?ids=Object.keys(color):isFunction(color)&&(ids=$$.mapToTargetIds()),ids.forEach(function(v){var id="".concat(state.datetimeId,"-labels-bg").concat($$.getTargetSelectorSuffix(v)).concat(isString(color)?$$.getTargetSelectorSuffix(color):""),colorValue=""===v?color:(null==color?void 0:color[v])||"";defs.select("#".concat(id)).empty()&&defs.append("filter").attr("x",attr.x).attr("y",attr.y).attr("width",attr.width).attr("height",attr.height).attr("id",id).html('<feFlood flood-color="'.concat(colorValue,'" />\n\t\t\t\t\t\t\t<feComposite in="SourceGraphic" />'))})}},getGradienColortUrl:function(id){return"url(#".concat(this.state.datetimeId,"-gradient").concat(this.getTargetSelectorSuffix(id),")")},updateLinearGradient:function(){var $$=this,config=$$.config,targets=$$.data.targets,datetimeId=$$.state.datetimeId,defs=$$.$el.defs;targets.forEach(function(d){var id="".concat(datetimeId,"-gradient").concat($$.getTargetSelectorSuffix(d.id)),radialGradient=$$.hasPointType()&&config.point_radialGradient,supportedType=$$.isAreaType(d)?"area":$$.isBarType(d)&&"bar";if((radialGradient||supportedType)&&defs.select("#".concat(id)).empty()){var color_1=$$.color(d),gradient_1={defs:null,stops:[]};if(radialGradient){var _a=radialGradient.cx,cx=void 0===_a?.3:_a,_b=radialGradient.cy,cy=void 0===_b?.3:_b,_c=radialGradient.r,r=void 0===_c?.7:_c,_d=radialGradient.stops,stops=void 0===_d?[[.1,color_1,0],[.9,color_1,1]]:_d;gradient_1.stops=stops,gradient_1.defs=defs.append("radialGradient").attr("id","".concat(id)).attr("cx",cx).attr("cy",cy).attr("r",r)}else{var isRotated=config.axis_rotated,_e=config["".concat(supportedType,"_linearGradient")],_f=_e.x,x=void 0===_f?isRotated?[1,0]:[0,0]:_f,_g=_e.y,y=void 0===_g?isRotated?[0,0]:[0,1]:_g,_h=_e.stops;stops=void 0===_h?[[0,color_1,1],[1,color_1,0]]:_h;gradient_1.stops=stops,gradient_1.defs=defs.append("linearGradient").attr("id","".concat(id)).attr("x1",x[0]).attr("x2",x[1]).attr("y1",y[0]).attr("y2",y[1])}gradient_1.stops.forEach(function(v){var offset=v[0],stopColor=v[1],stopOpacity=v[2],colorValue=isFunction(stopColor)?stopColor.bind($$.api)(d.id):stopColor;gradient_1.defs&&gradient_1.defs.append("stop").attr("offset",offset).attr("stop-color",colorValue||color_1).attr("stop-opacity",stopOpacity)})}})},setOverColor:function(isOver,d){var $$=this,config=$$.config,main=$$.$el.main,onover=config.color_onover,color=isOver?onover:$$.color;isObject(color)?color=function(_a){var id=_a.id;return id in onover?onover[id]:$$.color(id)}:isString(color)?color=function(){return onover}:isFunction(onover)&&(color=color.bind($$.api)),main.selectAll(isObject(d)?".".concat($ARC.arc).concat($$.getTargetSelectorSuffix(d.id)):".".concat($SHAPE.shape,"-").concat(d)).style("fill",color)}},domain={getYDomainMinMax:function(targets,type){var $$=this,axis=$$.axis,config=$$.config,isMin="min"===type,dataGroups=config.data_groups,ids=$$.mapToIds(targets),ys=$$.getValuesAsIdKeyed(targets);if(dataGroups.length>0){var hasValue_1=$$["has".concat(isMin?"Negative":"Positive","ValueInTargets")](targets);dataGroups.forEach(function(groupIds){var idsInGroup=groupIds.filter(function(v){return ids.indexOf(v)>=0});if(idsInGroup.length){var baseId_1=idsInGroup[0],baseAxisId_1=axis.getId(baseId_1);hasValue_1&&ys[baseId_1]&&(ys[baseId_1]=ys[baseId_1].map(function(v){return(isMin?v<0:v>0)?v:0})),idsInGroup.filter(function(v,i){return i>0}).forEach(function(id){if(ys[id]){var axisId_1=axis.getId(id);ys[id].forEach(function(v,i){var val=+v;axisId_1!==baseAxisId_1||hasValue_1&&(isMin?val>0:val<0)||(ys[baseId_1][i]+=val)})}})}})}return getMinMax$1(type,Object.keys(ys).map(function(key){return getMinMax$1(type,ys[key])}))},isHiddenTargetWithYDomain:function(id){var $$=this;return $$.state.hiddenTargetIds.some(function(v){return $$.axis.getId(v)===id})},getYDomain:function(targets,axisId,xDomain){var $$=this,axis=$$.axis,config=$$.config,scale=$$.scale,pfx="axis_".concat(axisId);if($$.isStackNormalized())return[0,100];var isLog=(null==scale?void 0:scale[axisId])&&"log"===scale[axisId].type,targetsByAxisId=targets.filter(function(t){return axis.getId(t.id)===axisId}),yTargets=xDomain?$$.filterByXDomain(targetsByAxisId,xDomain):targetsByAxisId;if(0===yTargets.length)return $$.isHiddenTargetWithYDomain(axisId)?scale[axisId].domain():"y2"===axisId?scale.y.domain():$$.getYDomain(targets,"y2",xDomain);var yMin=config["".concat(pfx,"_min")],yMax=config["".concat(pfx,"_max")],center=config["".concat(pfx,"_center")],isInverted=config["".concat(pfx,"_inverted")],showHorizontalDataLabel=$$.hasDataLabel()&&config.axis_rotated,showVerticalDataLabel=$$.hasDataLabel()&&!config.axis_rotated,yDomainMin=$$.getYDomainMinMax(yTargets,"min"),yDomainMax=$$.getYDomainMinMax(yTargets,"max"),isZeroBased=__spreadArray([TYPE.BAR,TYPE.BUBBLE,TYPE.SCATTER],TYPE_BY_CATEGORY.Line,!0).some(function(v){var type=v.indexOf("area")>-1?"area":v;return $$.hasType(v,yTargets,!0)&&config["".concat(type,"_zerobased")]});yDomainMin=isValue(yMin)?yMin:isValue(yMax)?yDomainMin<=yMax?yDomainMin:yMax-10:yDomainMin,yDomainMax=isValue(yMax)?yMax:isValue(yMin)?yMin<=yDomainMax?yDomainMax:yMin+10:yDomainMax,isNaN(yDomainMin)&&(yDomainMin=0),isNaN(yDomainMax)&&(yDomainMax=yDomainMin),yDomainMin===yDomainMax&&(yDomainMin<0?yDomainMax=0:yDomainMin=0);var isAllPositive=yDomainMin>=0&&yDomainMax>=0,isAllNegative=yDomainMin<=0&&yDomainMax<=0;(isValue(yMin)&&isAllPositive||isValue(yMax)&&isAllNegative)&&(isZeroBased=!1),isZeroBased&&(isAllPositive&&(yDomainMin=0),isAllNegative&&(yDomainMax=0));var domainLength=Math.abs(yDomainMax-yDomainMin),padding={top:.1*domainLength,bottom:.1*domainLength};if(isDefined(center)){var yDomainAbs=Math.max(Math.abs(yDomainMin),Math.abs(yDomainMax));yDomainMax=center+yDomainAbs,yDomainMin=center-yDomainAbs}if(showHorizontalDataLabel){var diff_1=diffDomain(scale.y.range()),ratio_1=$$.getDataLabelLength(yDomainMin,yDomainMax,"width").map(function(v){var result=v/diff_1;return isFinite(result)?result:0});["bottom","top"].forEach(function(v,i){padding[v]+=domainLength*(ratio_1[i]/(1-ratio_1[0]-ratio_1[1]))})}else if(showVerticalDataLabel){var lengths_1=$$.getDataLabelLength(yDomainMin,yDomainMax,"height");["bottom","top"].forEach(function(v,i){padding[v]+=$$.convertPixelToScale("y",lengths_1[i],domainLength)})}padding=$$.getResettedPadding(padding);var p=config["".concat(pfx,"_padding")];notEmpty(p)&&["bottom","top"].forEach(function(v){padding[v]=axis.getPadding(p,v,padding[v],domainLength)}),isZeroBased&&(isAllPositive&&(padding.bottom=yDomainMin),isAllNegative&&(padding.top=-yDomainMax));var domain=isLog?[yDomainMin,yDomainMax].map(function(v){return v<0?0:v}):[yDomainMin-padding.bottom,yDomainMax+padding.top];return isInverted?domain.reverse():domain},getXDomainMinMax:function(targets,type){var _a,configValue=this.config["axis_x_".concat(type)],dataValue=getMinMax$1(type,targets.map(function(t){return getMinMax$1(type,t.values.map(function(v){return v.x}))})),value=isObject(configValue)?configValue.value:configValue;return value=isDefined(value)&&(null===(_a=this.axis)||void 0===_a?void 0:_a.isTimeSeries())?parseDate.bind(this)(value):value,isObject(configValue)&&configValue.fit&&("min"===type&&value<dataValue||"max"===type&&value>dataValue)&&(value=void 0),isDefined(value)?value:dataValue},getXDomainPadding:function(domain,tickCount){var defaultValue,$$=this,axis=$$.axis,padding=$$.config.axis_x_padding,isTimeSeriesTickCount=axis.isTimeSeries()&&tickCount,diff=diffDomain(domain);if(axis.isCategorized()||isTimeSeriesTickCount)defaultValue=0;else if($$.hasType("bar")){var maxDataCount=$$.getMaxDataCount();defaultValue=maxDataCount>1?diff/(maxDataCount-1)/2:.5}else defaultValue=$$.getResettedPadding(.01*diff);var _a=isNumber(padding)?{left:padding,right:padding}:padding,_b=_a.left,left=void 0===_b?defaultValue:_b,_c=_a.right,right=void 0===_c?defaultValue:_c;if("px"===padding.unit){var domainLength=Math.abs(diff+.2*diff);left=axis.getPadding(padding,"left",defaultValue,domainLength),right=axis.getPadding(padding,"right",defaultValue,domainLength)}else{var range=diff+left+right;if(isTimeSeriesTickCount&&range){var relativeTickWidth=diff/tickCount/range;left=left/range/relativeTickWidth,right=right/range/relativeTickWidth}}return{left,right}},getXDomain:function(targets){var $$=this,axis=$$.axis,config=$$.config,x=$$.scale.x,isInverted=config.axis_x_inverted,domain=[$$.getXDomainMinMax(targets,"min"),$$.getXDomainMinMax(targets,"max")],_a=domain[0],min=void 0===_a?0:_a,_b=domain[1],max=void 0===_b?0:_b;if("log"!==x.type){var isCategorized=axis.isCategorized(),isTimeSeries=axis.isTimeSeries(),padding=$$.getXDomainPadding(domain),firstX=domain[0],lastX=domain[1];firstX-lastX!==0||isCategorized||(isTimeSeries?(firstX=new Date(.5*firstX.getTime()),lastX=new Date(1.5*lastX.getTime())):(firstX=0===firstX?1:.5*firstX,lastX=0===lastX?-1:1.5*lastX)),(firstX||0===firstX)&&(min=isTimeSeries?new Date(firstX.getTime()-padding.left):firstX-padding.left),(lastX||0===lastX)&&(max=isTimeSeries?new Date(lastX.getTime()+padding.right):lastX+padding.right)}return isInverted?[max,min]:[min,max]},updateXDomain:function(targets,withUpdateXDomain,withUpdateOrgXDomain,withTrim,domain){var _a,$$=this,config=$$.config,org=$$.org,_b=$$.scale,x=_b.x,subX=_b.subX,zoomEnabled=config.zoom_enabled;if(withUpdateOrgXDomain&&(x.domain(domain||sortValue($$.getXDomain(targets),!config.axis_x_inverted)),org.xDomain=x.domain(),subX.domain(x.domain()),null===(_a=$$.brush)||void 0===_a||_a.scale(subX)),withUpdateXDomain){var domainValue=domain||!$$.brush||brushEmpty($$)?org.xDomain:getBrushSelection($$).map(subX.invert);x.domain(domainValue)}return(withUpdateOrgXDomain||withUpdateXDomain)&&zoomEnabled&&$$.zoom.updateScaleExtent(),withTrim&&x.domain($$.trimXDomain(x.orgDomain())),x.domain()},trimXDomain:function(domain){var isInverted=this.config.axis_x_inverted,zoomDomain=this.getZoomDomain(),min=zoomDomain[0],max=zoomDomain[1];return(isInverted?domain[0]>=min:domain[0]<=min)&&(domain[1]=+domain[1]+(min-domain[0]),domain[0]=min),(isInverted?domain[1]<=max:domain[1]>=max)&&(domain[0]=+domain[0]-(domain[1]-max),domain[1]=max),domain},getZoomDomain:function(type,getCurrent){void 0===type&&(type="zoom"),void 0===getCurrent&&(getCurrent=!1);var config=this.config,scale=this.scale,org=this.org,_a=getCurrent&&scale[type]?scale[type].domain():org.xDomain,min=_a[0],max=_a[1];return"zoom"===type&&(isDefined(config.zoom_x_min)&&(min=getMinMax$1("min",[min,config.zoom_x_min])),isDefined(config.zoom_x_max)&&(max=getMinMax$1("max",[max,config.zoom_x_max]))),[min,max]},getZoomDomainValue:function(domainValue){var config=this.config;if(this.axis.isCategorized()&&Array.isArray(domainValue)){var isInverted_1=config.axis_x_inverted;return domainValue.map(function(v,i){return Number(v)+(0===i?+isInverted_1:+!isInverted_1)})}return domainValue},convertPixelToScale:function(type,pixels,domainLength){var config=this.config,state=this.state,isRotated=config.axis_rotated;return domainLength*(pixels/state["x"===type?isRotated?"height":"width":isRotated?"width":"height"])},withinRange:function(domain,current,range){void 0===current&&(current=[0,0]);var isInverted=this.config.axis_x_inverted,_a=range,min=_a[0],max=_a[1];if(Array.isArray(domain)){var target=__spreadArray([],domain,!0);if(isInverted&&target.reverse(),target[0]<target[1])return domain.every(function(v,i){return(0===i?isInverted?+v<=min:+v>=min:isInverted?+v>=max:+v<=max)&&!domain.every(function(v,i){return v===current[i]})})}return!1}};function getFormat($$,typeValue,v){var config=$$.config,type="axis_".concat(typeValue,"_tick_format");return(config[type]?config[type]:$$.defaultValueFormat).call($$.api,v)}var billboard_format={yFormat:function(v){return getFormat(this,"y",v)},y2Format:function(v){return getFormat(this,"y2",v)},getDefaultValueFormat:function(){var $$=this,defaultArcValueFormat=$$.defaultArcValueFormat,yFormat=$$.yFormat,y2Format=$$.y2Format,hasArc=$$.hasArcType(null,["gauge","polar","radar"]);return function(v,ratio,id){return(hasArc?defaultArcValueFormat:$$.axis&&"y2"===$$.axis.getId(id)?y2Format:yFormat).call($$,v,ratio)}},defaultValueFormat:function(v){return isArray(v)?v.join("~"):isValue(v)?+v:""},defaultArcValueFormat:function(v,ratio){return"".concat((100*ratio).toFixed(1),"%")},defaultPolarValueFormat:function(v){return"".concat(v)},dataLabelFormat:function(targetId){var dataLabels=this.config.data_labels,defaultFormat=function(v){var res=v;return isArray(v)?res=v.join("~"):isObject(v)&&(res=Object.values(v).join("~")),res},format=defaultFormat;return isFunction(dataLabels.format)?format=dataLabels.format:isObjectType(dataLabels.format)&&(format=dataLabels.format[targetId]?!0===dataLabels.format[targetId]?defaultFormat:dataLabels.format[targetId]:function(){return""}),format.bind(this.api)}};function getLegendColor(id){var data=this.getDataById(id);return this.levelColor?this.levelColor(data.values[0].value):this.color(data)}function getFormattedText(id,formatted){var _a;void 0===formatted&&(formatted=!0);var config=this.config,text=null!==(_a=config.data_names[id])&&void 0!==_a?_a:id;return formatted&&isFunction(config.legend_format)&&(text=config.legend_format(text,id!==text?id:void 0)),text}var legend$1={initLegend:function(){var $$=this,config=$$.config,$el=$$.$el;$$.legendItemTextBox={},$$.state.legendHasRendered=!1,config.legend_show?(config.legend_contents_bindto||($el.legend=$$.$el.svg.append("g").classed($LEGEND.legend,!0).attr("transform",$$.getTranslate("legend"))),$$.updateLegend()):$$.state.hiddenLegendIds=$$.mapToIds($$.data.targets)},updateLegend:function(targetIds,options,transitions){var _a,$$=this,config=$$.config,state=$$.state,scale=$$.scale,$el=$$.$el,optionz=options||{withTransform:!1,withTransitionForTransform:!1,withTransition:!1};optionz.withTransition=getOption(optionz,"withTransition",!0),optionz.withTransitionForTransform=getOption(optionz,"withTransitionForTransform",!0),config.legend_contents_bindto&&config.legend_contents_template?$$.updateLegendTemplate():state.hasTreemap||$$.updateLegendElement(targetIds||$$.mapToIds($$.data.targets),optionz,transitions),null===(_a=$el.legend)||void 0===_a||_a.selectAll(".".concat($LEGEND.legendItem)).classed($LEGEND.legendItemHidden,function(id){var hide=!$$.isTargetToShow(id);return hide&&(this.style.opacity=null),hide}),$$.updateScales(!1,!scale.zoom),$$.updateSvgSize(),$$.transformAll(optionz.withTransitionForTransform,transitions),state.legendHasRendered=!0},updateLegendTemplate:function(){var $$=this,config=$$.config,$el=$$.$el,wrapper=src_select(config.legend_contents_bindto),template=config.legend_contents_template;if(!wrapper.empty()){var targets=$$.mapToIds($$.data.targets),ids_1=[],html_1="";targets.forEach(function(v){var content=isFunction(template)?template.bind($$.api)(v,$$.color(v),$$.api.data(v)[0].values):tplProcess(template,{COLOR:$$.color(v),TITLE:v});content&&(ids_1.push(v),html_1+=content)});var legendItem=wrapper.html(html_1).selectAll(function(){return this.childNodes}).data(ids_1);$$.setLegendItem(legendItem),$el.legend=wrapper}},updateSizeForLegend:function(size){var $$=this,config=$$.config,_a=$$.state,isLegendTop=_a.isLegendTop,isLegendLeft=_a.isLegendLeft,isLegendRight=_a.isLegendRight,isLegendInset=_a.isLegendInset,current=_a.current,width=size.width,height=size.height,insetLegendPosition={top:isLegendTop?$$.getCurrentPaddingByDirection("top")+config.legend_inset_y+5.5:current.height-height-$$.getCurrentPaddingByDirection("bottom")-config.legend_inset_y,left:isLegendLeft?$$.getCurrentPaddingByDirection("left")+config.legend_inset_x+.5:current.width-width-$$.getCurrentPaddingByDirection("right")-config.legend_inset_x+.5};$$.state.margin3={top:isLegendRight?0:isLegendInset?insetLegendPosition.top:current.height-height,right:NaN,bottom:0,left:isLegendRight?current.width-width:isLegendInset?insetLegendPosition.left:0}},transformLegend:function(withTransition){var legend=this.$el.legend;(0,this.$T)(legend,withTransition).attr("transform",this.getTranslate("legend"))},updateLegendStep:function(step){this.state.legendStep=step},updateLegendItemWidth:function(width){this.state.legendItemWidth=width},updateLegendItemHeight:function(height){this.state.legendItemHeight=height},updateLegendItemColor:function(id,color){var legend=this.$el.legend;legend&&legend.select(".".concat($LEGEND.legendItem,"-").concat(id," line")).style("stroke",color)},getLegendWidth:function(){var _a=this.state,width=_a.current.width,isLegendRight=_a.isLegendRight,isLegendInset=_a.isLegendInset,legendItemWidth=_a.legendItemWidth,legendStep=_a.legendStep;return this.config.legend_show?isLegendRight||isLegendInset?legendItemWidth*(legendStep+1):width:0},getLegendHeight:function(){var _a,_b=this.state,current=_b.current,isLegendRight=_b.isLegendRight,legendItemHeight=_b.legendItemHeight,legendStep=_b.legendStep,isFitPadding="fit"===(null===(_a=this.config.padding)||void 0===_a?void 0:_a.mode);return this.config.legend_show?isLegendRight?current.height:Math.max(isFitPadding?10:20,legendItemHeight)*(legendStep+1):0},opacityForUnfocusedLegend:function(legendItem){return legendItem.classed($LEGEND.legendItemHidden)?null:"0.3"},toggleFocusLegend:function(targetIds,focus){var $$=this,legend=$$.$el.legend,$T=$$.$T,targetIdz=$$.mapToTargetIds(targetIds);legend&&$T(legend.selectAll(".".concat($LEGEND.legendItem)).filter(function(id){return targetIdz.indexOf(id)>=0}).classed($FOCUS.legendItemFocused,focus)).style("opacity",function(){return focus?null:$$.opacityForUnfocusedLegend.call($$,src_select(this))})},revertLegend:function(){var legend=this.$el.legend,$T=this.$T;legend&&$T(legend.selectAll(".".concat($LEGEND.legendItem)).classed($FOCUS.legendItemFocused,!1)).style("opacity",null)},showLegend:function(targetIds){var $$=this,config=$$.config,$el=$$.$el,$T=$$.$T;config.legend_show||(config.legend_show=!0,$el.legend?$el.legend.style("visibility",null):$$.initLegend(),!$$.state.legendHasRendered&&$$.updateLegend()),$$.removeHiddenLegendIds(targetIds),$T($el.legend.selectAll($$.selectorLegends(targetIds)).style("visibility",null)).style("opacity",null)},hideLegend:function(targetIds){var config=this.config,legend=this.$el.legend;config.legend_show&&isEmpty(targetIds)&&(config.legend_show=!1,legend.style("visibility","hidden")),this.addHiddenLegendIds(targetIds),legend.selectAll(this.selectorLegends(targetIds)).style("opacity","0").style("visibility","hidden")},getLegendItemTextBox:function(id,textElement){var data,cache=this.cache,state=this.state,cacheKey=KEY_legendItemTextBox;return id&&((data=!state.redrawing&&cache.get(cacheKey)||{})[id]||(data[id]=this.getTextRect(textElement,$LEGEND.legendItem),cache.add(cacheKey,data)),data=data[id]),data},setLegendItem:function(item){var $$=this,$el=$$.$el,api=$$.api,config=$$.config,state=$$.state,isTouch="touch"===state.inputType,hasGauge=$$.hasType("gauge"),useCssRule=config.boost_useCssRule,interaction=config.legend_item_interaction;item.attr("class",function(id){var node=src_select(this);return(!node.empty()&&node.attr("class")||"")+$$.generateClass($LEGEND.legendItem,id)}).style("visibility",function(id){return $$.isLegendToShow(id)?null:"hidden"}),config.interaction_enabled&&(useCssRule&&[[".".concat($LEGEND.legendItem),"cursor:pointer"],[".".concat($LEGEND.legendItem," text"),"pointer-events:none"],[".".concat($LEGEND.legendItemPoint," text"),"pointer-events:none"],[".".concat($LEGEND.legendItemTile),"pointer-events:none"],[".".concat($LEGEND.legendItemEvent),"fill-opacity:0"]].forEach(function(v){var selector=v[0],props=v[1];$$.setCssRule(!1,selector,[props])($el.legend)}),item.on(interaction.dblclick?"dblclick":"click",interaction||isFunction(config.legend_item_onclick)?function(event,id){if(!callFn(config.legend_item_onclick,api,id,!state.hiddenTargetIds.includes(id))){var altKey=event.altKey,target=event.target;"dblclick"===event.type||altKey?state.hiddenTargetIds.length&&-1===target.parentNode.getAttribute("class").indexOf($LEGEND.legendItemHidden)?api.show():(api.hide(),api.show(id)):(api.toggle(id),src_select(this).classed($FOCUS.legendItemFocused,!1))}isTouch&&$$.hideTooltip()}:null),!isTouch&&item.on("mouseout",interaction||isFunction(config.legend_item_onout)?function(event,id){callFn(config.legend_item_onout,api,id,!state.hiddenTargetIds.includes(id))||(src_select(this).classed($FOCUS.legendItemFocused,!1),hasGauge&&$$.undoMarkOverlapped($$,".".concat($GAUGE.gaugeValue)),$$.api.revert())}:null).on("mouseover",interaction||isFunction(config.legend_item_onover)?function(event,id){callFn(config.legend_item_onover,api,id,!state.hiddenTargetIds.includes(id))||(src_select(this).classed($FOCUS.legendItemFocused,!0),hasGauge&&$$.markOverlapped(id,$$,".".concat($GAUGE.gaugeValue)),!state.transiting&&$$.isTargetToShow(id)&&api.focus(id))}:null),!item.empty()&&item.on("click mouseout mouseover")&&item.style("cursor",$$.getStylePropValue("pointer")))},updateLegendElement:function(targetIds,options){var xForLegend,yForLegend,background,$$=this,config=$$.config,state=$$.state,legend=$$.$el.legend,$T=$$.$T,isRectangle="circle"!==config.legend_item_tile_type,legendItemR=config.legend_item_tile_r,itemTileSize={width:isRectangle?config.legend_item_tile_width:2*legendItemR,height:isRectangle?config.legend_item_tile_height:2*legendItemR},dimension={padding:{top:4,right:10},max:{width:0,height:0},posMin:10,step:0,tileWidth:itemTileSize.width+5,totalLength:0},sizes={offsets:{},widths:{},heights:{},margins:[0],steps:{}},targetIdz=targetIds.filter(function(id){return!isDefined(config.data_names[id])||null!==config.data_names[id]}),withTransition=options.withTransition,updatePositions=$$.getUpdateLegendPositions(targetIdz,dimension,sizes);state.isLegendInset&&(dimension.step=config.legend_inset_step?config.legend_inset_step:targetIdz.length,$$.updateLegendStep(dimension.step)),state.isLegendRight?(xForLegend=function(id){return dimension.max.width*sizes.steps[id]},yForLegend=function(id){return sizes.margins[sizes.steps[id]]+sizes.offsets[id]}):state.isLegendInset?(xForLegend=function(id){return dimension.max.width*sizes.steps[id]+10},yForLegend=function(id){return sizes.margins[sizes.steps[id]]+sizes.offsets[id]}):(xForLegend=function(id){return sizes.margins[sizes.steps[id]]+sizes.offsets[id]},yForLegend=function(id){return dimension.max.height*sizes.steps[id]});var posFn={xText:function(id,i){return xForLegend(id,i)+4+itemTileSize.width},xRect:function(id,i){return xForLegend(id,i)},x1Tile:function(id,i){return xForLegend(id,i)-2},x2Tile:function(id,i){return xForLegend(id,i)-2+itemTileSize.width},yText:function(id,i){return yForLegend(id,i)+9},yRect:function(id,i){return yForLegend(id,i)-5},yTile:function(id,i){return yForLegend(id,i)+4}};$$.generateLegendItem(targetIdz,itemTileSize,updatePositions,posFn),background=legend.select(".".concat($LEGEND.legendBackground," rect")),state.isLegendInset&&dimension.max.width>0&&0===background.size()&&(background=legend.insert("g",".".concat($LEGEND.legendItem)).attr("class",$LEGEND.legendBackground).append("rect")),config.legend_tooltip&&legend.selectAll("title").data(targetIdz).text(function(id){return getFormattedText.bind($$)(id,!1)});var texts=legend.selectAll("text").data(targetIdz).text(function(id){return getFormattedText.bind($$)(id)}).each(function(id,i){updatePositions(this,id,i)});$T(texts,withTransition).attr("x",posFn.xText).attr("y",posFn.yText),$T(legend.selectAll("rect.".concat($LEGEND.legendItemEvent)).data(targetIdz),withTransition).attr("width",function(id){return sizes.widths[id]}).attr("height",function(id){return sizes.heights[id]}).attr("x",posFn.xRect).attr("y",posFn.yRect),$$.updateLegendItemPos(targetIdz,withTransition,posFn),background&&$T(background,withTransition).attr("height",$$.getLegendHeight()-12).attr("width",dimension.max.width*(dimension.step+1)+10),$$.updateLegendItemWidth(dimension.max.width),$$.updateLegendItemHeight(dimension.max.height),$$.updateLegendStep(dimension.step)},getUpdateLegendPositions:function(targetIdz,dimension,sizes){var $$=this,config=$$.config,state=$$.state,isLegendRightOrInset=state.isLegendRight||state.isLegendInset;return function(textElement,id,index){var margin,reset=0===index,isLast=index===targetIdz.length-1,box=$$.getLegendItemTextBox(id,textElement),itemWidth=box.width+dimension.tileWidth+(isLast&&!isLegendRightOrInset?0:dimension.padding.right)+config.legend_padding,itemHeight=box.height+dimension.padding.top,itemLength=isLegendRightOrInset?itemHeight:itemWidth,areaLength=isLegendRightOrInset?$$.getLegendHeight():$$.getLegendWidth(),updateValues=function(id2,withoutStep){withoutStep||(margin=(areaLength-dimension.totalLength-itemLength)/2)<dimension.posMin&&(margin=(areaLength-itemLength)/2,dimension.totalLength=0,dimension.step++),sizes.steps[id2]=dimension.step,sizes.margins[dimension.step]=state.isLegendInset?10:margin,sizes.offsets[id2]=dimension.totalLength,dimension.totalLength+=itemLength};if(reset&&(dimension.totalLength=0,dimension.step=0,dimension.max.width=0,dimension.max.height=0),config.legend_show&&!$$.isLegendToShow(id))return sizes.widths[id]=0,sizes.heights[id]=0,sizes.steps[id]=0,void(sizes.offsets[id]=0);sizes.widths[id]=itemWidth,sizes.heights[id]=itemHeight,(!dimension.max.width||itemWidth>=dimension.max.width)&&(dimension.max.width=itemWidth),(!dimension.max.height||itemHeight>=dimension.max.height)&&(dimension.max.height=itemHeight);var maxLength=isLegendRightOrInset?dimension.max.height:dimension.max.width;config.legend_equally?(Object.keys(sizes.widths).forEach(function(id2){return sizes.widths[id2]=dimension.max.width}),Object.keys(sizes.heights).forEach(function(id2){return sizes.heights[id2]=dimension.max.height}),(margin=(areaLength-maxLength*targetIdz.length)/2)<dimension.posMin?(dimension.totalLength=0,dimension.step=0,targetIdz.forEach(function(id2){return updateValues(id2)})):updateValues(id,!0)):updateValues(id)}},generateLegendItem:function(targetIdz,itemTileSize,updatePositions,posFn){var $$=this,config=$$.config,state=$$.state,legend=$$.$el.legend,usePoint=config.legend_usePoint,legendItemR=config.legend_item_tile_r,legendType=config.legend_item_tile_type,isRectangle="circle"!==legendType,isLegendRightOrInset=state.isLegendRight||state.isLegendInset,pos=-200,l=legend.selectAll(".".concat($LEGEND.legendItem)).data(targetIdz).enter().append("g");if($$.setLegendItem(l),config.legend_tooltip&&l.append("title").text(function(id){return id}),l.append("text").text(function(id){return getFormattedText.bind($$)(id)}).each(function(id,i){updatePositions(this,id,i)}).style("pointer-events",$$.getStylePropValue("none")).attr("x",isLegendRightOrInset?posFn.xText:pos).attr("y",isLegendRightOrInset?pos:posFn.yText),l.append("rect").attr("class",$LEGEND.legendItemEvent).style("fill-opacity",$$.getStylePropValue("0")).attr("x",isLegendRightOrInset?posFn.xRect:pos).attr("y",isLegendRightOrInset?pos:posFn.yRect),usePoint){var ids_2=[];l.append(function(d){var pattern=notEmpty(config.point_pattern)?config.point_pattern:[config.point_type];-1===ids_2.indexOf(d)&&ids_2.push(d);var point=pattern[ids_2.indexOf(d)%pattern.length];return"rectangle"===point&&(point="rect"),doc.createElementNS(namespaces.svg,"hasValidPointType"in $$&&$$.hasValidPointType(point)?point:"use")}).attr("class",$LEGEND.legendItemPoint).style("fill",getLegendColor.bind($$)).style("pointer-events",$$.getStylePropValue("none")).attr("href",function(data,idx,selection){var nodeName=selection[idx].nodeName.toLowerCase(),id=$$.getTargetSelectorSuffix(data);return"use"===nodeName?"#".concat(state.datetimeId,"-point").concat(id):void 0})}else l.append(isRectangle?"line":legendType).attr("class",$LEGEND.legendItemTile).style("stroke",getLegendColor.bind($$)).style("pointer-events",$$.getStylePropValue("none")).call(function(selection){"circle"===legendType?selection.attr("r",legendItemR).style("fill",getLegendColor.bind($$)).attr("cx",isLegendRightOrInset?posFn.x2Tile:pos).attr("cy",isLegendRightOrInset?pos:posFn.yTile):isRectangle&&selection.attr("stroke-width",itemTileSize.height).attr("x1",isLegendRightOrInset?posFn.x1Tile:pos).attr("y1",isLegendRightOrInset?pos:posFn.yTile).attr("x2",isLegendRightOrInset?posFn.x2Tile:pos).attr("y2",isLegendRightOrInset?pos:posFn.yTile)})},updateLegendItemPos:function(targetIdz,withTransition,posFn){var config=this.config,legend=this.$el.legend,$T=this.$T,usePoint=config.legend_usePoint,legendType=config.legend_item_tile_type,isRectangle="circle"!==legendType;usePoint?$T(legend.selectAll(".".concat($LEGEND.legendItemPoint)).data(targetIdz),withTransition).each(function(){var nodeName=this.nodeName.toLowerCase(),pointR=config.point_r,x="x",y="y",xOffset=2,yOffset=2.5,radius=null,width=null,height=null;if("circle"===nodeName)x="cx",y="cy",radius=pointR+(size=.2*pointR),xOffset=2*pointR,yOffset=-size;else if("rect"===nodeName){var size;width=size=2.5*pointR,height=size,yOffset=3}src_select(this).attr(x,function(d){return posFn.x1Tile(d)+xOffset}).attr(y,function(d){return posFn.yTile(d)-yOffset}).attr("r",radius).attr("width",width).attr("height",height)}):$T(legend.selectAll(".".concat($LEGEND.legendItemTile)).data(targetIdz),withTransition).style("stroke",getLegendColor.bind(this)).call(function(selection){"circle"===legendType?selection.attr("cx",function(d){var x2=posFn.x2Tile(d);return x2-(x2-posFn.x1Tile(d))/2}).attr("cy",posFn.yTile):isRectangle&&selection.attr("x1",posFn.x1Tile).attr("y1",posFn.yTile).attr("x2",posFn.x2Tile).attr("y2",posFn.yTile)})}},redraw={redraw:function(options){var _a,_b,_c,_d;void 0===options&&(options={});var $$=this,config=$$.config,state=$$.state,$el=$$.$el,main=$el.main,treemap=$el.treemap;state.redrawing=!0;var targetsToShow=$$.filterTargetsToShow($$.data.targets),flow=options.flow,initializing=options.initializing,wth=$$.getWithOption(options),duration=wth.Transition?config.transition_duration:0,durationForExit=wth.TransitionForExit?duration:0,durationForAxis=wth.TransitionForAxis?duration:0,transitions=null===(_a=$$.axis)||void 0===_a?void 0:_a.generateTransitions(durationForAxis);$$.updateSizes(initializing),wth.Legend&&config.legend_show?(options.withTransition=!!duration,!treemap&&$$.updateLegend($$.mapToIds($$.data.targets),options,transitions)):wth.Dimension&&$$.updateDimension(!0),config.data_empty_label_text&&main.select("text.".concat($TEXT.text,".").concat($COMMON.empty)).attr("x",state.width/2).attr("y",state.height/2).text(config.data_empty_label_text).style("display",targetsToShow.length?"none":null),state.hasAxis?($$.axis.redrawAxis(targetsToShow,wth,transitions,flow,initializing),$$.hasGrid()&&$$.updateGrid(),config.regions.length&&$$.updateRegion(),["bar","candlestick","line","area"].forEach(function(v){var name=capitalize(v);(/^(line|area)$/.test(v)&&$$.hasTypeOf(name)||$$.hasType(v))&&$$["update".concat(name)](wth.TransitionForExit)}),$el.text&&main.selectAll(".".concat($SELECT.selectedCircles)).filter($$.isBarType.bind($$)).selectAll("circle").remove(),config.interaction_enabled&&!flow&&wth.EventRect&&($$.redrawEventRect(),null===(_b=$$.bindZoomEvent)||void 0===_b||_b.call($$))):($el.arcs&&$$.redrawArc(duration,durationForExit,wth.Transform),$el.radar&&$$.redrawRadar(),$el.polar&&$$.redrawPolar(),$el.funnel&&$$.redrawFunnel(),treemap&&$$.updateTreemap(durationForExit)),state.resizing||treemap||!$$.hasPointType()&&!state.hasRadar?(null===(_c=$$.hasLegendDefsPoint)||void 0===_c?void 0:_c.call($$))&&$$.data.targets.forEach($$.point("create",this)):$$.updateCircle(),$$.hasDataLabel()&&!$$.hasArcType(null,["radar"])&&$$.updateText(),null===(_d=$$.redrawTitle)||void 0===_d||_d.call($$),initializing&&$$.updateTypesElements(),$$.generateRedrawList(targetsToShow,flow,duration,wth.Subchart),$$.updateTooltipOnRedraw(),$$.callPluginHook("$redraw",options,duration)},generateRedrawList:function(targets,flow,duration,withSubchart){var $$=this,config=$$.config,state=$$.state,shape=$$.getDrawShape();state.hasAxis&&config.subchart_show&&$$.redrawSubchart(withSubchart,duration,shape);var flowFn=flow&&$$.generateFlow({targets,flow,duration:flow.duration,shape,xv:$$.xv.bind($$)}),withTransition=(duration||flowFn)&&isTabVisible(),redrawList=$$.getRedrawList(shape,flow,flowFn,withTransition),afterRedraw=function(){flowFn&&flowFn(),state.redrawing=!1,callFn(config.onrendered,$$.api)};if(afterRedraw)if(withTransition&&redrawList.length){var waitForDraw_1=generateWait();transition_transition().duration(duration).each(function(){redrawList.reduce(function(acc,t1){return acc.concat(t1)},[]).forEach(function(t){return waitForDraw_1.add(t)})}).call(waitForDraw_1,afterRedraw)}else state.transiting||afterRedraw();$$.mapToIds($$.data.targets).forEach(function(id){state.withoutFadeIn[id]=!0})},getRedrawList:function(shape,flow,flowFn,withTransition){var $$=this,config=$$.config,_a=$$.state,hasAxis=_a.hasAxis,hasRadar=_a.hasRadar,hasTreemap=_a.hasTreemap,grid=$$.$el.grid,_b=shape.pos,cx=_b.cx,cy=_b.cy,xForText=_b.xForText,yForText=_b.yForText,list=[];return hasAxis&&((config.grid_x_lines.length||config.grid_y_lines.length)&&list.push($$.redrawGrid(withTransition)),config.regions.length&&list.push($$.redrawRegion(withTransition)),Object.keys(shape.type).forEach(function(v){var name=capitalize(v),drawFn=shape.type[v];(/^(area|line)$/.test(v)&&$$.hasTypeOf(name)||$$.hasType(v))&&list.push($$["redraw".concat(name)](drawFn,withTransition))}),!flow&&grid.main&&list.push($$.updateGridFocus())),$$.hasArcType()&&!hasRadar||notEmpty(config.data_labels)&&!1!==config.data_labels&&list.push($$.redrawText(xForText,yForText,flow,withTransition)),!$$.hasPointType()&&!hasRadar||$$.isPointFocusOnly()||$$.redrawCircle&&list.push($$.redrawCircle(cx,cy,withTransition,flowFn)),hasTreemap&&list.push($$.redrawTreemap(withTransition)),list},updateAndRedraw:function(options){void 0===options&&(options={});var transitions,$$=this,config=$$.config,state=$$.state;options.withTransition=getOption(options,"withTransition",!0),options.withTransform=getOption(options,"withTransform",!1),options.withLegend=getOption(options,"withLegend",!1),options.withUpdateXDomain=!0,options.withUpdateOrgXDomain=!0,options.withTransitionForExit=!1,options.withTransitionForTransform=getOption(options,"withTransitionForTransform",options.withTransition),options.withLegend&&config.legend_show||(state.hasAxis&&(transitions=$$.axis.generateTransitions(options.withTransitionForAxis?config.transition_duration:0)),$$.updateScales(),$$.updateSvgSize(),$$.transformAll(options.withTransitionForTransform,transitions)),$$.redraw(options,transitions)}};function getScale(type,min,max){void 0===type&&(type="linear");var scale={linear:linear_linear,log:symlog,_log:log,time,utc:utcTime}[type]();return scale.type=type,/_?log/.test(type)&&scale.clamp(!0),scale.range([null!=min?min:0,null!=max?max:1])}var scale={getXScale:function(min,max,domain,offset){var scale="append"!==this.state.loading&&this.scale.zoom||getScale(this.axis.getAxisType("x"),min,max);return this.getCustomizedXScale(domain?scale.domain(domain):scale,offset)},getYScale:function(id,min,max,domain){var scale=getScale(this.axis.getAxisType(id),min,max);return domain&&scale.domain(domain),scale},getYScaleById:function(id,isSub){var _a;void 0===isSub&&(isSub=!1);var isY2="y2"===(null===(_a=this.axis)||void 0===_a?void 0:_a.getId(id)),key=isSub?isY2?"subY2":"subY":isY2?"y2":"y";return this.scale[key]},getCustomizedXScale:function(scaleValue,offsetValue){var $$=this,offset=offsetValue||function(){return $$.axis.x.tickOffset()},isInverted=$$.config.axis_x_inverted,scale=function(d){return scaleValue(d)+offset()};for(var key in scaleValue)scale[key]=scaleValue[key];return scale.orgDomain=function(){return scaleValue.domain()},scale.orgScale=function(){return scaleValue},$$.axis.isCategorized()&&(scale.domain=function(domainValue){var domain=domainValue;return arguments.length?(scaleValue.domain(domain),scale):(domain=this.orgDomain(),isInverted?[domain[0]+1,domain[1]]:[domain[0],domain[1]+1])}),scale},updateScales:function(isInit,updateXDomain){var _a,_b;void 0===updateXDomain&&(updateXDomain=!0);var $$=this,axis=$$.axis,config=$$.config,format=$$.format,org=$$.org,scale=$$.scale,_c=$$.state,current=_c.current,width=_c.width,height=_c.height,width2=_c.width2,height2=_c.height2,hasAxis=_c.hasAxis,hasTreemap=_c.hasTreemap;if(hasAxis){var isRotated=config.axis_rotated,resettedPadding=$$.getResettedPadding(1),min={x:isRotated?resettedPadding:0,y:isRotated?0:height,subX:isRotated?1:0,subY:isRotated?0:height2},max={x:isRotated?height:width,y:isRotated?width:resettedPadding,subX:isRotated?height:width,subY:isRotated?width2:1},xDomain=updateXDomain&&(null===(_a=scale.x)||void 0===_a?void 0:_a.orgDomain()),xSubDomain=updateXDomain&&org.xDomain;scale.x=$$.getXScale(min.x,max.x,xDomain,function(){return axis.x.tickOffset()}),scale.subX=$$.getXScale(min.x,max.x,xSubDomain,function(d){var _a;return d%1?0:(null!==(_a=axis.subX)&&void 0!==_a?_a:axis.x).tickOffset()}),format.xAxisTick=axis.getXAxisTickFormat(),format.subXAxisTick=axis.getXAxisTickFormat(!0),axis.setAxis("x",scale.x,config.axis_x_tick_outer,isInit),config.subchart_show&&axis.setAxis("subX",scale.subX,config.axis_x_tick_outer,isInit),scale.y=$$.getYScale("y",min.y,max.y,scale.y?scale.y.domain():config.axis_y_default),scale.subY=$$.getYScale("y",min.subY,max.subY,scale.subY?scale.subY.domain():config.axis_y_default),axis.setAxis("y",scale.y,config.axis_y_tick_outer,isInit),config.axis_y2_show&&(scale.y2=$$.getYScale("y2",min.y,max.y,scale.y2?scale.y2.domain():config.axis_y2_default),scale.subY2=$$.getYScale("y2",min.subY,max.subY,scale.subY2?scale.subY2.domain():config.axis_y2_default),axis.setAxis("y2",scale.y2,config.axis_y2_tick_outer,isInit))}else if(hasTreemap){var padding=$$.getCurrentPadding();scale.x=linear_linear().rangeRound([padding.left,current.width-padding.right]),scale.y=linear_linear().rangeRound([padding.top,current.height-padding.bottom])}else null===(_b=$$.updateArc)||void 0===_b||_b.call($$)},xx:function(d){var config=this.config,_a=this.scale,x=_a.x,zoom=_a.zoom,fn=config.zoom_enabled&&zoom?zoom:x;return d?fn(isValue(d.x)?d.x:d):null},xv:function(d){var $$=this,axis=$$.axis,config=$$.config,_a=$$.scale,x=_a.x,zoom=_a.zoom,fn=config.zoom_enabled&&zoom?zoom:x,value=$$.getBaseValue(d);return axis.isTimeSeries()?value=parseDate.call($$,value):axis.isCategorized()&&isString(value)&&(value=config.axis_x_categories.indexOf(value)),fn(value)},yv:function(d){var _a=this.scale,y=_a.y,y2=_a.y2;return(d.axis&&"y2"===d.axis?y2:y)(this.getBaseValue(d))},subxx:function(d){return d?this.scale.subX(d.x):null}},billboard_size={setContainerSize:function(){var state=this.state;state.current.width=this.getCurrentWidth(),state.current.height=this.getCurrentHeight()},getCurrentWidth:function(){return this.config.size_width||this.getParentWidth()},getCurrentHeight:function(){var config=this.config,h=config.size_height||this.getParentHeight();return h>0?h:320/(this.hasType("gauge")&&!config.gauge_fullCircle?2:1)},getParentRectValue:function(key){for(var offsetName="offset".concat(capitalize(key)),parent=this.$el.chart.node(),v=0;v<30&&parent&&"BODY"!==parent.tagName;){try{v=getBoundingRect(parent,!0)[key]}catch(_a){offsetName in parent&&(v=parent[offsetName])}parent=parent.parentNode}var bodySize=doc.body[offsetName];return v>bodySize&&(v=bodySize),v},getParentWidth:function(){return this.getParentRectValue("width")},getParentHeight:function(){var h=this.$el.chart.style("height"),height=0;return h&&(height=/px$/.test(h)?parseInt(h,10):this.getParentRectValue("height")),height},getSvgLeft:function(withoutRecompute){var $$=this,config=$$.config,hasAxis=$$.state.hasAxis,$el=$$.$el,isRotated=config.axis_rotated,hasLeftAxisRect=isRotated||!isRotated&&!config.axis_y_inner,leftAxisClass=isRotated?$AXIS.axisX:$AXIS.axisY,leftAxis=$el.main.select(".".concat(leftAxisClass)).node(),leftLabel=hasAxis&&config["axis_".concat(isRotated?"x":"y","_label")],labelWidth=0;if(hasAxis&&(isString(leftLabel)||isString(leftLabel.text)||/^inner-/.test(null==leftLabel?void 0:leftLabel.position))){var label=$el.main.select(".".concat(leftAxisClass,"-label"));label.empty()||(labelWidth=getBoundingRect(label.node()).left)}var svgRect=leftAxis&&hasLeftAxisRect?getBoundingRect(leftAxis,!withoutRecompute):{right:0},chartRectLeft=getBoundingRect($el.chart.node(),!withoutRecompute).left+labelWidth,hasArc=$$.hasArcType(),svgLeft=svgRect.right-chartRectLeft-(hasArc?0:$$.getCurrentPaddingByDirection("left",withoutRecompute));return svgLeft>0?svgLeft:0},updateDimension:function(withoutAxis){var _a,$$=this,config=$$.config,hasAxis=$$.state.hasAxis,$el=$$.$el;hasAxis&&!withoutAxis&&$$.axis.x&&config.axis_rotated&&(null===(_a=$$.axis.subX)||void 0===_a||_a.create($el.axis.subX)),$$.updateScales(withoutAxis),$$.updateSvgSize(),$$.transformAll(!1)},updateSvgSize:function(){var $$=this,config=$$.config,_a=$$.state,clip=_a.clip,current=_a.current,hasAxis=_a.hasAxis,width=_a.width,height=_a.height,svg=$$.$el.svg;if("viewBox"===config.resize_auto?svg.attr("viewBox","0 0 ".concat(current.width," ").concat(current.height)):svg.attr("width",current.width).attr("height",current.height),hasAxis){var brush=svg.select(".".concat($SUBCHART.brush," .overlay")),brushSize={width:0,height:0};brush.size()&&(brushSize.width=+brush.attr("width"),brushSize.height=+brush.attr("height")),svg.selectAll(["#".concat(clip.id),"#".concat(clip.idGrid)]).select("rect").attr("width",width).attr("height",height),svg.select("#".concat(clip.idXAxis)).select("rect").call($$.setXAxisClipPath.bind($$)),svg.select("#".concat(clip.idYAxis)).select("rect").call($$.setYAxisClipPath.bind($$)),clip.idSubchart&&svg.select("#".concat(clip.idSubchart)).select("rect").attr("width",width).attr("height",brushSize.height)}},getCurrentPaddingByDirection:function(type,withoutRecompute,withXAxisTickTextOverflow){var _a;void 0===withoutRecompute&&(withoutRecompute=!1),void 0===withXAxisTickTextOverflow&&(withXAxisTickTextOverflow=!1);var v,$$=this,config=$$.config,$el=$$.$el,hasAxis=$$.state.hasAxis,isRotated=config.axis_rotated,isFitPadding="fit"===(null===(_a=config.padding)||void 0===_a?void 0:_a.mode),paddingOption=isNumber(config["padding_".concat(type)])?config["padding_".concat(type)]:void 0,axisId=hasAxis?{top:isRotated?"y2":null,bottom:isRotated?"y":"x",left:isRotated?"x":"y",right:isRotated?null:"y2"}[type]:null,isLeftRight=/^(left|right)$/.test(type),isAxisInner=axisId&&config["axis_".concat(axisId,"_inner")],isAxisShow=axisId&&config["axis_".concat(axisId,"_show")],axesLen=axisId?config["axis_".concat(axisId,"_axes")].length:0,axisSize=axisId?isLeftRight?$$.getAxisWidthByAxisId(axisId,withoutRecompute):$$.getHorizontalAxisHeight(axisId):0,gap=0;!isFitPadding&&isLeftRight&&(v=axisSize,axisSize=10*Math.ceil(v/10));var padding=hasAxis&&isLeftRight&&(isAxisInner||isUndefined(paddingOption)&&!isAxisShow)?0:isFitPadding?(isAxisShow?axisSize:0)+(null!=paddingOption?paddingOption:0):isUndefined(paddingOption)?axisSize:paddingOption;return isLeftRight&&hasAxis?(axisId&&(isFitPadding||isAxisInner)&&config["axis_".concat(axisId,"_label")].text&&(padding+=$$.axis.getAxisLabelPosition(axisId).isOuter?20:0),"right"===type?(padding+=isRotated?!isFitPadding&&isUndefined(paddingOption)?10:2:!isAxisShow||isAxisInner?isFitPadding?2:1:0,padding+=withXAxisTickTextOverflow?$$.axis.getXAxisTickTextY2Overflow(20):0):"left"===type&&isRotated&&isUndefined(paddingOption)&&(padding=config.axis_x_show?isFitPadding?axisSize:Math.max(axisSize,40):1)):"top"===type?($el.title&&$el.title.node()&&(padding+=$$.getTitlePadding()),gap=isRotated&&!isAxisInner?axesLen:0):"bottom"===type&&hasAxis&&isRotated&&!isAxisShow&&(padding+=1),padding+axisSize*axesLen-gap},getCurrentPadding:function(withXAxisTickTextOverflow){void 0===withXAxisTickTextOverflow&&(withXAxisTickTextOverflow=!1);var $$=this,_a=["top","bottom","left","right"].map(function(v){return $$.getCurrentPaddingByDirection(v,null,withXAxisTickTextOverflow)});return{top:_a[0],bottom:_a[1],left:_a[2],right:_a[3]}},getResettedPadding:function(v){var config=this.config,isNum=isNumber(v),p=isNum?0:{};return!1===config.padding?!isNum&&Object.keys(v).forEach(function(key){p[key]=isEmpty(config.data_labels)||!1===config.data_labels||"top"!==key?0:v[key]}):p=v,p},updateSizes:function(isInit){var _a,_b,_c,_d,_e,$$=this,config=$$.config,state=$$.state,legend=$$.$el.legend,isRotated=config.axis_rotated,isNonAxis=$$.hasArcType()||state.hasFunnel||state.hasTreemap,isFitPadding="fit"===(null===(_a=config.padding)||void 0===_a?void 0:_a.mode);!isInit&&$$.setContainerSize();var currLegend={width:legend?$$.getLegendWidth():0,height:legend?$$.getLegendHeight():0};!isNonAxis&&config.axis_x_show&&config.axis_x_tick_autorotate&&$$.updateXAxisTickClip();var legendSize_right=config.legend_show&&state.isLegendRight?$$.getLegendWidth()+(isFitPadding?0:20):0,legendSize_bottom=!config.legend_show||state.isLegendRight||state.isLegendInset?0:currLegend.height,xAxisHeight=isRotated||isNonAxis?0:$$.getHorizontalAxisHeight("x"),subchartXAxisHeight=config.subchart_axis_x_show&&config.subchart_axis_x_tick_text_show?xAxisHeight:30,subchartHeight=config.subchart_show&&!isNonAxis?config.subchart_size_height+subchartXAxisHeight:0,gaugeHeight=$$.hasType("gauge")&&config.arc_needle_show&&!config.gauge_fullCircle&&!config.gauge_label_show?10:0,padding=$$.getCurrentPadding(!0);if(state.margin=!isNonAxis&&isRotated?{top:padding.top,right:isNonAxis?0:padding.right+legendSize_right,bottom:legendSize_bottom+padding.bottom,left:subchartHeight+(isNonAxis?0:padding.left)}:{top:(isFitPadding?0:4)+padding.top,right:isNonAxis?0:padding.right+legendSize_right,bottom:gaugeHeight+subchartHeight+legendSize_bottom+padding.bottom,left:isNonAxis?0:padding.left},state.margin=$$.getResettedPadding(state.margin),state.margin2=isRotated?{top:state.margin.top,right:NaN,bottom:20+legendSize_bottom,left:$$.state.rotatedPadding.left}:{top:state.current.height-subchartHeight-legendSize_bottom,right:NaN,bottom:subchartXAxisHeight+legendSize_bottom,left:state.margin.left},state.margin3={top:0,right:NaN,bottom:0,left:0},null===(_b=$$.updateSizeForLegend)||void 0===_b||_b.call($$,currLegend),state.width=state.current.width-state.margin.left-state.margin.right,state.height=state.current.height-state.margin.top-state.margin.bottom,state.width<0&&(state.width=0),state.height<0&&(state.height=0),state.width2=isRotated?state.margin.left-state.rotatedPadding.left-state.rotatedPadding.right:state.width,state.height2=isRotated?state.height:state.current.height-state.margin2.top-state.margin2.bottom,state.width2<0&&(state.width2=0),state.height2<0&&(state.height2=0),$$.hasArcType()){var hasGauge=$$.hasType("gauge"),isLegendRight=config.legend_show&&state.isLegendRight,textWidth=null!==(_c=state.hasRadar&&$$.cache.get(KEY_radarTextWidth))&&void 0!==_c?_c:0;state.arcWidth=state.width-(isLegendRight?currLegend.width+10:0)-textWidth,state.arcHeight=state.height-(isLegendRight&&!hasGauge?0:10),(null===(_d=config.arc_rangeText_values)||void 0===_d?void 0:_d.length)&&(hasGauge?(state.arcWidth-=25,state.arcHeight-=10,state.margin.left+=10):(state.arcHeight-=20,state.margin.top+=10)),hasGauge&&!config.gauge_fullCircle&&(state.arcHeight+=state.height-$$.getPaddingBottomForGauge()),null===(_e=$$.updateRadius)||void 0===_e||_e.call($$)}state.isLegendRight&&isNonAxis&&(state.margin3.left=state.arcWidth/2+1.1*state.radiusExpanded)}},billboard_style={setCssRule:function(withShape,selector,props,propsFn){var $$=this,config=$$.config,_a=$$.state,cssRule=_a.cssRule,style=_a.style;return config.boost_useCssRule?function(selection){selection.each(function(d){var res=propsFn&&(null==propsFn?void 0:propsFn.call($$,d)),shapeSelector="".concat(withShape?".".concat($SHAPE.shapes+$$.getTargetSelectorSuffix(d.id)):"").concat(selector);selector in cssRule&&style.sheet.deleteRule(cssRule[shapeSelector]),$$.state.cssRule[shapeSelector]=function addCssRules(style,selector,prop){var s,_a=style.rootSelector,rootSelector=void 0===_a?"":_a,sheet=style.sheet,rule="".concat(rootSelector," ").concat((s=selector,s.replace(/\s?(bb-)/g,".$1").replace(/\.+/g,"."))," {").concat(prop.join(";"),"}");return sheet[sheet.insertRule?"insertRule":"addRule"](rule,sheet.cssRules.length)}(style,shapeSelector,props.filter(Boolean).map(function(v){return isString(res)&&-1===v.indexOf(":")?"".concat(v,": ").concat(res):v||""}))})}:function(){}},getStylePropValue:function(v){return this.config.boost_useCssRule?null:isFunction(v)?v.bind(this):v}};function setRotatePos(d,pos,anchor,isRotated,isInverted){var _a,value=d.value,isCandlestickType=this.isCandlestickType(d),isNegative=isNumber(value)&&value<0||isCandlestickType&&!(null===(_a=this.getCandlestickData(d))||void 0===_a?void 0:_a._isUp),x=pos.x,y=pos.y;return isRotated?"start"===anchor?(x+=isNegative?0:8,y+=4):"middle"===anchor?(x+=8,y-=8):"end"===anchor&&(isNegative&&(x-=8),y+=4):("start"===anchor?(x+=4,isNegative&&(y+=16)):"middle"===anchor?y-=8:"end"===anchor&&(x-=4,isNegative&&(y+=16)),isInverted&&(y+=isNegative?-17:isCandlestickType?13:7)),{x,y}}function getTextPos(d,type){var _a,position=this.config.data_labels_position,id=d.id,index=d.index,value=d.value;return null!==(_a=isFunction(position)?position.bind(this.api)(type,value,id,index,this.$el.text):(id in position?position[id]:position)[type])&&void 0!==_a?_a:0}function updateTextBorder(text,pos,rectClass){var _a,_b,config=this.config,$T=this.$T,isRotated=config.axis_rotated,_c=config.data_labels.border,_d=_c.padding,padding=void 0===_d?"3 5":_d,_e=_c.radius,radius=void 0===_e?10:_e,_f=_c.stroke,stroke=void 0===_f?"#000":_f,_g=_c.strokeWidth,strokeWidth=void 0===_g?1:_g,_h=_c.fill,fill=void 0===_h?"none":_h,borderPadding=function parseShorthand(value){if(isObject(value)&&!isString(value)){var obj=value;return{top:obj.top||0,right:obj.right||0,bottom:obj.bottom||0,left:obj.left||0}}var values=(isString(value)?value.trim().split(/\s+/):[value]).map(function(v){return+v||0}),a=values[0],_a=values[1],b=void 0===_a?a:_a,_b=values[2],c=void 0===_b?a:_b,_c=values[3];return{top:a,right:b,bottom:c,left:void 0===_c?b:_c}}(padding),applyStyle=!0!==config.data_labels.border,textRect=getBBox(text),borderRect=src_select(text.previousElementSibling);!borderRect.empty()&&"rect"===(null===(_a=borderRect.node())||void 0===_a?void 0:_a.tagName)&&(null===(_b=borderRect.attr("class"))||void 0===_b?void 0:_b.includes(rectClass))||(borderRect=src_select(text.parentNode).insert("rect",function(){return text}).attr("class","".concat($TEXT.textBorderRect," ").concat(rectClass)).attr("width",textRect.width+(applyStyle?borderPadding.left+borderPadding.right:0)).attr("height",textRect.height+(applyStyle?borderPadding.top+borderPadding.bottom:0)),applyStyle&&borderRect.style("fill",fill).style("stroke",stroke).style("stroke-width","".concat(strokeWidth,"px")).attr("rx",radius).attr("ry",radius)),$T(borderRect).attr("x",pos.x-(applyStyle?borderPadding.left:0)-(isRotated?0:textRect.width/2)).attr("y",pos.y-(applyStyle?borderPadding.top:0)-textRect.height/4*3.2)}function meetsLabelThreshold(ratio,type){void 0===ratio&&(ratio=0);return ratio>=(this.config["".concat(type,"_label_threshold")]||0)}function updateTextImage(){var $$=this,text=$$.$el.text,config=$$.config;($$.state.arcWidth?$$.getArcLabelConfig("image"):config.data_labels.image)&&text.filter(function(){var prev=this.previousElementSibling;return!prev||("image"!==prev.tagName||!prev.classList.contains($TEXT.textLabelImage))}).each(function(d){var _a,_b,_c,_d,_e=getDataLabelImgUrl.call($$,d),url=_e.url,width=_e.width,height=_e.height,pos=_e.pos;if(url){var parentNode=src_select(this.parentNode);null==parentNode||parentNode.insert("image","".concat(null!==(_b=null===(_a=this.getAttribute("class"))||void 0===_a?void 0:_a.replace(/(?:^(.)|\s)/g,".$1"))&&void 0!==_b?_b:"text")).style("opacity","0").attr("href",function(d){return tplProcess(url,{ID:"id"in d?d.id:d.data.id})}).attr("class",$TEXT.textLabelImage).style("pointer-events","none").attr("width",width).attr("height",height).attr("transform",pos?"translate(".concat(null!==(_c=pos.x)&&void 0!==_c?_c:0," ").concat(null!==(_d=pos.y)&&void 0!==_d?_d:0,")"):null)}})}function getDataLabelImgUrl(d){var _a,config=this.config,image=this.state.arcWidth?this.getArcLabelConfig("image"):config.data_labels.image;if(isFunction(image))return null!==(_a=image.call(this.api,d.value,d.id,d.index))&&void 0!==_a?_a:{url:"",width:0,height:0,pos:{x:0,y:0}};if(image){var _b=image.url,url=void 0===_b?"":_b,_c=image.width,width=void 0===_c?0:_c,_d=image.height;return{url,width,height:void 0===_d?0:_d,pos:image.pos}}return null}function updateTextImagePos(textNode,pos){var _a,_this=this,$$=this,config=$$.config,_b=$$.state,arcWidth=_b.arcWidth,hasTreemap=_b.hasTreemap,isRotated=config.axis_rotated,image=src_select(textNode.previousElementSibling);if(!image.empty()&&"image"===(null===(_a=image.node())||void 0===_a?void 0:_a.tagName)){var textRect=getBoundingRect(textNode),w=+image.attr("width")/2,h=+image.attr("height")/2,x=pos.x-w,y=pos.y-h-textRect.height/2;isRotated?pos.x+=w:(hasTreemap&&(x=-w,y=-(2*h+textRect.height)),$$.hasType("pie")||$$.hasType("polar")||(pos.y+=h)),$$.$T(image).style("opacity",function(textNode){var _a,isShown="0"!==textNode.style.opacity&&"0"!==textNode.style.fillOpacity;return(arcWidth?textNode.textContent:isShown)&&"image"!==(null===(_a=_this.previousElementSibling)||void 0===_a?void 0:_a.tagName)}(textNode)?null:"0").attr("x",x).attr("y",y)}}var billboard_text={opacityForText:function(d){return this.isBarType(d)&&!meetsLabelThreshold.call(this,Math.abs(this.getRatio("bar",d)),"bar")?"0":this.hasDataLabel?null:"0"},initText:function(){var $el=this.$el;$el.main.select(".".concat($COMMON.chart)).append("g").attr("class",$TEXT.chartTexts).style("pointer-events",$el.funnel||$el.treemap?"none":null)},updateTargetsForText:function(targets){var $$=this,classChartText=$$.getChartClass("Text"),classTexts=$$.getClass("texts","id"),classFocus=$$.classFocus.bind($$);$$.$el.main.select(".".concat($TEXT.chartTexts)).selectAll(".".concat($TEXT.chartText)).data($$.filterNullish(targets)).attr("class",function(d){return"".concat(classChartText(d)).concat(classFocus(d)).trim()}).enter().append("g").style("opacity","0").attr("class",classChartText).call($$.setCssRule(!0," .".concat($TEXT.text),["fill","pointer-events:none"],$$.updateTextColor)).append("g").attr("class",classTexts)},updateText:function(){var $$=this,$el=$$.$el,$T=$$.$T,config=$$.config,axis=$$.axis,classText=$$.getClass("text","index"),labelsCentered=config.data_labels.centered,text=$el.main.selectAll(".".concat($TEXT.texts)).selectAll(".".concat($TEXT.text)).data($$.labelishData.bind($$));$T(text.exit()).style("fill-opacity","0").remove(),$el.text=text.enter().append("text").merge(text).attr("class",classText).attr("text-anchor",function(d){var isEndAnchor=config["axis_".concat(null==axis?void 0:axis.getId(d.id),"_inverted")]?d.value>0:d.value<0;if($$.isCandlestickType(d)){var data=$$.getCandlestickData(d);isEndAnchor=!(null==data?void 0:data._isUp)}else if($$.isTreemapType(d))return labelsCentered?"middle":"start";return config.axis_rotated?isEndAnchor?"end":"start":"middle"}).style("fill",$$.getStylePropValue($$.updateTextColor)).style("fill-opacity","0").each(function(d,i,texts){var node=src_select(this),value=d.value;if($$.isBubbleZType(d))value=$$.getBubbleZData(value,"z");else if($$.isCandlestickType(d)){var data=$$.getCandlestickData(d);data&&(value=data.close)}value=$$.isTreemapType(d)?$$.treemapDataLabelFormat(d)(node):$$.dataLabelFormat(d.id)(value,d.id,d.index,texts),isNumber(value)?this.textContent=value:setTextValue(node,value)}),updateTextImage.call($$)},updateTextColor:function(d){var color,$$=this,config=$$.config,labelColors=config.data_labels_colors,defaultColor=$$.isArcType(d)&&!$$.isRadarType(d)||$$.isFunnelType(d)||$$.isTreemapType(d)?null:$$.color(d);if(isString(labelColors))color=labelColors;else if(isObject(labelColors)){color=labelColors[(d.data||d).id]}else isFunction(labelColors)&&(color=labelColors.bind($$.api)(defaultColor,d));if($$.isCandlestickType(d)&&!isFunction(labelColors)){var value=$$.getCandlestickData(d);if(!(null==value?void 0:value._isUp)){var downColor=config.candlestick_color_down;color=isObject(downColor)?downColor[d.id]:downColor}}return color||defaultColor},updateTextBGColor:function(d,option){var $$=this,defs=$$.$el.defs,color="";if(option){var id=isString(option)?"":$$.getTargetSelectorSuffix("id"in d?d.id:d.data.id),filter=defs.select(["filter[id*='labels-bg","']"].join(id));if(filter.size()&&(color="url(#".concat(filter.attr("id"),")")),isFunction(option)){$$.generateTextBGColorFilter(option);var defaultColor=$$.color(d),bgColor=option.bind($$.api)(defaultColor,d);bgColor?filter.select("feFlood").attr("flood-color",bgColor):color=""}}return color||null},redrawText:function(getX,getY,forFlow,withTransition){var $$=this,$T=$$.$T,axis=$$.axis,config=$$.config,hasTreemap=$$.state.hasTreemap,t=getRandom(!0),isRotated=config.axis_rotated,angle=config.data_labels.rotate,anchorString=function getRotateAnchor(angle){var anchor="middle";return angle>0&&angle<=170?anchor="end":angle>190&&angle<=360&&(anchor="start"),anchor}(angle),rotateString=angle?"rotate(".concat(angle,")"):"";return $$.$el.text.style("fill",$$.getStylePropValue($$.updateTextColor)).attr("filter",function(d){return $$.updateTextBGColor.bind($$)(d,config.data_labels_backgroundColors)}).style("fill-opacity",forFlow?0:$$.opacityForText.bind($$)).each(function(d,i){var node=$T(hasTreemap&&this.childElementCount?this.parentNode:this,!(!withTransition||!this.getAttribute("x")&&!this.getAttribute("transform")),t),isInverted=config["axis_".concat(null==axis?void 0:axis.getId(d.id),"_inverted")],pos={x:getX.bind(this)(d,i),y:getY.bind(this)(d,i)};angle&&(pos=setRotatePos.bind($$)(d,pos,anchorString,isRotated,isInverted),node.attr("text-anchor",anchorString)),updateTextImagePos.call($$,this,pos),this.childElementCount||angle?node.attr("transform","translate(".concat(pos.x," ").concat(pos.y,") ").concat(rotateString)):node.attr("x",pos.x).attr("y",pos.y),config.data_labels.border&&updateTextBorder.call($$,node.node(),pos,"".concat($TEXT.textBorderRect,"-").concat(i))}),!0},getTextRect:function(source,className){var _a,_b,_c,cacheKey,base,text;Array.isArray(source)?cacheKey="".concat(KEY_textRect,"-").concat(source.join("_")):(base=null!==(_c=null===(_b=(_a=source).node)||void 0===_b?void 0:_b.call(_a))&&void 0!==_c?_c:source,/text/i.test(base.tagName)||(base=base.querySelector("text")),text=base.textContent,cacheKey="".concat(KEY_textRect,"-").concat(text.replace(/\W/g,"_")));var rect=this.cache.get(cacheKey)||[];return 0===rect.length&&((this.$el.svg||this.$el.chart.select("svg")).selectAll(".".concat($COMMON.dummy)).data(text?[text]:source).enter().append("text").style("visibility","hidden").style("font",base?src_select(base).style("font"):null).classed(className||$COMMON.dummy,!0).text(function(d){return d}).each(function(v,i){rect[i]=getBoundingRect(this)}).remove(),this.cache.add(cacheKey,rect)),rect.length>1?rect:rect[0]},generateXYForText:function(indices,forX){var $$=this,_a=$$.state,hasRadar=_a.hasRadar,hasFunnel=_a.hasFunnel,hasTreemap=_a.hasTreemap,types=Object.keys(indices),points={},getter=forX?$$.getXForText:$$.getYForText;return hasFunnel&&types.push("funnel"),hasRadar&&types.push("radar"),hasTreemap&&types.push("treemap"),types.forEach(function(v){points[v]=$$["generateGet".concat(capitalize(v),"Points")](indices[v],!1)}),function(d,i){var type=($$.isAreaType(d)?"area":$$.isBarType(d)&&"bar")||$$.isCandlestickType(d)&&"candlestick"||$$.isFunnelType(d)&&"funnel"||$$.isRadarType(d)&&"radar"||$$.isTreemapType(d)&&"treemap"||"line";return getter.call($$,points[type](d,i),d,this)}},getCenteredTextPos:function(d,points,textElement,type){var config=this.config,isRotated=config.axis_rotated,isBarType=this.isBarType(d),isTreemapType=this.isTreemapType(d);if(config.data_labels.centered&&(isBarType||isTreemapType)){var rect=getBoundingRect(textElement);if(isBarType){var isPositive=this.getRangedData(d,null,"bar")>=0;if(isRotated){var w=(isPositive?points[1][1]-points[0][1]:points[0][1]-points[1][1])/2+rect.width/2;return isPositive?-w-3:w+2}var h=(isPositive?points[0][1]-points[1][1]:points[1][1]-points[0][1])/2+rect.height/2;return isPositive?h:-h-2}if(isTreemapType)return"x"===type?(points[1][0]-points[0][0])/2:(points[1][1]-points[0][1])/2+rect.height/2}return 0},getXForText:function(points,d,textElement){var _a,$$=this,config=$$.config,isRotated=config.axis_rotated,isFunnelType=$$.isFunnelType(d),isTreemapType=$$.isTreemapType(d),xPos=points?points[0][0]:0;if($$.isCandlestickType(d))isRotated?xPos=(null===(_a=$$.getCandlestickData(d))||void 0===_a?void 0:_a._isUp)?points[2][2]+4:points[2][1]-4:xPos+=(points[1][0]-xPos)/2;else if(isFunnelType)xPos+=$$.state.current.width/2;else if(isTreemapType)xPos+=config.data_labels.centered?0:5;else if(isRotated){var isInverted=config["axis_".concat($$.axis.getId(d.id),"_inverted")],padding=$$.isBarType(d)?4:6,value=d.value;xPos=points[2][1],isInverted?xPos-=padding*(value>0?1:-1):xPos+=padding*(value<0?-1:1)}else xPos=$$.hasType("bar")?(points[2][0]+points[0][0])/2:xPos;return(isRotated||isTreemapType)&&(xPos+=$$.getCenteredTextPos(d,points,textElement,"x")),xPos+getTextPos.call(this,d,"x")},getYForText:function(points,d,textElement){var yPos,$$=this,axis=$$.axis,config=$$.config,state=$$.state,isRotated=config.axis_rotated,isInverted=config["axis_".concat(null==axis?void 0:axis.getId(d.id),"_inverted")],isBarType=$$.isBarType(d),isFunnelType=$$.isFunnelType(d),isTreemapType=$$.isTreemapType(d),r=config.point_r,rect=getBoundingRect(textElement),value=d.value,baseY=3;if($$.isCandlestickType(d))value=$$.getCandlestickData(d),isRotated?(yPos=points[0][0],yPos+=(points[1][0]-yPos)/2+baseY):(yPos=value&&value._isUp?points[2][2]-baseY:points[2][1]+4*baseY,isInverted&&(yPos+=15*(value._isUp?1:-1)));else if(isFunnelType)yPos=points?points[0][1]+(points[1][1]-points[0][1])/2+rect.height/2-3:0;else if(isTreemapType)yPos=points[0][1]+(config.data_labels.centered?0:rect.height+5);else if(isRotated)yPos=(points[0][0]+points[2][0]+.6*rect.height)/2;else if(yPos=points[2][1],isNumber(r)&&r>5&&($$.isLineType(d)||$$.isScatterType(d))&&(baseY+=config.point_r/2.3),value<0||0===value&&!state.hasPositiveValue&&state.hasNegativeValue)yPos+=isInverted?isBarType?-3:-5:rect.height+(isBarType?-baseY:baseY);else{var diff=2*-baseY;isBarType?diff=-baseY:$$.isBubbleType(d)&&(diff=baseY),isInverted&&(diff=isBarType?10:15),yPos+=diff}return isRotated&&!isTreemapType||(yPos+=$$.getCenteredTextPos(d,points,textElement,"y")),yPos+getTextPos.call(this,d,"y")},markOverlapped:function(id,$$,selector){var textNodes=$$.$el.arcs.selectAll(selector),filteredTextNodes=textNodes.filter(function(node){return node.data.id!==id}),textNode=textNodes.filter(function(node){return node.data.id===id}),translate=getTranslation(textNode.node()),calcHypo=function(x,y){return Math.sqrt(Math.pow(x,2)+Math.pow(y,2))};textNode.node()&&filteredTextNodes.each(function(){var coordinate=getTranslation(this),filteredTextNode=src_select(this),nodeForWidth=calcHypo(translate.e,translate.f)>calcHypo(coordinate.e,coordinate.f)?textNode:filteredTextNode,overlapsX=Math.ceil(Math.abs(translate.e-coordinate.e))<Math.ceil(nodeForWidth.node().getComputedTextLength()),overlapsY=Math.ceil(Math.abs(translate.f-coordinate.f))<parseInt(textNode.style("font-size"),10);filteredTextNode.classed($TEXT.TextOverlapping,overlapsX&&overlapsY)})},undoMarkOverlapped:function($$,selector){$$.$el.arcs.selectAll(selector).each(function(){src_selectAll([this,this.previousSibling]).classed($TEXT.TextOverlapping,!1)})}};function getTextXPos(pos,width){void 0===pos&&(pos="left");var isNum=isNumber(width);return pos.indexOf("center")>-1?isNum?width/2:"middle":pos.indexOf("right")>-1?isNum?width:"end":isNum?0:"start"}var title={initTitle:function(){var config=this.config,$el=this.$el;config.title_text&&($el.title=$el.svg.append("g"),setTextValue($el.title.append("text").style("text-anchor",getTextXPos(config.title_position)).attr("class",$TEXT.title),config.title_text,[.3,1.5]))},redrawTitle:function(){var $$=this,config=$$.config,current=$$.state.current,title=$$.$el.title;if(title){var x=getTextXPos(config.title_position,current.width),y=(config.title_padding.top||0)+$$.getTextRect($$.$el.title,$TEXT.title).height;title.attr("transform","translate(".concat(x,", ").concat(y,")"))}},getTitlePadding:function(){var title=this.$el.title,config=this.config;return(config.title_padding.top||0)+(title?this.getTextRect(title,$TEXT.title).height:0)+(config.title_padding.bottom||0)}},tooltip$1={initTooltip:function(){var config=this.config,$el=this.$el;$el.tooltip=src_select(config.tooltip_contents.bindto),$el.tooltip.empty()&&($el.tooltip=$el.chart.append("div").attr("class",$TOOLTIP.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none")),this.bindTooltipResizePos()},initShowTooltip:function(){var _a,_b,$$=this,config=$$.config,$el=$$.$el,_c=$$.state,hasAxis=_c.hasAxis,hasRadar=_c.hasRadar;if(config.tooltip_init_show){var isArc=!(hasAxis||hasRadar);(null===(_b=$$.axis)||void 0===_b?void 0:_b.isTimeSeries())&&isString(config.tooltip_init_x)&&(config.tooltip_init_x=parseDate.call($$,config.tooltip_init_x)),$$.api.tooltip.show({data:(_a={},_a[isArc?"index":"x"]=config.tooltip_init_x,_a)});var position=config.tooltip_init_position;if(!config.tooltip_contents.bindto&&!isEmpty(position)){var _d=position.top,top_1=void 0===_d?0:_d,_e=position.left,left=void 0===_e?50:_e;$el.tooltip.style("top",isString(top_1)?top_1:"".concat(top_1,"px")).style("left",isString(left)?left:"".concat(left,"px")).style("display",null)}}},getTooltipHTML:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var api=this.api,config=this.config;return isFunction(config.tooltip_contents)?config.tooltip_contents.bind(api).apply(void 0,args):this.getTooltipContent.apply(this,args)},getTooltipContent:function(d,defaultTitleFormat,defaultValueFormat,color){var _a,$$=this,api=$$.api,config=$$.config,state=$$.state,$el=$$.$el,_b=["title","name","value"].map(function(v){var fn=config["tooltip_format_".concat(v)];return isFunction(fn)?fn.bind(api):fn}),titleFn=_b[0],nameFn=_b[1],valueFn=_b[2],nameFormat=function(){for(var arg=[],_i=0;_i<arguments.length;_i++)arg[_i]=arguments[_i];return sanitize((nameFn||function(name){return name}).apply(void 0,arg))},valueFormat=function(){for(var arg=[],_i=0;_i<arguments.length;_i++)arg[_i]=arguments[_i];return sanitize((valueFn||(state.hasTreemap||$$.isStackNormalized()?function(v,ratio){return"".concat((100*ratio).toFixed(2),"%")}:defaultValueFormat)).apply(void 0,arg))},order=config.tooltip_order,getRowValue=function(row){return $$.axis&&$$.isBubbleZType(row)?$$.getBubbleZData(row.value,"z"):$$.getBaseValue(row)},getBgColor=$$.levelColor?function(row){return $$.levelColor(row.value)}:function(row){return color(row)},contents=config.tooltip_contents,tplStr=contents.template,targetIds=$$.mapToTargetIds();if(null===order&&config.data_groups.length){var ids_1=$$.orderTargets($$.data.targets).map(function(i2){return i2.id}).reverse();d.sort(function(a,b){var v1=a?a.value:null,v2=b?b.value:null;return v1>0&&v2>0&&(v1=a.id?ids_1.indexOf(a.id):null,v2=b.id?ids_1.indexOf(b.id):null),v1-v2})}else if(/^(asc|desc)$/.test(order)){var isAscending_1="asc"===order;d.sort(function(a,b){var v1=a?getRowValue(a):null,v2=b?getRowValue(b):null;return isAscending_1?v1-v2:v2-v1})}else isFunction(order)&&d.sort(order.bind(api));var text,row,param,value,i,tpl=$$.getTooltipContentTemplate(tplStr),len=d.length,_loop_1=function(){if(!(row=d[i])||!getRowValue(row)&&0!==getRowValue(row))return"continue";if(isUndefined(text)){var title=(state.hasAxis||state.hasRadar)&&function(){for(var arg=[],_i=0;_i<arguments.length;_i++)arg[_i]=arguments[_i];return sanitize((titleFn||defaultTitleFormat).apply(void 0,arg))}(row.x);text=tplProcess(tpl[0],{CLASS_TOOLTIP:$TOOLTIP.tooltip,TITLE:isValue(title)?tplStr?title:'<tr><th colspan="2">'.concat(title,"</th></tr>"):""})}if(!row.ratio&&$el.arcs&&(param=["arc",$$.$el.arcs.select("path.".concat($ARC.arc,"-").concat(row.id)).data()[0]],row.ratio=$$.getRatio.apply($$,param)),param=[row.ratio,row.id,row.index],$$.isAreaRangeType(row)){var _c=["high","low"].map(function(v){return valueFormat.apply(void 0,__spreadArray([$$.getRangedData(row,v)],param,!1))}),high=_c[0],low=_c[1],mid=valueFormat.apply(void 0,__spreadArray([getRowValue(row)],param,!1));value="<b>Mid:</b> ".concat(mid," <b>High:</b> ").concat(high," <b>Low:</b> ").concat(low)}else if($$.isCandlestickType(row)){var _d=["open","high","low","close","volume"].map(function(v){return $$.getRangedData(row,v,"candlestick")?valueFormat.apply(void 0,__spreadArray([$$.getRangedData(row,v,"candlestick")],param,!1)):void 0}),open_1=_d[0],close_1=(high=_d[1],low=_d[2],_d[3]),volume=_d[4];value="<b>Open:</b> ".concat(open_1," <b>High:</b> ").concat(high," <b>Low:</b> ").concat(low," <b>Close:</b> ").concat(close_1).concat(volume?" <b>Volume:</b> ".concat(volume):"")}else if($$.isBarRangeType(row)){var rangeValue=row.value,id=row.id,index=row.index;value="".concat(valueFormat(rangeValue,void 0,id,index))}else value=valueFormat.apply(void 0,__spreadArray([getRowValue(row)],param,!1));if(void 0!==value){if(null===row.name)return"continue";var name_1=nameFormat.apply(void 0,__spreadArray([null!==(_a=row.name)&&void 0!==_a?_a:row.id],param,!1)),color_1=getBgColor(row),contentValue_1={CLASS_TOOLTIP_NAME:$TOOLTIP.tooltipName+$$.getTargetSelectorSuffix(row.id),COLOR:tplStr||!$$.patterns?color_1:'<svg><rect style="fill:'.concat(color_1,'" width="10" height="10"></rect></svg>'),NAME:name_1,VALUE:value};if(tplStr&&isObject(contents.text)){var index_1=targetIds.indexOf(row.id);Object.keys(contents.text).forEach(function(key){contentValue_1[key]=contents.text[key][index_1]})}text+=tplProcess(tpl[1],contentValue_1)}};for(i=0;i<len;i++)_loop_1();return"".concat(text,"</table>")},getTooltipContentTemplate:function(tplStr){return(tplStr||'<table class="{=CLASS_TOOLTIP}"><tbody>\n\t\t\t\t{=TITLE}\n\t\t\t\t{{<tr class="{=CLASS_TOOLTIP_NAME}">\n\t\t\t\t\t<td class="name">'.concat(this.patterns?"{=COLOR}":'<span style="background-color:{=COLOR}"></span>','{=NAME}</td>\n\t\t\t\t\t<td class="value">{=VALUE}</td>\n\t\t\t\t</tr>}}\n\t\t\t</tbody></table>')).replace(/(\r?\n|\t)/g,"").split(/{{(.*)}}/)},setTooltipPosition:function(dataToShow,eventTarget){var _a,_b,$$=this,config=$$.config,scale=$$.scale,state=$$.state,_c=$$.$el,eventRect=_c.eventRect,tooltip=_c.tooltip,svg=_c.svg,bindto=config.tooltip_contents.bindto,isRotated=config.axis_rotated,datum=null==tooltip?void 0:tooltip.datum();if(!bindto&&datum){var data=null!=dataToShow?dataToShow:JSON.parse(datum.current),_d=getPointer(state.event,null!=eventTarget?eventTarget:null==eventRect?void 0:eventRect.node()),currPos={x:_d[0],y:_d[1]};if(state.hasAxis&&scale.x&&datum&&"x"in datum){var getYPos=function(value,id,axisId){var _a;void 0===value&&(value=0),void 0===axisId&&(axisId="y");var scaleFn=scale[id?null===(_a=$$.axis)||void 0===_a?void 0:_a.getId(id):axisId];return scaleFn?scaleFn(value)+(isRotated?state.margin.left:state.margin.top):0};currPos.xAxis=scale.x(datum.x)+(config.tooltip_position?isRotated?state.margin.top:state.margin.left:0),1===data.length?currPos.yAxis=getYPos(data[0].value,data[0].id):currPos.yAxis=getYPos}var _e=datum.width,width=void 0===_e?0:_e,_f=datum.height,height=void 0===_f?0:_f,pos_1=null!==(_b=null===(_a=config.tooltip_position)||void 0===_a?void 0:_a.bind($$.api)(data,width,height,null==eventRect?void 0:eventRect.node(),currPos))&&void 0!==_b?_b:hasViewBox(svg)?$$.getTooltipPositionViewBox.bind($$)(width,height,currPos):$$.getTooltipPosition.bind($$)(width,height,currPos);["top","left"].forEach(function(v){var value=pos_1[v];tooltip.style(v,"".concat(value,"px")),"left"!==v||datum.xPosInPercent||(datum.xPosInPercent=value/state.current.width*100)})}},getTooltipPositionViewBox:function(tWidth,tHeight,currPos){var _a,_b,_c=this.$el,eventRect=_c.eventRect,svg=_c.svg,config=this.config,state=this.state,isRotated=config.axis_rotated,hasArcType=this.hasArcType()||state.hasFunnel||state.hasTreemap,target=null!==(_b=null===(_a=hasArcType?svg:eventRect)||void 0===_a?void 0:_a.node())&&void 0!==_b?_b:state.event.target,x=currPos.x,y=currPos.y;state.hasAxis&&(x=isRotated?x:currPos.xAxis,y=isRotated?currPos.xAxis:y);var ctm=getTransformCTM(target,x,y,!1),rect=getBoundingRect(target),size=getTransformCTM(target,20,0,!1).x,top=ctm.y,left=ctm.x+tWidth/2+size;return hasArcType&&(state.hasFunnel||state.hasTreemap||state.hasRadar?(left-=tWidth/2+size,top+=tHeight):(top+=rect.height/2,left+=rect.width/2-(tWidth-size))),left+tWidth>rect.width&&(left=rect.width-tWidth-size),top+tHeight>rect.height&&(top-=2*tHeight),{top,left}},getTooltipPosition:function(tWidth,tHeight,currPos){var _a,_b,_c,$$=this,config=$$.config,scale=$$.scale,state=$$.state,width=state.width,height=state.height,current=state.current,hasFunnel=state.hasFunnel,hasRadar=state.hasRadar,hasTreemap=state.hasTreemap,isLegendRight=state.isLegendRight,inputType=state.inputType,hasGauge=$$.hasType("gauge")&&!config.gauge_fullCircle,isRotated=config.axis_rotated,hasArcType=$$.hasArcType(),svgLeft=$$.getSvgLeft(!0),chartRight=svgLeft+current.width-$$.getCurrentPaddingByDirection("right"),x=currPos.x,y=currPos.y;if(hasRadar)x+=x>=width/2?15:-(tWidth+15),y+=15;else if(hasArcType){if("touch"!==inputType){var titlePadding=null!==(_b=null===(_a=$$.getTitlePadding)||void 0===_a?void 0:_a.call($$))&&void 0!==_b?_b:0;titlePadding&&hasGauge&&(null===(_c=config.arc_rangeText_values)||void 0===_c?void 0:_c.length)&&(titlePadding+=10),x+=(width-(isLegendRight?$$.getLegendWidth():0))/2,y+=(hasGauge?height:height/2+tHeight)+titlePadding}}else if(hasFunnel||hasTreemap)y+=tHeight;else{var padding={top:$$.getCurrentPaddingByDirection("top",!0),left:$$.getCurrentPaddingByDirection("left",!0)};isRotated?(x+=svgLeft+padding.left+20,y=padding.top+currPos.xAxis+20,chartRight-=svgLeft):(x=svgLeft+padding.left+20+(scale.zoom?x:currPos.xAxis),y+=padding.top-5)}(x+tWidth+15>chartRight&&(x-=tWidth+(hasFunnel||hasTreemap||hasArcType?0:isRotated?40:38)),y+tHeight>current.height)&&(y-=hasGauge?1.5*tHeight:tHeight+(hasTreemap?tHeight+10:30));var pos={top:y,left:x};return Object.keys(pos).forEach(function(v){pos[v]<0&&(pos[v]=0)}),pos},showTooltip:function(selectedData,eventTarget){var $$=this,config=$$.config,tooltip=$$.$el.tooltip,dataToShow=selectedData.filter(function(d){return d&&isValue($$.getBaseValue(d))});if(tooltip&&0!==dataToShow.length&&config.tooltip_show){var datum=tooltip.datum(),dataStr=JSON.stringify(selectedData);if(!datum||datum.current!==dataStr){var _a=selectedData.concat().sort()[0],index=_a.index,x=_a.x;callFn(config.tooltip_onshow,$$.api,selectedData),tooltip.html($$.getTooltipHTML(selectedData,$$.axis?$$.axis.getXAxisTickFormat():$$.categoryName.bind($$),$$.getDefaultValueFormat(),$$.color)).style("display",null).style("visibility",null).datum(datum={index,x,current:dataStr,width:tooltip.property("offsetWidth"),height:tooltip.property("offsetHeight")}),callFn(config.tooltip_onshown,$$.api,selectedData),$$._handleLinkedCharts(!0,index)}$$.setTooltipPosition(dataToShow,eventTarget)}},bindTooltipResizePos:function(){var resizeFunction=this.resizeFunction,state=this.state,tooltip=this.$el.tooltip;resizeFunction.add(function(){if("block"===tooltip.style("display")){var current=state.current,_a=tooltip.datum(),width=_a.width,xPosInPercent=_a.xPosInPercent,value=current.width/100*xPosInPercent,diff=current.width-(value+width);diff<0&&(value+=diff),tooltip.style("left","".concat(value,"px"))}})},hideTooltip:function(force){var _a,api=this.api,config=this.config,tooltip=this.$el.tooltip;if(tooltip&&"none"!==tooltip.style("display")&&(!config.tooltip_doNotHide||force)){var selectedData=JSON.parse(null!==(_a=tooltip.datum().current)&&void 0!==_a?_a:{});callFn(config.tooltip_onhide,api,selectedData),tooltip.style("display","none").style("visibility","hidden").datum(null),callFn(config.tooltip_onhidden,api,selectedData)}},_handleLinkedCharts:function(show,index){var $$=this,charts=$$.charts,config=$$.config,event=$$.state.event;if((null==event?void 0:event.isTrusted)&&config.tooltip_linked&&charts.length>1){var linkedName_1=config.tooltip_linked_name;charts.filter(function(c){return c!==$$.api}).forEach(function(c){var _a=c.internal,config=_a.config,$el=_a.$el,isLinked=config.tooltip_linked,name=config.tooltip_linked_name,isInDom=doc.body.contains($el.chart.node());if(isLinked&&linkedName_1===name&&isInDom){var data=$el.tooltip.data()[0],isNotSameIndex=index!==(null==data?void 0:data.index);try{c.tooltip[show&&isNotSameIndex?"show":"hide"]({index})}catch(_b){}}})}},updateTooltipOnRedraw:function(context,index){var _a,$$=this,config=$$.config,_b=$$.$el,eventRect=_b.eventRect,svg=_b.svg,tooltip=_b.tooltip,_c=$$.state,event=_c.event,hasAxis=_c.hasAxis,hasRadar=_c.hasRadar,hasTreemap=_c.hasTreemap;if("block"===(null==tooltip?void 0:tooltip.style("display"))&&event){var rect=null!=context?context:null===(_a=hasRadar?svg:eventRect)||void 0===_a?void 0:_a.node();if(hasAxis||hasRadar)if($$.isMultipleX())$$.selectRectForMultipleXs(rect,!1);else{var idx=null!=index?index:$$.getDataIndexFromEvent(event);-1===index?$$.api.tooltip.hide():($$.selectRectForSingle(rect,idx),$$.setExpand(idx,null,!0))}else{var clientX_1=event.clientX,clientY_1=event.clientY;setTimeout(function(){var target=[clientX_1,clientY_1].every(Number.isFinite)&&doc.elementFromPoint(clientX_1,clientY_1),data=target&&src_select(target).datum();if(data){var d=$$.hasArcType()?$$.convertToArcData($$.updateAngle(data)):null==data?void 0:data.data;hasTreemap&&(target=svg.node()),d&&$$.showTooltip([d],target)}else $$.api.tooltip.hide()},config.transition_duration)}}}},billboard_transform={getTranslate:function(target,index){var _a;void 0===index&&(index=0);var x,y,$$=this,config=$$.config,state=$$.state,isRotated=config.axis_rotated,padding=0;if(index&&/^(x|y2?)$/.test(target)&&(padding=$$.getAxisSize(target)*index),"main"===target)x=asHalfPixel(state.margin.left),y=asHalfPixel(state.margin.top);else if("context"===target)x=asHalfPixel(state.margin2.left),y=asHalfPixel(state.margin2.top);else if("legend"===target)x=state.margin3.left,y=state.margin3.top;else if("x"===target)x=isRotated?-padding:0,y=isRotated?0:state.height+padding;else if("y"===target)x=isRotated?0:-padding,y=isRotated?state.height+padding:0;else if("y2"===target)x=isRotated?0:state.width+padding,y=isRotated?-padding-1:0;else if("subX"===target)x=0,y=isRotated?0:state.height2;else if("arc"===target)x=state.arcWidth/2,y=state.arcHeight/2,(null===(_a=config.arc_rangeText_values)||void 0===_a?void 0:_a.length)&&(y+=5+($$.hasType("gauge")&&config.title_text?10:0));else if("polar"===target)x=state.arcWidth/2,y=state.arcHeight/2;else if("radar"===target){var _b=$$.getRadarSize(),width=_b[0],height=_b[1];x=state.width/2-width,y=state.height/2-height}return"translate(".concat(x,", ").concat(y,")")},transformMain:function(withTransition,transitions){var $$=this,main=$$.$el.main,$T=$$.$T,xAxis=(null==transitions?void 0:transitions.axisX)?transitions.axisX:$T(main.select(".".concat($AXIS.axisX)),withTransition),yAxis=(null==transitions?void 0:transitions.axisY)?transitions.axisY:$T(main.select(".".concat($AXIS.axisY)),withTransition),y2Axis=(null==transitions?void 0:transitions.axisY2)?transitions.axisY2:$T(main.select(".".concat($AXIS.axisY2)),withTransition);$T(main,withTransition).attr("transform",$$.getTranslate("main")),xAxis.attr("transform",$$.getTranslate("x")),yAxis.attr("transform",$$.getTranslate("y")),y2Axis.attr("transform",$$.getTranslate("y2")),main.select(".".concat($ARC.chartArcs)).attr("transform",$$.getTranslate("arc"))},transformAll:function(withTransition,transitions){var $$=this,config=$$.config,_a=$$.state,hasAxis=_a.hasAxis,hasFunnel=_a.hasFunnel,hasTreemap=_a.hasTreemap,$el=$$.$el;!hasFunnel&&!hasTreemap&&$$.transformMain(withTransition,transitions),hasAxis&&config.subchart_show&&$$.transformContext(withTransition,transitions),$el.legend&&$$.transformLegend(withTransition)}},typeInternals={isValidChartType:function(type){return!!(type&&Object.values(TYPE).indexOf(type)>-1)},setTargetType:function(targetIds,type){var config=this.config,withoutFadeIn=this.state.withoutFadeIn;this.mapToTargetIds(targetIds).forEach(function(id){withoutFadeIn[id]=type===config.data_types[id],config.data_types[id]=type}),targetIds||(config.data_type=type)},updateTypesElements:function(){var $$=this,current=$$.state.current;Object.keys(TYPE).forEach(function(v){var t=TYPE[v],has=$$.hasType(t,null,!0),idx=current.types.indexOf(t);-1===idx&&has?current.types.push(t):idx>-1&&!has&&current.types.splice(idx,1)}),$$.setChartElements()},hasType:function(type,targetsValue,checkFromData){var _a;void 0===checkFromData&&(checkFromData=!1);var config=this.config,current=this.state.current,types=config.data_types,targets=targetsValue||this.data.targets,has=!1;return!checkFromData&&(null===(_a=current.types)||void 0===_a?void 0:_a.indexOf(type))>-1?has=!0:(null==targets?void 0:targets.length)?targets.forEach(function(target){var t=types[target.id];(t===type||!t&&"line"===type)&&(has=!0)}):Object.keys(types).length?Object.keys(types).forEach(function(id){types[id]===type&&(has=!0)}):has=config.data_type===type,has},hasTypeOf:function(type,targets,exclude){var _this=this;return void 0===exclude&&(exclude=[]),type in TYPE_BY_CATEGORY&&!TYPE_BY_CATEGORY[type].filter(function(v){return-1===exclude.indexOf(v)}).every(function(v){return!_this.hasType(v,targets)})},isTypeOf:function(d,type){var _a,id=isString(d)?d:d.id,dataType=this.config&&((null===(_a=this.config.data_types)||void 0===_a?void 0:_a[id])||this.config.data_type);return isArray(type)?type.indexOf(dataType)>=0:dataType===type},hasPointType:function(){return this.hasTypeOf("Line")||this.hasType("bubble")||this.hasType("scatter")},hasArcType:function(targets,exclude){return this.hasTypeOf("Arc",targets,exclude)},hasMultiArcGauge:function(){return this.hasType("gauge")&&"multi"===this.config.gauge_type},isLineType:function(d){var id=isString(d)?d:d.id;return!this.config.data_types[id]||this.isTypeOf(id,TYPE_BY_CATEGORY.Line)},isStepType:function(d){return this.isTypeOf(d,TYPE_BY_CATEGORY.Step)},isSplineType:function(d){return this.isTypeOf(d,TYPE_BY_CATEGORY.Spline)},isAreaType:function(d){return this.isTypeOf(d,TYPE_BY_CATEGORY.Area)},isAreaRangeType:function(d){return this.isTypeOf(d,TYPE_BY_CATEGORY.AreaRange)},isBarType:function(d){return this.isTypeOf(d,"bar")},isBubbleType:function(d){return this.isTypeOf(d,"bubble")},isCandlestickType:function(d){return this.isTypeOf(d,"candlestick")},isScatterType:function(d){return this.isTypeOf(d,"scatter")},isTreemapType:function(d){return this.isTypeOf(d,"treemap")},isPieType:function(d){return this.isTypeOf(d,"pie")},isFunnelType:function(d){return this.isTypeOf(d,"funnel")},isGaugeType:function(d){return this.isTypeOf(d,"gauge")},isDonutType:function(d){return this.isTypeOf(d,"donut")},isPolarType:function(d){return this.isTypeOf(d,"polar")},isRadarType:function(d){return this.isTypeOf(d,"radar")},isArcType:function(d){return this.isPieType(d)||this.isDonutType(d)||this.isGaugeType(d)||this.isPolarType(d)||this.isRadarType(d)},isCirclePoint:function(node){var config=this.config,pattern=config.point_pattern;return"circle"===(null==node?void 0:node.tagName)||"circle"===config.point_type&&(!pattern||isArray(pattern)&&0===pattern.length)},lineData:function(d){return this.isLineType(d)?[d]:[]},arcData:function(d){return this.isArcType(d.data)?[d]:[]},labelishData:function(d){return this.isBarType(d)||this.isLineType(d)||this.isScatterType(d)||this.isBubbleType(d)||this.isCandlestickType(d)||this.isFunnelType(d)||this.isRadarType(d)||this.isTreemapType(d)?d.values.filter(function(v){return isNumber(v.value)||Boolean(v.value)}):[]},barLineBubbleData:function(d){return this.isBarType(d)||this.isLineType(d)||this.isBubbleType(d)?d.values:[]},isInterpolationType:function(type){return["basis","basis-closed","basis-open","bundle","cardinal","cardinal-closed","cardinal-open","catmull-rom","catmull-rom-closed","catmull-rom-open","linear","linear-closed","monotone-x","monotone-y","natural"].indexOf(type)>=0}};function getGroupedDataPointsFn(d){var fn,$$=this;return $$.isLineType(d)?fn=$$.generateGetLinePoints($$.getShapeIndices($$.isLineType)):$$.isBarType(d)&&(fn=$$.generateGetBarPoints($$.getShapeIndices($$.isBarType))),fn}var shape={getDrawShape:function(){var $$=this,isRotated=$$.config.axis_rotated,_a=$$.state,hasRadar=_a.hasRadar,hasTreemap=_a.hasTreemap,shape={type:{},indices:{},pos:{}};if(!hasTreemap&&["bar","candlestick","line","area"].forEach(function(v){var name=capitalize(/^(bubble|scatter)$/.test(v)?"line":v);if($$.hasType(v)||$$.hasTypeOf(name)||"line"===v&&($$.hasType("bubble")||$$.hasType("scatter"))){var indices=$$.getShapeIndices($$["is".concat(name,"Type")]),drawFn=$$["generateDraw".concat(name)];shape.indices[v]=indices,shape.type[v]=drawFn?drawFn.bind($$)(indices,!1):void 0}}),!$$.hasArcType()||hasRadar||hasTreemap){var cx=void 0,cy=void 0;hasTreemap||(cx=hasRadar?$$.radarCircleX:isRotated?$$.circleY:$$.circleX,cy=hasRadar?$$.radarCircleY:isRotated?$$.circleX:$$.circleY),shape.pos={xForText:$$.generateXYForText(shape.indices,!0),yForText:$$.generateXYForText(shape.indices,!1),cx:(cx||function(){}).bind($$),cy:(cy||function(){}).bind($$)}}return shape},getShapeIndices:function(typeFilter){var config=this.config,xs=config.data_xs,hasXs=notEmpty(xs),indices={},i=hasXs?{}:0;return hasXs&&getUnique(Object.keys(xs).map(function(v){return xs[v]})).forEach(function(v){i[v]=0,indices[v]={}}),this.filterTargetsToShow(this.data.targets.filter(typeFilter,this)).forEach(function(d){for(var _a,xKey=(d.id in xs?xs[d.id]:""),ind=xKey?indices[xKey]:indices,j=0,groups=void 0;groups=config.data_groups[j];j++)if(!(groups.indexOf(d.id)<0))for(var k=0,key=void 0;key=groups[k];k++){if(key in ind){ind[d.id]=ind[key];break}d.id!==key&&xKey&&(ind[key]=null!==(_a=ind[d.id])&&void 0!==_a?_a:i[xKey])}isUndefined(ind[d.id])&&(ind[d.id]=xKey?i[xKey]++:i++,ind.__max__=(xKey?i[xKey]:i)-1)}),indices},getIndices:function(indices,d,caller){var _a=this.config,xs=_a.data_xs,removeNull=_a.bar_indices_removeNull,id=d.id,index=d.index;if(this.isBarType(id)&&removeNull){var ind_1={};return this.getAllValuesOnIndex(index,!0).forEach(function(v,i){ind_1[v.id]=i,ind_1.__max__=i}),ind_1}return notEmpty(xs)?indices[xs[id]]:indices},getIndicesMax:function(indices){return notEmpty(this.config.data_xs)?Object.keys(indices).map(function(v){return indices[v].__max__||0}).reduce(function(acc,curr){return acc+curr}):indices.__max__},getShapeX:function(offset,indices,isSub){var $$=this,config=$$.config,scale=$$.scale,currScale=isSub?scale.subX:scale.zoom||scale.x,barOverlap=config.bar_overlap,barPadding=config.bar_padding,sum=function(p,c){return p+c},halfWidth=isObjectType(offset)&&(offset._$total.length?offset._$total.reduce(sum)/2:0);return function(d){var ind=$$.getIndices(indices,d,"getShapeX"),index=d.id in ind?ind[d.id]:0,targetsNum=(ind.__max__||0)+1,x=0;if(notEmpty(d.x)){var xPos=currScale(d.x,!0);if(halfWidth){var offsetWidth=offset[d.id]||offset._$width;x=barOverlap?xPos-offsetWidth/2:xPos-offsetWidth+offset._$total.slice(0,index+1).reduce(sum)-halfWidth}else x=xPos-(isNumber(offset)?offset:offset._$width)*(targetsNum/2-(barOverlap?1:index))}return offset&&x&&targetsNum>1&&barPadding&&(index&&(x+=barPadding*index),targetsNum>2?x-=(targetsNum-1)*barPadding/2:2===targetsNum&&(x-=barPadding/2)),x}},getShapeY:function(isSub){var $$=this,isStackNormalized=$$.isStackNormalized();return function(d){var value=d.value;return isNumber(d)?value=d:$$.isAreaRangeType(d)?value=$$.getBaseValue(d,"mid"):isStackNormalized?value=$$.getRatio("index",d,!0):$$.isBubbleZType(d)?value=$$.getBubbleZData(d.value,"y"):$$.isBarRangeType(d)&&(value=value[1]),$$.getYScaleById(d.id,isSub)(value)}},getShapeYMin:function(id){var axisId=this.axis.getId(id),yMin=this.scale[axisId].domain()[0],inverted=this.config["axis_".concat(axisId,"_inverted")];return!this.isGrouped(id)&&!inverted&&yMin>0?yMin:0},getShapeOffsetData:function(typeFilter){var $$=this,targets=$$.orderTargets($$.filterTargetsToShow($$.data.targets.filter(typeFilter,$$))),isStackNormalized=$$.isStackNormalized(),shapeOffsetTargets=targets.map(function(target){var rowValues=target.values,values={};$$.isStepType(target)&&(rowValues=$$.convertValuesToStep(rowValues));var rowValueMapByXValue=rowValues.reduce(function(out,d){var key=Number(d.x);return out[key]=d,values[key]=isStackNormalized?$$.getRatio("index",d,!0):d.value,out},{});return{id:target.id,rowValues,rowValueMapByXValue,values}}),indexMapByTargetId=targets.reduce(function(out,_a,index){return out[_a.id]=index,out},{});return{indexMapByTargetId,shapeOffsetTargets}},getShapeOffset:function(typeFilter,indices,isSub){var $$=this,_a=$$.getShapeOffsetData(typeFilter),shapeOffsetTargets=_a.shapeOffsetTargets,indexMapByTargetId=_a.indexMapByTargetId,groupsZeroAs=$$.config.data_groupsZeroAs;return function(d,idx){var id=d.id,value=d.value,x=d.x,ind=$$.getIndices(indices,d),scale=$$.getYScaleById(id,isSub);if($$.isBarRangeType(d))return scale(value[0]);var dataXAsNumber=Number(x),y0=scale("zero"===groupsZeroAs?0:$$.getShapeYMin(id)),offset=y0;return shapeOffsetTargets.filter(function(t){return t.id!==id&&ind[t.id]===ind[id]}).forEach(function(t){var tid=t.id,rowValueMapByXValue=t.rowValueMapByXValue,rowValues=t.rowValues,tvalues=t.values;if(indexMapByTargetId[tid]<indexMapByTargetId[id]){var rValue=tvalues[dataXAsNumber],row=rowValues[idx];if(row&&Number(row.x)===dataXAsNumber||(row=rowValueMapByXValue[dataXAsNumber]),(null==row?void 0:row.value)*value>=0&&isNumber(rValue))(0!==value||("positive"===groupsZeroAs&&rValue>0||"negative"===groupsZeroAs&&rValue<0))&&(offset+=scale(rValue)-y0)}}),offset}},circleY:function(d,i){var points,id=d.id;return this.isGrouped(id)&&(points=getGroupedDataPointsFn.bind(this)(d)),points?points(d,i)[0][1]:this.getYScaleById(id)(this.getBaseValue(d))},getBarW:function(type,axis,targetsNum){var _a,_b,_c,_d,_e,$$=this,config=$$.config,org=$$.org,scale=$$.scale,state=$$.state,maxDataCount=$$.getMaxDataCount(),isGrouped="bar"===type&&(null===(_a=config.data_groups)||void 0===_a?void 0:_a.length),configName="".concat(type,"_width"),k=(null!==(_c=null===(_b=$$.getZoomTransform)||void 0===_b?void 0:_b.call($$))&&void 0!==_c?_c:{k:1}).k,xMinMax=[null!==(_d=config.axis_x_min)&&void 0!==_d?_d:org.xDomain[0],null!==(_e=config.axis_x_max)&&void 0!==_e?_e:org.xDomain[1]].map($$.axis.isTimeSeries()?parseDate.bind($$):Number),tickInterval=axis.tickInterval(maxDataCount);if(scale.zoom&&!$$.axis.isCategorized()&&k>1){var isSameMinMax_1=xMinMax.every(function(v,i){return v===org.xDomain[i]});tickInterval=org.xDomain.map(function(v,i){var value=isSameMinMax_1?v:v-Math.abs(xMinMax[i]);return scale.zoom(value)}).reduce(function(a,c){return Math.abs(a)+c})/maxDataCount}var getWidth=function(id){var width=id?config[configName][id]:config[configName],ratio=id?width.ratio:config["".concat(configName,"_ratio")],max=id?width.max:config["".concat(configName,"_max")],w=isNumber(width)?width:isFunction(width)?width.call($$,state.width,targetsNum,maxDataCount):targetsNum?tickInterval*ratio/targetsNum:0;return max&&w>max?max:w},result=getWidth();return!isGrouped&&isObjectType(config[configName])&&(result={_$width:result,_$total:[]},$$.filterTargetsToShow($$.data.targets).forEach(function(v){config[configName][v.id]&&(result[v.id]=getWidth(v.id),result._$total.push(result[v.id]||result._$width))})),result},getShapeByIndex:function(shapeName,i,id){var $el=this.$el,suffix=isValue(i)?"-".concat(i):"",shape=$el[shapeName];return shape=shape&&!shape.empty()?shape.filter(function(d){return!id||d.id===id}).filter(function(d){return!isValue(i)||d.index===i}):(id?$el.main.selectAll(".".concat(CLASS["".concat(shapeName,"s")]).concat(this.getTargetSelectorSuffix(id))):$el.main).selectAll(".".concat(CLASS[shapeName]).concat(suffix))},isWithinShape:function(that,d){var _a,isWithin,$$=this,shape=src_select(that);return $$.isTargetToShow(d.id)?(null===(_a=$$.hasValidPointType)||void 0===_a?void 0:_a.call($$,that.nodeName))?isWithin=$$.isStepType(d)?$$.isWithinStep(that,$$.getYScaleById(d.id)($$.getBaseValue(d))):$$.isWithinCircle(that,$$.isBubbleType(d)?1.5*$$.pointSelectR(d):0):"path"===that.nodeName&&(isWithin=!shape.classed(CLASS.bar)||$$.isWithinBar(that)):isWithin=!1,isWithin},getInterpolate:function(d){var interpolation=this.getInterpolateType(d);return{basis:curve_basis,"basis-closed":curve_basisClosed,"basis-open":basisOpen,bundle,cardinal,"cardinal-closed":cardinalClosed,"cardinal-open":cardinalOpen,"catmull-rom":catmullRom,"catmull-rom-closed":catmullRomClosed,"catmull-rom-open":catmullRomOpen,"monotone-x":monotoneX,"monotone-y":monotoneY,natural,"linear-closed":linearClosed,linear:curve_linear,step,"step-after":stepAfter,"step-before":stepBefore}[interpolation]},getInterpolateType:function(d){var config=this.config,type=config.spline_interpolation_type,interpolation=this.isInterpolationType(type)?type:"cardinal";return this.isSplineType(d)?interpolation:this.isStepType(d)?config.line_step_type:"linear"},isWithinBar:function(that){var mouse=getPointer(this.state.event,that),list=getRectSegList(that),seg0=list[0],seg1=list[1],x=Math.min(seg0.x,seg1.x),y=Math.min(seg0.y,seg1.y),offset=this.config.bar_sensitivity,_a=getBBox(that,!0),ex=x+_a.width+offset,sy=y+_a.height+offset,ey=y-offset;return x-offset<mouse[0]&&mouse[0]<ex&&ey<mouse[1]&&mouse[1]<sy}},ChartInternal=function(){function ChartInternal(api){this.data={xs:{},targets:[]},this.scale={x:null,y:null,y2:null,subX:null,subY:null,subY2:null,zoom:null},this.org={xScale:null,xDomain:null},this.format={extraLineClasses:null,xAxisTick:null,dataTime:null,defaultAxisTime:null,axisTime:null};var $$=this;$$.api=api,$$.config=new Options,$$.cache=new Cache;var store=new Store;$$.$el=store.getStore("element"),$$.state=store.getStore("state"),$$.$T=$$.$T.bind($$)}return ChartInternal.prototype.$T=function(selection,force,name){var config=this.config,state=this.state,duration=config.transition_duration,subchart=config.subchart_show,t=selection;t&&("tagName"in t&&(t=src_select(t)),t=(!1!==force&&duration||force)&&(!state.zooming||state.dragging)&&!state.resizing&&state.rendered&&!subchart?t.transition(name).duration(duration):t);return t},ChartInternal.prototype.beforeInit=function(){this.callPluginHook("$beforeInit"),callFn(this.config.onbeforeinit,this.api)},ChartInternal.prototype.afterInit=function(){this.callPluginHook("$afterInit"),callFn(this.config.onafterinit,this.api)},ChartInternal.prototype.init=function(){var $$=this,config=$$.config,state=$$.state,$el=$$.$el,boost_useCssRule=config.boost_useCssRule,bindto=config.bindto;checkModuleImport($$);var hasArcType=$$.hasArcType();if(state.hasRadar=!state.hasAxis&&$$.hasType("radar"),state.hasFunnel=!state.hasAxis&&$$.hasType("funnel"),state.hasTreemap=!state.hasAxis&&$$.hasType("treemap"),state.hasAxis=!hasArcType&&!state.hasFunnel&&!state.hasTreemap,state.datetimeId="bb-".concat(+new Date*getRandom()),boost_useCssRule){var styleEl=doc.createElement("style");styleEl.type="text/css",doc.head.appendChild(styleEl),state.style={rootSelctor:".".concat(state.datetimeId),sheet:styleEl.sheet},$el.style=styleEl}var bindConfig={element:bindto,classname:"bb"};isObject(bindto)&&(bindConfig.element=bindto.element||"#chart",bindConfig.classname=bindto.classname||bindConfig.classname),$el.chart=isFunction(bindConfig.element.node)?bindto.element:src_select(bindConfig.element||[]),$el.chart.empty()&&($el.chart=src_select(doc.body.appendChild(doc.createElement("div")))),$el.chart.html("").classed(bindConfig.classname,!0).classed(state.datetimeId,boost_useCssRule).style("position","relative"),$$.initParams(),$$.initToRender()},ChartInternal.prototype.initToRender=function(forced){var $$=this,config=$$.config,state=$$.state,chart=$$.$el.chart,isHidden=function(){return function hasStyle(node,condition,all){void 0===all&&(all=!1);for(var isD3Node=!!node.node,has=!1,_i=0,_a=Object.entries(condition);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];if(has=isD3Node?node.style(key)===value:node.style[key]===value,!1===all&&has)break}return has}(chart,{display:"none",visibility:"hidden"})},isLazy=!1!==config.render.lazy&&(config.render.lazy||isHidden()),MutationObserver=win.MutationObserver;isLazy&&MutationObserver&&!1!==config.render.observe&&!forced&&new MutationObserver(function(mutation,observer){isHidden()||(observer.disconnect(),!state.rendered&&$$.initToRender(!0))}).observe(chart.node(),{attributes:!0,attributeFilter:["class","style"]}),isLazy&&!forced||$$.convertData(config,function(res){$$.initWithData(res),$$.afterInit()})},ChartInternal.prototype.initParams=function(){var _a,$$=this,config=$$.config,format=$$.format,state=$$.state;if($$.color=$$.generateColor(),$$.levelColor=$$.generateLevelColor(),!1===config.padding&&(config.axis_x_show=!1,config.axis_y_show=!1,config.axis_y2_show=!1,config.subchart_show=!1),($$.hasPointType()||(null===(_a=$$.hasLegendDefsPoint)||void 0===_a?void 0:_a.call($$)))&&($$.point=$$.generatePoint()),state.hasAxis){$$.initClip(),format.extraLineClasses=$$.generateExtraLineClass(),format.dataTime=config.data_xLocaltime?timeParse:utcParse,format.axisTime=config.axis_x_localtime?timeFormat:utcFormat;var isDragZoom_1=config.zoom_enabled&&"drag"===config.zoom_type;format.defaultAxisTime=function(d){var _a=$$.scale,x=_a.x,zoom=_a.zoom,isZoomed=isDragZoom_1?zoom:zoom&&x.orgDomain().toString()!==zoom.domain().toString(),specifier=(d.getMilliseconds()?".%L":d.getSeconds()&&".:%S")||d.getMinutes()&&"%I:%M"||d.getHours()&&"%I %p"||1!==d.getDate()&&"%b %d"||isZoomed&&1===d.getDate()&&"%b'%y"||d.getMonth()&&"%-m/%-d"||"%Y";return format.axisTime(specifier)(d)}}var legend_position=config.legend_position,legend_inset_anchor=config.legend_inset_anchor,axis_rotated=config.axis_rotated;state.isLegendRight="right"===legend_position,state.isLegendInset="inset"===legend_position,state.isLegendTop="top-left"===legend_inset_anchor||"top-right"===legend_inset_anchor,state.isLegendLeft="top-left"===legend_inset_anchor||"bottom-left"===legend_inset_anchor,state.rotatedPadding.top=$$.getResettedPadding(state.rotatedPadding.top),state.rotatedPadding.right=axis_rotated&&!config.axis_x_show?0:30,state.inputType=function convertInputType(mouse,touch){var DocumentTouch=win.DocumentTouch,matchMedia=win.matchMedia,navigator=win.navigator,hasPointerCoarse=null==matchMedia?void 0:matchMedia("(pointer:coarse)").matches,hasTouch=!1;if(touch)if(navigator&&"maxTouchPoints"in navigator)hasTouch=navigator.maxTouchPoints>0;else if("ontouchmove"in win||DocumentTouch&&doc instanceof DocumentTouch)hasTouch=!0;else if(hasPointerCoarse)hasTouch=!0;else{var UA=navigator.userAgent;hasTouch=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(UA)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(UA)}return(mouse&&!hasPointerCoarse&&(null==matchMedia?void 0:matchMedia("(pointer:fine)").matches)?"mouse":hasTouch&&"touch")||"mouse"}(config.interaction_inputType_mouse,config.interaction_inputType_touch)},ChartInternal.prototype.initWithData=function(data){var _a,_b,_c,$$=this,config=$$.config,scale=$$.scale,state=$$.state,$el=$$.$el,org=$$.org,hasAxis=state.hasAxis,hasFunnel=state.hasFunnel,hasTreemap=state.hasTreemap,hasInteraction=config.interaction_enabled,hasPolar=$$.hasType("polar"),labelsBGColor=config.data_labels_backgroundColors;if(hasAxis&&($$.axis=$$.getAxisInstance(),config.zoom_enabled&&$$.initZoom()),$$.data.xs={},$$.data.targets=$$.convertDataToTargets(data),config.data_filter&&($$.data.targets=$$.data.targets.filter(config.data_filter.bind($$.api))),config.data_hide&&$$.addHiddenTargetIds(!0===config.data_hide?$$.mapToIds($$.data.targets):config.data_hide),config.legend_hide&&$$.addHiddenLegendIds(!0===config.legend_hide?$$.mapToIds($$.data.targets):config.legend_hide),$$.updateSizes(),$$.updateScales(!0),hasAxis){var x=scale.x,y=scale.y,y2=scale.y2,subX=scale.subX,subY=scale.subY,subY2=scale.subY2;x&&(x.domain(sortValue($$.getXDomain($$.data.targets),!config.axis_x_inverted)),subX.domain(x.domain()),org.xDomain=x.domain()),y&&(y.domain($$.getYDomain($$.data.targets,"y")),subY.domain(y.domain())),y2&&(y2.domain($$.getYDomain($$.data.targets,"y2")),subY2&&subY2.domain(y2.domain()))}if($el.svg=$el.chart.append("svg").style("overflow","hidden").style("display","block"),hasInteraction&&state.inputType){var isTouch="touch"===state.inputType,onclick_1=config.onclick,onover=config.onover,onout=config.onout;$el.svg.on("click",(null==onclick_1?void 0:onclick_1.bind($$.api))||null).on(isTouch?"touchstart":"mouseenter",(null==onover?void 0:onover.bind($$.api))||null).on(isTouch?"touchend":"mouseleave",(null==onout?void 0:onout.bind($$.api))||null)}config.svg_classname&&$el.svg.attr("class",config.svg_classname);var hasColorPatterns=isFunction(config.color_tiles)&&$$.patterns;(hasAxis||hasColorPatterns||hasPolar||hasTreemap||labelsBGColor||(null===(_a=$$.hasLegendDefsPoint)||void 0===_a?void 0:_a.call($$)))&&($el.defs=$el.svg.append("defs"),hasAxis&&["id","idXAxis","idYAxis","idGrid"].forEach(function(v){$$.appendClip($el.defs,state.clip[v])}),$$.generateTextBGColorFilter(labelsBGColor),hasColorPatterns&&$$.patterns.forEach(function(p){return $el.defs.append(function(){return p.node})})),$$.updateSvgSize(),$$.bindResize();var main=$el.svg.append("g").classed($COMMON.main,!0).attr("transform",hasFunnel||hasTreemap?null:$$.getTranslate("main"));if($el.main=main,config.subchart_show&&$$.initSubchart(),config.tooltip_show&&$$.initTooltip(),config.title_text&&$$.initTitle(),!hasTreemap&&config.legend_show&&$$.initLegend(),config.data_empty_label_text&&main.append("text").attr("class","".concat($TEXT.text," ").concat($COMMON.empty)).attr("text-anchor","middle").attr("dominant-baseline","middle"),hasAxis&&(config.regions.length&&$$.initRegion(),!config.clipPath&&$$.axis.init()),main.append("g").classed($COMMON.chart,!0).attr("clip-path",hasAxis?state.clip.path:null),$$.callPluginHook("$init"),$$.initChartElements(),hasAxis&&(hasInteraction&&(null===(_b=$$.initEventRect)||void 0===_b||_b.call($$)),$$.initGrid(),config.clipPath&&(null===(_c=$$.axis)||void 0===_c||_c.init())),$$.updateTargets($$.data.targets),$$.updateDimension(),callFn(config.oninit,$$.api),$$.setBackground(),$$.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1,initializing:!0}),config.data_onmin||config.data_onmax){var minMax=$$.getMinMaxData();callFn(config.data_onmin,$$.api,minMax.min),callFn(config.data_onmax,$$.api,minMax.max)}config.tooltip_show&&$$.initShowTooltip(),state.rendered=!0},ChartInternal.prototype.initChartElements=function(){var $$=this,_a=$$.state,hasAxis=_a.hasAxis,hasRadar=_a.hasRadar,hasTreemap=_a.hasTreemap,types=[];if(hasAxis){var shapes=["bar","bubble","candlestick","line"];$$.config.bar_front&&shapes.push(shapes.shift());for(var _i=0,shapes_1=shapes;_i<shapes_1.length;_i++){var shape_1=shapes_1[_i],name_1=capitalize(shape_1);("line"===shape_1&&$$.hasTypeOf(name_1)||$$.hasType(shape_1))&&types.push(name_1)}}else if(hasTreemap)types.push("Treemap");else if($$.hasType("funnel"))types.push("Funnel");else{var hasPolar=$$.hasType("polar"),hasGauge=$$.hasType("gauge");hasRadar||types.push("Arc","Pie"),hasGauge?types.push("Gauge"):hasRadar?types.push("Radar"):hasPolar&&types.push("Polar")}for(var _b=0,types_1=types;_b<types_1.length;_b++){var type=types_1[_b];$$["init".concat(type)]()}notEmpty($$.config.data_labels)&&!$$.hasArcType(null,["radar"])&&$$.initText()},ChartInternal.prototype.setChartElements=function(){var _a=this.$el,chart=_a.chart,svg=_a.svg,defs=_a.defs,main=_a.main,tooltip=_a.tooltip,legend=_a.legend,title=_a.title,grid=_a.grid,needle=_a.needle,arc=_a.arcs,circles=_a.circle,bars=_a.bar,candlestick=_a.candlestick,lines=_a.line,areas=_a.area,texts=_a.text;this.api.$={chart,svg,defs,main,tooltip,legend,title,grid,arc,circles,bar:{bars},candlestick,line:{lines,areas},needle,text:{texts}}},ChartInternal.prototype.setBackground=function(){var bg=this.config.background,state=this.state,svg=this.$el.svg;if(notEmpty(bg)){var element=svg.select("g").insert(bg.imgUrl?"image":"rect",":first-child");bg.imgUrl?element.attr("href",bg.imgUrl):bg.color&&element.style("fill",bg.color).attr("clip-path",state.clip.path),element.attr("class",bg.class||null).attr("width","100%").attr("height","100%")}},ChartInternal.prototype.updateTargets=function(targets){var _a,_b,$$=this,_c=$$.state,hasAxis=_c.hasAxis,hasFunnel=_c.hasFunnel,hasRadar=_c.hasRadar,hasTreemap=_c.hasTreemap,helper=function(type){return $$["updateTargetsFor".concat(type)](targets.filter($$["is".concat(type,"Type")].bind($$)))};if($$.updateTargetsForText(targets),hasAxis){for(var _i=0,shapes_2=["bar","candlestick","line"];_i<shapes_2.length;_i++){var shape_2=shapes_2[_i],name_2=capitalize(shape_2);("line"===shape_2&&$$.hasTypeOf(name_2)||$$.hasType(shape_2))&&helper(name_2)}null===(_a=$$.updateTargetsForSubchart)||void 0===_a||_a.call($$,targets)}else if($$.hasArcType(targets)){var type="Arc";hasRadar?type="Radar":$$.hasType("polar")&&(type="Polar"),helper(type)}else hasFunnel?helper("Funnel"):hasTreemap&&helper("Treemap");var hasPointType=$$.hasType("bubble")||$$.hasType("scatter");hasPointType&&(null===(_b=$$.updateTargetForCircle)||void 0===_b||_b.call($$)),$$.filterTargetsToShowAtInit(hasPointType)},ChartInternal.prototype.filterTargetsToShowAtInit=function(hasPointType){void 0===hasPointType&&(hasPointType=!1);var $$=this,svg=$$.$el.svg,$T=$$.$T,selector=".".concat($COMMON.target);hasPointType&&(selector+=", .".concat($CIRCLE.chartCircles," > .").concat($CIRCLE.circles)),$T(svg.selectAll(selector).filter(function(d){return $$.isTargetToShow(d.id)})).style("opacity",null)},ChartInternal.prototype.getWithOption=function(options){for(var withOptions={Dimension:!0,EventRect:!0,Legend:!1,Subchart:!0,Transform:!1,Transition:!0,TrimXDomain:!0,UpdateXAxis:"UpdateXDomain",UpdateXDomain:!1,UpdateOrgXDomain:!1,TransitionForExit:"Transition",TransitionForAxis:"Transition",Y:!0},_i=0,_a=Object.entries(withOptions);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],defVal=_b[1],value=isString(defVal)?withOptions[defVal]:defVal;withOptions[key]=getOption(options,"with".concat(key),value)}return withOptions},ChartInternal.prototype.initialOpacity=function(d){var withoutFadeIn=this.state.withoutFadeIn;return null!==this.getBaseValue(d)&&withoutFadeIn[d.id]?null:"0"},ChartInternal.prototype.bindResize=function(){var $$=this,$el=$$.$el,config=$$.config,state=$$.state,resizeFunction=function generateResize(option){var timeout,fn=[],callResizeFn=function(){callResizeFn.clear(),!1===option?requestIdleCallback(function(){fn.forEach(function(f){return f()})},{timeout:200}):timeout=setTimeout$1(function(){fn.forEach(function(f){return f()})},isNumber(option)?option:200)};return callResizeFn.clear=function(){timeout&&(clearTimeout$1(timeout),timeout=null)},callResizeFn.add=function(f){return fn.push(f)},callResizeFn.remove=function(f){return fn.splice(fn.indexOf(f),1)},callResizeFn}(config.resize_timer),resize_auto=config.resize_auto,list=[];list.push(function(){return callFn(config.onresize,$$.api)}),/^(true|parent)$/.test(resize_auto)&&list.push(function(){state.resizing=!0,config.legend_show&&($$.updateSizes(),$$.updateLegend()),$$.api.flush(!1)}),list.push(function(){callFn(config.onresized,$$.api),state.resizing=!1}),list.forEach(function(v){return resizeFunction.add(v)}),$$.resizeFunction=resizeFunction,"parent"===resize_auto?($$.resizeFunction.resizeObserver=new ResizeObserver($$.resizeFunction.bind($$))).observe($el.chart.node().parentNode):win.addEventListener("resize",$$.resizeFunction)},ChartInternal.prototype.callPluginHook=function(phase){for(var _this=this,args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.config.plugins.forEach(function(v){"$beforeInit"===phase&&(v.$$=_this,_this.api.plugins.push(v)),v[phase].apply(v,args)})},ChartInternal}();function loadConfig(config){var target,keys,read,thisConfig=this.config,find=function(){var key=keys.shift();return key&&target&&isObjectType(target)&&key in target?(target=target[key],find()):key?void 0:target};Object.keys(thisConfig).forEach(function(key){target=config,keys=key.split("_"),read=find(),isDefined(read)&&(thisConfig[key]=read)}),this.api&&(this.state.orgConfig=config)}billboard_extend(ChartInternal.prototype,[dataConvert,data$1,dataLoad,{categoryName:function(i){var _a,axis_x_categories=this.config.axis_x_categories;return null!==(_a=null==axis_x_categories?void 0:axis_x_categories[i])&&void 0!==_a?_a:i}},classModule,billboard_color,domain,interaction,billboard_format,legend$1,redraw,scale,shape,billboard_size,billboard_style,billboard_text,title,tooltip$1,billboard_transform,typeInternals]);var apiChart={resize:function(size){var $$=this.internal,config=$$.config,state=$$.state;state.rendered&&(config.size_width=size?size.width:null,config.size_height=size?size.height:null,state.resizing=!0,this.flush(!1),$$.resizeFunction())},flush:function(soft){var _a,_b,$$=this.internal,state=$$.state,zoomResetBtn=$$.$el.zoomResetBtn;state.rendered?(state.resizing?null===(_a=$$.brush)||void 0===_a||_a.updateResize():null===(_b=$$.axis)||void 0===_b||_b.setOrient(),null==zoomResetBtn||zoomResetBtn.style("display","none"),$$.scale.zoom&&(state.current.zoomDomain=$$.scale.zoom.domain()),$$.scale.zoom=null,soft?$$.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withLegend:!0}):$$.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1}),!state.resizing&&$$.brush&&($$.brush.getSelection().call($$.brush.move),$$.unselectRect()),state.current.zoomDomain&&($$.api.zoom(state.current.zoomDomain),state.current.zoomDomain=null)):$$.initToRender(!0)},destroy:function(){var _a,_this=this,$$=this.internal,_b=$$.$el,chart=_b.chart,style=_b.style,svg=_b.svg;if(notEmpty($$))for(var key in $$.callPluginHook("$willDestroy"),$$.charts.splice($$.charts.indexOf(this),1),$$.unbindAllEvents(),svg.select("*").interrupt(),$$.resizeFunction.clear(),null===(_a=$$.resizeFunction.resizeObserver)||void 0===_a||_a.disconnect(),win.removeEventListener("resize",$$.resizeFunction),chart.classed("bb",!1).style("position",null).selectChildren().remove(),style&&style.parentNode.removeChild(style),Object.keys(this).forEach(function(key){"internal"===key&&Object.keys($$).forEach(function(k){$$[k]=null}),_this[key]=null,delete _this[key]}),this)this[key]=function(){};return null},config:function(name,value,redraw){var res,$$=this.internal,config=$$.config,state=$$.state,key=null==name?void 0:name.replace(/\./g,"_");return name&&key in config?isDefined(value)?(config[key]=value,res=value,redraw&&this.flush()):res=config[key]:(0===arguments.length||isEmpty(name))&&(res=state.orgConfig),res}},billboard_data=function(targetIds){var targets=this.internal.data.targets;if(!isUndefined(targetIds)){var ids_1=isArray(targetIds)?targetIds:[targetIds];return targets.filter(function(t){return ids_1.some(function(v){return v===t.id})})}return targets};billboard_extend(billboard_data,{shown:function(targetIds){return this.internal.filterTargetsToShow(this.data(targetIds))},values:function(targetIds,flat){void 0===flat&&(flat=!0);var values=null;if(targetIds){var targets=this.data(targetIds);isArray(targets)&&(values=[],targets.forEach(function(v){var dataValue=v.values.map(function(d){return d.value});flat?values=values.concat(dataValue):values.push(dataValue)}))}return values},names:function(names){return this.internal.updateDataAttributes("names",names)},colors:function(colors){return this.internal.updateDataAttributes("colors",colors)},axes:function(axes){return this.internal.updateDataAttributes("axes",axes)},min:function(){return this.internal.getMinMaxData().min},max:function(){return this.internal.getMinMaxData().max}});var apiData={data:billboard_data};function nodeToSvgDataUrl(node,option,orgSize){var _a=option||orgSize,width=_a.width,height=_a.height,serializer=new XMLSerializer,clone=node.cloneNode(!0),cssText=function getCssRules(styleSheets){var rules=[];return styleSheets.forEach(function(sheet){var _a;try{sheet.cssRules&&sheet.cssRules.length&&(rules=rules.concat(toArray(sheet.cssRules)))}catch(e){null===(_a=win.console)||void 0===_a||_a.warn("Error while reading rules from ".concat(sheet.href,": ").concat(e.toString()))}}),rules}(toArray(doc.styleSheets)).filter(function(r){return r.cssText}).map(function(r){return r.cssText});clone.setAttribute("xmlns",namespaces.xhtml),clone.style.margin="0",clone.style.padding="0",option.preserveFontStyle&&clone.querySelectorAll("text").forEach(function(t){t.innerHTML=""});var nodeXml=serializer.serializeToString(clone),style=doc.createElement("style");style.appendChild(doc.createTextNode(cssText.join("\n")));var styleXml=serializer.serializeToString(style),dataStr='<svg xmlns="'.concat(namespaces.svg,'" width="').concat(width,'" height="').concat(height,'" \n\t\tviewBox="0 0 ').concat(orgSize.width," ").concat(orgSize.height,'" \n\t\tpreserveAspectRatio="').concat(!1===(null==option?void 0:option.preserveAspectRatio)?"none":"xMinYMid meet",'">\n\t\t\t<foreignObject width="100%" height="100%">\n\t\t\t\t').concat(styleXml,"\n\t\t\t\t").concat(nodeXml.replace(/(url\()[^#]+/g,"$1"),"\n\t\t\t</foreignObject></svg>");return"data:image/svg+xml;base64,".concat(function(str){var _a;return null===(_a=win.btoa)||void 0===_a?void 0:_a.call(win,encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p){return String.fromCharCode(Number("0x".concat(p)))}))}(dataStr))}function getGlyph(svg){var _a=getBoundingRect(svg),left=_a.left,top=_a.top,filterFn=function(t){return t.textContent||t.childElementCount},glyph=[];return toArray(svg.querySelectorAll("text")).filter(filterFn).forEach(function(t){var getStyleFn=function(ts){var _a,_b=win.getComputedStyle(ts),fill=_b.fill,fontFamily=_b.fontFamily,fontSize=_b.fontSize,textAnchor=_b.textAnchor,transform=_b.transform,_c=function getCoords(elem,svgOffset){var top=svgOffset.top,left=svgOffset.left,_a=getBBox(elem,!0),x=_a.x,y=_a.y,_b=elem.getScreenCTM(),a=_b.a,b=_b.b,c=_b.c,d=_b.d,e=_b.e,f=_b.f,_c=getBoundingRect(elem,!0),width=_c.width,height=_c.height;return{x:a*x+c*y+e-left,y:b*x+d*y+f-top+(height-Math.round(height/4)),width,height}}(ts,{left,top}),x=_c.x,y=_c.y,width=_c.width,height=_c.height;return(_a={})[ts.textContent]={x,y,width,height,fill,fontFamily,fontSize,textAnchor,transform},_a};if(t.childElementCount>1){return toArray(t.querySelectorAll("tspan")).filter(filterFn).forEach(function(ts){glyph.push(getStyleFn(ts))}),[]}glyph.push(getStyleFn(t))}),glyph}var apiExport={export:function(option,callback){var _this=this,$$=this.internal,state=$$.state,_a=$$.$el,chart=_a.chart,svg=_a.svg,_b=state.current,width=_b.width,height=_b.height,opt=mergeObj(Object.create(null),{width,height,preserveAspectRatio:!0,preserveFontStyle:!1,mimeType:"image/png"},option),svgDataUrl=nodeToSvgDataUrl(chart.node(),opt,{width,height}),glyph=opt.preserveFontStyle?getGlyph(svg.node()):[];if(callback&&isFunction(callback)){var img_1=new Image;img_1.crossOrigin="Anonymous",img_1.onload=function(){var canvas=doc.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=opt.width||width,canvas.height=opt.height||height,ctx.drawImage(img_1,0,0),glyph.length&&(!function renderText(ctx,glyph){glyph.forEach(function(g){Object.keys(g).forEach(function(key){var _a=g[key],x=_a.x,y=_a.y,width=_a.width,height=_a.height,fill=_a.fill,fontFamily=_a.fontFamily,fontSize=_a.fontSize,transform=_a.transform;if(ctx.save(),ctx.font="".concat(fontSize," ").concat(fontFamily),ctx.fillStyle=fill,"none"===transform)ctx.fillText(key,x,y);else{var args=transform.replace(/(matrix|\(|\))/g,"").split(",");args.splice(4).every(function(v){return 0===+v})?(args.push(x+width-width/4),args.push(y-height+height/3)):(args.push(x),args.push(y)),ctx.transform.apply(ctx,args),ctx.fillText(key,0,0)}ctx.restore()})})}(ctx,glyph),glyph.length=0),callback.bind(_this)(canvas.toDataURL(opt.mimeType))},img_1.src=svgDataUrl}return svgDataUrl}},apiFocus={focus:function(targetIdsValue){var $$=this.internal,state=$$.state,targetIds=$$.mapToTargetIds(targetIdsValue),candidates=$$.$el.svg.selectAll($$.selectorTargets(targetIds.filter($$.isTargetToShow,$$)));this.revert(),this.defocus(),candidates.classed($FOCUS.focused,!0).classed($FOCUS.defocused,!1),$$.hasArcType()&&!state.hasRadar&&($$.expandArc(targetIds),$$.hasType("gauge")&&$$.markOverlapped(targetIdsValue,$$,".".concat($GAUGE.gaugeValue))),$$.toggleFocusLegend(targetIds,!0),state.focusedTargetIds=targetIds,state.defocusedTargetIds=state.defocusedTargetIds.filter(function(id){return targetIds.indexOf(id)<0})},defocus:function(targetIdsValue){var $$=this.internal,state=$$.state,targetIds=$$.mapToTargetIds(targetIdsValue);$$.$el.svg.selectAll($$.selectorTargets(targetIds.filter($$.isTargetToShow,$$))).classed($FOCUS.focused,!1).classed($FOCUS.defocused,!0),$$.hasArcType(null,["polar"])&&($$.unexpandArc(targetIds),$$.hasType("gauge")&&$$.undoMarkOverlapped($$,".".concat($GAUGE.gaugeValue))),$$.toggleFocusLegend(targetIds,!1),state.focusedTargetIds=state.focusedTargetIds.filter(function(id){return targetIds.indexOf(id)<0}),state.defocusedTargetIds=targetIds},revert:function(targetIdsValue){var $$=this.internal,config=$$.config,state=$$.state,$el=$$.$el,targetIds=$$.mapToTargetIds(targetIdsValue);$el.svg.selectAll($$.selectorTargets(targetIds)).classed($FOCUS.focused,!1).classed($FOCUS.defocused,!1),$$.hasArcType(null,["polar"])&&$$.unexpandArc(targetIds),config.legend_show&&($$.showLegend(targetIds.filter($$.isLegendToShow.bind($$))),$el.legend.selectAll($$.selectorLegends(targetIds)).filter(function(){return src_select(this).classed($FOCUS.legendItemFocused)}).classed($FOCUS.legendItemFocused,!1)),state.focusedTargetIds=[],state.defocusedTargetIds=[]}},apiLegend={legend:{show:function(targetIds){var $$=this.internal;$$.showLegend($$.mapToTargetIds(targetIds)),$$.updateAndRedraw({withLegend:!0})},hide:function(targetIds){var $$=this.internal;$$.hideLegend($$.mapToTargetIds(targetIds)),$$.updateAndRedraw({withLegend:!0})}}},apiLoad={load:function(args){var $$=this.internal,config=$$.config;args.xs&&$$.addXs(args.xs),"names"in args&&this.data.names(args.names),"classes"in args&&Object.keys(args.classes).forEach(function(id){config.data_classes[id]=args.classes[id]}),"categories"in args&&$$.axis.isCategorized()&&(config.axis_x_categories=args.categories),"axes"in args&&Object.keys(args.axes).forEach(function(id){config.data_axes[id]=args.axes[id]}),"colors"in args&&Object.keys(args.colors).forEach(function(id){config.data_colors[id]=args.colors[id]}),"unload"in args&&!1!==args.unload?$$.unload($$.mapToTargetIds(!0===args.unload?null:args.unload),function(){requestIdleCallback(function(){return $$.loadFromArgs(args)})}):$$.loadFromArgs(args)},unload:function(argsValue){var $$=this.internal,args=argsValue||{};isEmpty(args)&&this.tooltip.hide(),isArray(args)?args={ids:args}:isString(args)&&(args={ids:[args]});var ids=$$.mapToTargetIds(args.ids);$$.unload(ids,function(){$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),$$.cache.remove(ids),callDone.call($$,args.done,args.resizeAfter)})}};function showHide(show,targetIdsValue,options){var _this=this,$$=this.internal,targetIds=$$.mapToTargetIds(targetIdsValue),hiddenIds=$$.state.hiddenTargetIds.map(function(v){return targetIds.indexOf(v)>-1&&v}).filter(Boolean);$$.state.toggling=!0,$$["".concat(show?"remove":"add","HiddenTargetIds")](targetIds);var targets=$$.$el.svg.selectAll($$.selectorTargets(targetIds)),opacity=show?null:"0";show&&hiddenIds.length&&(targets.style("display",null),callFn($$.config.data_onshown,this,hiddenIds)),$$.$T(targets).style("opacity",opacity,"important").call(endall,function(){var _a;show||0!==hiddenIds.length||(targets.style("display","none"),callFn(null===(_a=$$.config)||void 0===_a?void 0:_a.data_onhidden,_this,targetIds)),targets.style("opacity",opacity)}),options.withLegend&&$$["".concat(show?"show":"hide","Legend")](targetIds),$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),$$.state.toggling=!1}var apiShow={show:function(targetIdsValue,options){void 0===options&&(options={}),showHide.call(this,!0,targetIdsValue,options)},hide:function(targetIdsValue,options){void 0===options&&(options={}),showHide.call(this,!1,targetIdsValue,options)},toggle:function(targetIds,options){var _this=this;void 0===options&&(options={});var $$=this.internal,targets={show:[],hide:[]};$$.mapToTargetIds(targetIds).forEach(function(id){return targets[$$.isTargetToShow(id)?"hide":"show"].push(id)}),targets.show.length&&this.show(targets.show,options),targets.hide.length&&setTimeout(function(){return _this.hide(targets.hide,options)},0)}},tooltip={show:function(args){var _a,_b,_c,index,mouse,$$=this.internal,$el=$$.$el,config=$$.config,_d=$$.state,eventReceiver=_d.eventReceiver,hasFunnel=_d.hasFunnel,hasTreemap=_d.hasTreemap,inputType=_d.inputType;if(args.mouse&&(mouse=args.mouse),args.data){var data=args.data,y=null===(_a=$$.getYScaleById(data.id))||void 0===_a?void 0:_a(data.value);if((hasFunnel||hasTreemap)&&data.id){var selector=$$.selectorTarget(data.id,void 0,".".concat($SHAPE.shape));eventReceiver.rect=$el.main.select(selector)}else $$.isMultipleX()?mouse=[$$.xx(data),y]:(config.tooltip_grouped||(mouse=[0,y]),index=null!==(_b=data.index)&&void 0!==_b?_b:$$.hasArcType()&&data.id?null===(_c=$$.getArcElementByIdOrIndex(data.id))||void 0===_c?void 0:_c.datum().index:$$.getIndexByX(data.x))}else isDefined(args.x)?index=$$.getIndexByX(args.x):isDefined(args.index)&&(index=args.index);("mouse"===inputType?["mouseover","mousemove"]:["touchstart"]).forEach(function(eventName){$$.dispatchEvent(eventName,index,mouse)})},hide:function(){var _a,_b,_c,$$=this.internal,inputType=$$.state.inputType,tooltip=$$.$el.tooltip,data=null==tooltip?void 0:tooltip.datum();if(data){var index_1=JSON.parse(data.current)[0].index;("mouse"===inputType?["mouseout"]:["touchend"]).forEach(function(eventName){$$.dispatchEvent(eventName,index_1)})}"touch"===inputType&&$$.callOverOutForTouch(),$$.hideTooltip(!0),null===(_a=$$.hideGridFocus)||void 0===_a||_a.call($$),null===(_b=$$.unexpandCircles)||void 0===_b||_b.call($$),null===(_c=$$.expandBarTypeShapes)||void 0===_c||_c.call($$,!1)}},apiTooltip={tooltip},Chart=function Chart(options){this.plugins=[];var $$=new ChartInternal(this);this.internal=$$,function bindThis(fn,target,argThis){Object.keys(fn).forEach(function(key){var isFunc=isFunction(fn[key]),isChild=target!==argThis,isNotNil=notEmpty(fn[key]),hasChild=isNotNil&&Object.keys(fn[key]).length>0;target[key]=isFunc&&(!isChild&&hasChild||isChild)?fn[key].bind(argThis):isNotNil&&!isFunc?{}:fn[key],hasChild&&bindThis(fn[key],target[key],argThis)})}(Chart.prototype,this,this),loadConfig.call($$,options),$$.beforeInit(),$$.init()};function setMinMax($$,type,value){var config=$$.config,helper=function(key,value){var v=isNumber(value)?value:!1===value?void 0:null;null!==v&&(config["axis_".concat(key,"_").concat(type)]=v)};isDefined(value)&&(isObjectType(value)?Object.keys(value).forEach(function(key){helper(key,value[key])}):(isNumber(value)||!1===value)&&["y","y2"].forEach(function(key){helper(key,value)}),$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))}function getMinMax($$,type){var config=$$.config;return{x:config["axis_x_".concat(type)],y:config["axis_y_".concat(type)],y2:config["axis_y2_".concat(type)]}}billboard_extend(Chart.prototype,[apiChart,{color:function(id){return this.internal.color(id)}},apiData,apiExport,apiFocus,apiLegend,apiLoad,apiShow,apiTooltip]);var axis$1={labels:function(labels){var labelText,$$=this.internal;return labels&&(Object.keys(labels).forEach(function(axisId){$$.axis.setLabelText(axisId,labels[axisId])}),$$.axis.updateLabels()),["x","y","y2"].forEach(function(v){var text=$$.axis.getLabelText(v);text&&(!labelText&&(labelText={}),labelText[v]=text)}),labelText},min:function(min){var $$=this.internal;return isValue(min)||!1===min?setMinMax($$,"min",min):getMinMax($$,"min")},max:function(max){var $$=this.internal;return isValue(max)||!1===max?setMinMax($$,"max",max):getMinMax($$,"max")},range:function(range){var axis=this.axis;if(!arguments.length)return{max:axis.max(),min:axis.min()};var min=range.min,max=range.max;isDefined(max)&&axis.max(max),isDefined(min)&&axis.min(min)}},apiAxis={axis:axis$1},apiCategory={category:function(i,category){var $$=this.internal,config=$$.config;return arguments.length>1&&(config.axis_x_categories[i]=category,$$.redraw()),config.axis_x_categories[i]},categories:function(categories){var $$=this.internal,config=$$.config;if(!categories||!Array.isArray(categories)){var cat=config.axis_x_categories;return isEmpty(cat)?Object.values($$.data.xs)[0]:cat}return config.axis_x_categories=categories,$$.redraw(),config.axis_x_categories}},apiFlow={flow:function(args){var data,$$=this.internal;(args.json||args.rows||args.columns)&&$$.convertData(args,function(res){data=res,function _(){var domain,diff,to,length=0,tail=0;if($$.state.redrawing||!data||!isTabVisible())return;var notfoundIds=[],orgDataCount=$$.getMaxDataCount(),targets=$$.convertDataToTargets(data,!0),isTimeSeries=$$.axis.isTimeSeries();$$.data.targets.forEach(function(t){for(var found=!1,i=0;i<targets.length;i++)if(t.id===targets[i].id){found=!0,t.values[t.values.length-1]&&(tail=t.values[t.values.length-1].index+1),length=targets[i].values.length;for(var j=0;j<length;j++)targets[i].values[j].index=tail+j,isTimeSeries||(targets[i].values[j].x=tail+j);t.values=t.values.concat(targets[i].values),targets.splice(i,1);break}!found&&notfoundIds.push(t.id)}),$$.data.targets.forEach(function(t){for(var i=0;i<notfoundIds.length;i++)if(t.id===notfoundIds[i]){tail=t.values[t.values.length-1].index+1;for(var j=0;j<length;j++)t.values.push({id:t.id,index:tail+j,x:isTimeSeries?$$.getOtherTargetX(tail+j):tail+j,value:null})}}),$$.data.targets.length&&targets.forEach(function(t){for(var missing=[],i=$$.data.targets[0].values[0].index;i<tail;i++)missing.push({id:t.id,index:i,x:isTimeSeries?$$.getOtherTargetX(i):i,value:null});t.values.forEach(function(v){v.index+=tail,isTimeSeries||(v.x+=tail)}),t.values=missing.concat(t.values)});$$.data.targets=$$.data.targets.concat(targets);var baseTarget=$$.data.targets[0],baseValue=baseTarget.values[0];isDefined(args.to)?(length=0,to=isTimeSeries?parseDate.call($$,args.to):args.to,baseTarget.values.forEach(function(v){v.x<to&&length++})):isDefined(args.length)&&(length=args.length);orgDataCount?1===orgDataCount&&isTimeSeries&&(diff=(baseTarget.values[baseTarget.values.length-1].x-baseValue.x)/2,domain=[new Date(+baseValue.x-diff),new Date(+baseValue.x+diff)]):(diff=isTimeSeries?baseTarget.values.length>1?baseTarget.values[baseTarget.values.length-1].x-baseValue.x:baseValue.x-$$.getXDomain($$.data.targets)[0]:1,domain=[baseValue.x-diff,baseValue.x]);domain&&$$.updateXDomain(null,!0,!0,!1,domain),$$.updateTargets($$.data.targets),$$.redraw({flow:{index:baseValue.index,length,duration:isValue(args.duration)?args.duration:$$.config.transition_duration,done:args.done,orgDataCount},withLegend:!0,withTransition:orgDataCount>1,withTrimXDomain:!1,withUpdateXAxis:!0})}()})}};function grid$1(grids,axisId){var $$=this.internal,config=$$.config,withTransition=config.transition_duration&&isTabVisible(),gridPropLines="grid_".concat(axisId,"_lines");return grids?(config[gridPropLines]=grids,$$.updateGrid(),$$.redrawGrid(withTransition),config[gridPropLines]):config[gridPropLines]}function add(grids,axisId){var gridPropLines="grid_".concat(axisId,"_lines");return grid$1.bind(this)(this.internal.config[gridPropLines].concat(grids||[]),axisId)}function billboard_remove(grids,isXAxis){this.internal.removeGridLines(grids,isXAxis)}var xgrids=function(grids){return grid$1.bind(this)(grids,"x")};billboard_extend(xgrids,{add:function(grids){return add.bind(this)(grids,"x")},remove:function(grids){return billboard_remove.bind(this)(grids,!0)}});var ygrids=function(grids){return grid$1.bind(this)(grids,"y")};billboard_extend(ygrids,{add:function(grids){return add.bind(this)(grids,"y")},remove:function(grids){return billboard_remove.bind(this)(grids,!1)}});var apiGrid={xgrids,ygrids},apiGroup={groups:function(groups){var $$=this.internal,config=$$.config;return isUndefined(groups)||(config.data_groups=groups,$$.redraw()),config.data_groups}};function regionsFn(regions,isAdd){void 0===isAdd&&(isAdd=!1);var $$=this.internal,config=$$.config,withTransition=config.transition_duration&&isTabVisible();return regions?(config.regions=isAdd?config.regions.concat(regions):regions,$$.updateRegion(),$$.redrawRegion(withTransition),isAdd?config.regions:regions):config.regions}var regions=function(regions){return regionsFn.bind(this)(regions)};billboard_extend(regions,{add:function(regions){return regionsFn.bind(this)(regions,!0)},remove:function(optionsValue){var $$=this.internal,config=$$.config,$T=$$.$T,options=optionsValue||{},classes=getOption(options,"classes",[$REGION.region]),regions=$$.$el.main.select(".".concat($REGION.regions)).selectAll(classes.map(function(c){return".".concat(c)}));return $T(regions).style("opacity","0").remove(),regions=config.regions,Object.keys(options).length?(regions=regions.filter(function(region){var found=!1;return!region.class||(region.class.split(" ").forEach(function(c){classes.indexOf(c)>=0&&(found=!0)}),!found)}),config.regions=regions):config.regions=[],regions}});var apiRegion={regions},apiX={x:function(x){var $$=this.internal,axis=$$.axis,data=$$.data,isCategorized=axis.isCustomX()&&axis.isCategorized();return isArray(x)&&(isCategorized?this.categories(x):($$.updateTargetX(data.targets,x),$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))),isCategorized?this.categories():data.xs},xs:function(xs){var $$=this.internal;return isObject(xs)&&($$.updateTargetXs($$.data.targets,xs),$$.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),$$.data.xs}},AxisRendererHelper=function(){function AxisRendererHelper(owner){this.charSize={};var scale=getScale(),config=owner.config,params=owner.params;this.owner=owner,this.config=config,this.scale=scale,!config.noTransition&&params.config.transition_duration||(config.withoutTransition=!0),config.range=this.scaleExtent((params.orgXScale||scale).range())}return AxisRendererHelper.prototype.getSizeFor1Char=function(orient,text,memoize){void 0===memoize&&(memoize=!0);var size={w:5.5,h:11.5};return this.charSize[orient]&&memoize?this.charSize[orient]:(!text.empty()&&text.text("0").call(function(el){try{var _a=getBBox(el.node(),!0),width=_a.width,height=_a.height;width&&height&&(size.w=width,size.h=height)}finally{el.text("")}}),this.charSize[orient]=size,size)},AxisRendererHelper.prototype.getTickTransformSetter=function(id){var config=this.config,fn="x"===id?function(value){return"translate(".concat(value+config.tickOffset,",0)")}:function(value){return"translate(0,".concat(value,")")};return function(selection,scale){selection.attr("transform",function(d){var x=scale(d);return isValue(d)?fn(x):null})}},AxisRendererHelper.prototype.scaleExtent=function(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]},AxisRendererHelper.prototype.generateTicks=function(scale,isYAxes){var tickStepSize=this.owner.params.tickStepSize,_a=scale.domain(),start=_a[0],end=_a[1],ticks=[];if(isYAxes&&tickStepSize)for(var interval=Math.round(start);interval<=end;)ticks.push(interval),interval+=tickStepSize;else if(scale.ticks){var tickArguments=this.config.tickArguments;if("log"!==scale.type||tickArguments)ticks=scale.ticks.apply(scale,this.config.tickArguments||[]);else{var s=getScale("_log").domain([start>0?start:1,end]).range(scale.range());ticks=s.ticks();for(var cnt=end.toFixed().length;ticks.length>15;cnt--)ticks=s.ticks(cnt);ticks.splice(0,1,start),ticks.splice(ticks.length-1,1,end)}ticks=ticks.map(function(v){return isString(v)&&isNumber(v)&&!isNaN(v)&&Math.round(10*v)/10||v})}return ticks},AxisRendererHelper.prototype.copyScale=function(){var newScale=this.scale.copy();return newScale.domain().length||newScale.domain(this.scale.domain()),newScale.type=this.scale.type,newScale},AxisRendererHelper.prototype.textFormatted=function(v){var tickFormat=this.config.tickFormat,value=/\d+\.\d+0{5,}\d$/.test(v)?+String(v).replace(/0+\d$/,""):v,formatted=tickFormat?tickFormat(value):value;return isDefined(formatted)?formatted:""},AxisRendererHelper.prototype.transitionise=function(selection){var config=this.config,transitionSelection=selection;if(config.withoutTransition)transitionSelection=selection.interrupt();else if(config.transition||!this.owner.params.noTransition)try{transitionSelection=selection.transition(config.transition)}catch(_a){}return transitionSelection},AxisRendererHelper}(),AxisRenderer=function(){function AxisRenderer(params){void 0===params&&(params={});var config={innerTickSize:6,outerTickSize:params.outerTick?6:0,orient:"bottom",range:[],tickArguments:null,tickCentered:null,tickCulling:!0,tickFormat:null,tickLength:9,tickOffset:0,tickPadding:3,tickValues:null,transition:null,noTransition:params.noTransition};config.tickLength=Math.max(config.innerTickSize,0)+config.tickPadding,this.config=config,this.params=params,this.helper=new AxisRendererHelper(this)}return AxisRenderer.prototype.create=function(g){var ctx=this,config=ctx.config,helper=ctx.helper,params=ctx.params,scale=helper.scale,orient=config.orient,splitTickText=this.splitTickText.bind(ctx),isLeftRight=/^(left|right)$/.test(orient),isTopBottom=/^(top|bottom)$/.test(orient),tickTransform=helper.getTickTransformSetter(isTopBottom?"x":"y"),axisPx=tickTransform===helper.axisX?"y":"x",sign=/^(top|left)$/.test(orient)?-1:1,rotate=params.tickTextRotate;this.config.range=scale.rangeExtent?scale.rangeExtent():helper.scaleExtent((params.orgXScale||scale).range());var $g,innerTickSize=config.innerTickSize,tickLength=config.tickLength,range=config.range,id=params.id,tickTextPos=id&&/^(x|y|y2)$/.test(id)?params.config["axis_".concat(id,"_tick_text_position")]:{x:0,y:0},prefix="subX"===id?"subchart_axis_x":"axis_".concat(id),axisShow=params.config["".concat(prefix,"_show")],tickShow_tick=!!axisShow&&params.config["".concat(prefix,"_tick_show")],tickShow_text=!!axisShow&&params.config["".concat(prefix,"_tick_text_show")],evalTextSize=params.config.axis_evalTextSize;g.each(function(){var g=src_select(this),scale0=this.__chart__||scale,scale1=helper.copyScale();$g=g,this.__chart__=scale1,config.tickOffset=params.isCategory?(scale1(1)-scale1(0))/2:0;var dx,path=g.selectAll(".domain").data([0]);if(path.enter().append("path").attr("class","domain").merge(path).attr("d",function(){var outerTickSized=config.outerTickSize*sign;return isTopBottom?"M".concat(range[0],",").concat(outerTickSized,"V0H").concat(range[1],"V").concat(outerTickSized):"M".concat(outerTickSized,",").concat(range[0],"H0V").concat(range[1],"H").concat(outerTickSized)}),tickShow_tick||tickShow_text){var ticks_1=config.tickValues||helper.generateTicks(scale1,isLeftRight||params.config.axis_rotated);ctx.generatedTicks=ticks_1;var tick=g.selectAll(".tick").data(ticks_1,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick"),tickExit=tick.exit().remove();tick=tickEnter.merge(tick),tickShow_tick&&tickEnter.append("line"),tickShow_text&&tickEnter.append("text");var tickText=tick.select("text"),counts_1=[],sizeFor1Char_1={w:0,h:0};isFunction(evalTextSize)&&(sizeFor1Char_1=evalTextSize.bind(ctx.params.owner.api)(tickText.node(),id),this.classList.contains($COMMON.dummy)&&(this.sizeFor1Char=sizeFor1Char_1)),sizeFor1Char_1&&0!==sizeFor1Char_1.w&&0!==sizeFor1Char_1.h||(sizeFor1Char_1=ctx.helper.getSizeFor1Char(orient,tickText,!!evalTextSize));var tspan=tickText.selectAll("tspan").data(function(d,index){var split=params.tickMultiline?splitTickText(d,scale1,ticks_1,isLeftRight,sizeFor1Char_1.w):isArray(helper.textFormatted(d))?helper.textFormatted(d).concat():[helper.textFormatted(d)];return counts_1[index]=split.length,split.map(function(splitted){return{index,splitted}})});tspan.exit().remove(),(tspan=tspan.enter().append("tspan").merge(tspan).text(function(d){return d.splitted})).attr("x",isTopBottom?0:tickLength*sign).attr("dx",(dx=0,/(top|bottom)/.test(orient)&&rotate&&(dx=8*Math.sin(Math.PI*(rotate/180))*("top"===orient?-1:1)),dx+(tickTextPos.x||0))).attr("dy",function(d,i){var dy=0;return"top"!==orient&&(dy=sizeFor1Char_1.h,0===i&&(dy=isLeftRight?-((counts_1[d.index]-1)*(sizeFor1Char_1.h/2)-3):0===tickTextPos.y?".71em":0)),isNumber(dy)&&tickTextPos.y?dy+tickTextPos.y:dy||".71em"});var lineUpdate=tick.select("line"),textUpdate=tick.select("text");if(tickEnter.select("line").attr("".concat(axisPx,"2"),innerTickSize*sign),tickEnter.select("text").attr(axisPx,tickLength*sign),ctx.setTickLineTextPosition(lineUpdate,textUpdate,sizeFor1Char_1),params.tickTitle){var title=textUpdate.select("title");(title.empty()?textUpdate.append("title"):title).text(function(index){return params.tickTitle[index]})}if(scale1.bandwidth){var x_1=scale1,dx_1=x_1.bandwidth()/2;scale1=scale0=function(d){return x_1(d)+dx_1}}else scale0.bandwidth?scale0=scale1:tickTransform(tickExit,scale1);tick=params.owner.state.flowing?helper.transitionise(tick):params.owner.$T(tick),tickTransform(tickEnter,scale0),tickTransform(tick.style("opacity",null),scale1)}}),this.g=$g},AxisRenderer.prototype.getGeneratedTicks=function(count){var _a,len=(null===(_a=this.generatedTicks)||void 0===_a?void 0:_a.length)-1,res=this.generatedTicks;if(len>count){var interval_1=Math.round(len/count+.1);res=this.generatedTicks.map(function(v,i){return i%interval_1===0?v:null}).filter(function(v){return null!==v}).splice(0,count)}return res},AxisRenderer.prototype.getTickXY=function(){var config=this.config,pos={x:0,y:0};return this.params.isCategory&&(pos.x=config.tickCentered?0:config.tickOffset,pos.y=config.tickCentered?config.tickOffset:0),pos},AxisRenderer.prototype.getTickSize=function(d){var scale=this.helper.scale,config=this.config,innerTickSize=config.innerTickSize,range=config.range,tickPosition=scale(d)+(config.tickCentered?0:config.tickOffset);return range[0]<tickPosition&&tickPosition<range[1]?innerTickSize:0},AxisRenderer.prototype.setTickLineTextPosition=function(lineUpdate,textUpdate,sizeFor1Char){var _this=this,tickPos=this.getTickXY(),_a=this.config,innerTickSize=_a.innerTickSize,orient=_a.orient,tickLength=_a.tickLength,tickOffset=_a.tickOffset,axisId=this.params.id,rotate=this.params.tickTextRotate,charHeight=sizeFor1Char.h/2-6,textAnchorForText=function(r){var value=["start","end"];return"top"===orient&&value.reverse(),r?value[r>0?0:1]:"middle"},textTransform=function(r){return r?"rotate(".concat(r,")"):null},yForText=function(r){return r?11.5-2.5*(r/("bottom"===orient?15:23))*(r>0?1:-1):tickLength},_b=this.params.owner.config,isRotated=_b.axis_rotated,inner=_b.axis_x_tick_text_inner,tickLineInner=this.params.config["axis_".concat(axisId,"_tick_inner")];switch(orient){case"bottom":lineUpdate.attr("x1",tickPos.x).attr("x2",tickPos.x).attr("y2",function(d){return _this.getTickSize.bind(_this)(d)*(tickLineInner?-1:1)}),textUpdate.attr("x",0).attr("y",yForText(rotate)).style("text-anchor",textAnchorForText(rotate)).style("text-anchor",function(d,i,_a){var length=_a.length;return isRotated||0!==i||!0!==inner&&!inner.first?isRotated||i!==length-1||!0!==inner&&!inner.last?textAnchorForText(rotate):"end":"start"}).attr("transform",textTransform(rotate));break;case"top":lineUpdate.attr("x2",0).attr("y2",tickLineInner?innerTickSize:-innerTickSize),textUpdate.attr("x",0).attr("y",-(yForText(rotate)+charHeight+6)).style("text-anchor",textAnchorForText(rotate)).attr("transform",textTransform(rotate));break;case"left":lineUpdate.attr("x2",tickLineInner?innerTickSize:-innerTickSize).attr("y1",tickPos.y).attr("y2",tickPos.y),textUpdate.attr("x",-tickLength).attr("y",tickOffset+(isRotated?charHeight/4:charHeight)).style("text-anchor","end");break;case"right":lineUpdate.attr("x2",tickLineInner?-innerTickSize:innerTickSize).attr("y2",0),textUpdate.attr("x",tickLength).attr("y",charHeight).style("text-anchor","start")}},AxisRenderer.prototype.splitTickText=function(d,scale,ticks,isLeftRight,charWidth){var params=this.params,tickText=this.helper.textFormatted(d),splitted=isString(tickText)&&tickText.indexOf("\n")>-1?tickText.split("\n"):[];if(splitted.length)return splitted;if(isArray(tickText))return tickText;var tickWidth=params.tickWidth;return(!tickWidth||tickWidth<=0)&&(tickWidth=isLeftRight?95:params.isCategory?(params.isInverted?scale(ticks[0])-scale(ticks[1]):scale(ticks[1])-scale(ticks[0]))-12:110),function split(splitted,text){for(var subtext,spaceIndex,textWidth,i=1;i<text.length;i++)if(" "===text.charAt(i)&&(spaceIndex=i),subtext=text.substr(0,i+1),textWidth=charWidth*subtext.length,tickWidth<textWidth)return split(splitted.concat(text.substr(0,spaceIndex||i)),text.slice(spaceIndex?spaceIndex+1:i));return splitted.concat(text)}(splitted,String(tickText))},AxisRenderer.prototype.scale=function(x){return arguments.length?(this.helper.scale=x,this):this.helper.scale},AxisRenderer.prototype.orient=function(x){return arguments.length?(this.config.orient=x in{top:1,right:1,bottom:1,left:1}?String(x):"bottom",this):this.config.orient},AxisRenderer.prototype.tickFormat=function(format){var config=this.config;return arguments.length?(config.tickFormat=format,this):config.tickFormat},AxisRenderer.prototype.tickCentered=function(isCentered){var config=this.config;return arguments.length?(config.tickCentered=isCentered,this):config.tickCentered},AxisRenderer.prototype.tickOffset=function(){return this.config.tickOffset},AxisRenderer.prototype.tickInterval=function(size){var _a,interval,_b=this.config,outerTickSize=_b.outerTickSize,tickOffset=_b.tickOffset,tickValues=_b.tickValues;if(this.params.isCategory)interval=2*tickOffset;else{var scale_1=null!==(_a=this.params.owner.scale.zoom)&&void 0!==_a?_a:this.helper.scale;interval=(this.g.select("path.domain").node().getTotalLength()-2*outerTickSize)/(size||this.g.selectAll("line").size());var intervalByValue=tickValues?tickValues.map(function(v,i,arr){var next=i+1;return next<arr.length?scale_1(arr[next])-scale_1(v):null}).filter(Boolean):[];interval=Math.min.apply(Math,__spreadArray(__spreadArray([],intervalByValue,!1),[interval],!1))}return interval===1/0?0:interval},AxisRenderer.prototype.ticks=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var config=this.config;return args.length?(config.tickArguments=toArray(args),this):config.tickArguments},AxisRenderer.prototype.tickCulling=function(culling){var config=this.config;return arguments.length?(config.tickCulling=culling,this):config.tickCulling},AxisRenderer.prototype.tickValues=function(x){var _this=this,config=this.config;if(isFunction(x))config.tickValues=function(){return x(_this.helper.scale.domain())};else{if(!arguments.length)return config.tickValues;config.tickValues=x}return this},AxisRenderer.prototype.setTransition=function(t){return this.config.transition=t,this},AxisRenderer}(),billboard_axis={getAxisInstance:function(){return this.axis||new Axis(this)}},Axis=function(){function Axis(owner){this.axesList={},this.tick={x:null,y:null,y2:null},this.xs=[],this.orient={x:"bottom",y:"left",y2:"right",subX:"bottom"},this.owner=owner,this.setOrient()}return Axis.prototype.getAxisClassName=function(id){return"".concat($AXIS.axis," ").concat($AXIS["axis".concat(capitalize(id))])},Axis.prototype.isHorizontal=function($$,forHorizontal){var isRotated=$$.config.axis_rotated;return forHorizontal?isRotated:!isRotated},Axis.prototype.isCategorized=function(){var _a=this.owner,config=_a.config,state=_a.state;return config.axis_x_type.indexOf("category")>=0||state.hasRadar},Axis.prototype.isCustomX=function(){var config=this.owner.config;return!this.isTimeSeries()&&(config.data_x||notEmpty(config.data_xs))},Axis.prototype.isTimeSeries=function(id){return void 0===id&&(id="x"),"timeseries"===this.owner.config["axis_".concat(id,"_type")]},Axis.prototype.isLog=function(id){return void 0===id&&(id="x"),"log"===this.owner.config["axis_".concat(id,"_type")]},Axis.prototype.isTimeSeriesY=function(){return this.isTimeSeries("y")},Axis.prototype.getAxisType=function(id){void 0===id&&(id="x");var type="linear";return this.isTimeSeries(id)?type=this.owner.config.axis_x_localtime?"time":"utc":this.isLog(id)&&(type="log"),type},Axis.prototype.getExtent=function(){var $$=this.owner,config=$$.config,scale=$$.scale,extent=config.axis_x_extent;if(extent)if(isFunction(extent))extent=extent.bind($$.api)($$.getXDomain($$.data.targets),scale.subX);else if(this.isTimeSeries()&&extent.every(isNaN)){var fn_1=parseDate.bind($$);extent=extent.map(function(v){return scale.subX(fn_1(v))})}return extent},Axis.prototype.init=function(){var _this=this,$$=this.owner,config=$$.config,_a=$$.$el,main=_a.main,axis=_a.axis,clip=$$.state.clip,target=["x","y"];config.axis_y2_show&&target.push("y2"),target.forEach(function(v){var classAxis=_this.getAxisClassName(v);axis[v]=main.append("g").attr("class",classAxis).attr("clip-path",function(){var res=null;return"x"===v?res=clip.pathXAxis:"y"===v&&(res=clip.pathYAxis),res}).attr("transform",$$.getTranslate(v)).style("visibility",config["axis_".concat(v,"_show")]?null:"hidden"),_this.generateAxes(v)})},Axis.prototype.setOrient=function(){var _a=this.owner.config,isRotated=_a.axis_rotated,yInner=_a.axis_y_inner,y2Inner=_a.axis_y2_inner;this.orient={x:isRotated?"left":"bottom",y:isRotated?yInner?"top":"bottom":yInner?"right":"left",y2:isRotated?y2Inner?"bottom":"top":y2Inner?"left":"right",subX:isRotated?"left":"bottom"}},Axis.prototype.generateAxes=function(id){var d3Axis,$$=this.owner,config=$$.config,axes=[],axesConfig=config["axis_".concat(id,"_axes")],isRotated=config.axis_rotated;"x"===id?d3Axis=isRotated?axisLeft:axisBottom:"y"===id?d3Axis=isRotated?axisBottom:axisLeft:"y2"===id&&(d3Axis=isRotated?axisTop:axisRight),axesConfig.length&&axesConfig.forEach(function(v){var tick=v.tick||{},scale=$$.scale[id].copy();v.domain&&scale.domain(v.domain),axes.push(d3Axis(scale).ticks(tick.count).tickFormat(isFunction(tick.format)?tick.format.bind($$.api):function(x){return x}).tickValues(tick.values).tickSizeOuter(!1===tick.outer?0:6))}),this.axesList[id]=axes},Axis.prototype.updateAxes=function(){var _this=this,$$=this.owner,config=$$.config,main=$$.$el.main,$T=$$.$T;Object.keys(this.axesList).forEach(function(id){var axesConfig=config["axis_".concat(id,"_axes")],scale=$$.scale[id].copy(),range=scale.range();_this.axesList[id].forEach(function(v,i){var axisRange=v.scale().range();range.every(function(v,i){return v===axisRange[i]})||v.scale().range(range);var className="".concat(_this.getAxisClassName(id),"-").concat(i+1),g=main.select(".".concat(className.replace(/\s/,".")));g.empty()?g=main.append("g").attr("class",className).style("visibility",config["axis_".concat(id,"_show")]?null:"hidden").call(v):(axesConfig[i].domain&&scale.domain(axesConfig[i].domain),$T(g).call(v.scale(scale))),g.attr("transform",$$.getTranslate(id,i+1))})})},Axis.prototype.setAxis=function(id,scale,outerTick,noTransition){var $$=this.owner;"subX"!==id&&(this.tick[id]=this.getTickValues(id)),this[id]=this.getAxis(id,scale,outerTick,!("x"!==id||!($$.scale.zoom||$$.config.subchart_show||$$.state.resizing))||noTransition)},Axis.prototype.getAxis=function(id,scale,outerTick,noTransition,noTickTextRotate){var tickFormat,$$=this.owner,config=$$.config,isX=/^(x|subX)$/.test(id),type=isX?"x":id,isCategory=isX&&this.isCategorized(),orient=this.orient[id],tickTextRotate=noTickTextRotate?0:$$.getAxisTickRotate(type);if(isX)tickFormat="subX"===id?$$.format.subXAxisTick:$$.format.xAxisTick;else{var fn=config["axis_".concat(id,"_tick_format")];isFunction(fn)&&(tickFormat=fn.bind($$.api))}var tickValues=this.tick[type],axisParams=mergeObj({outerTick,noTransition,config,id,tickTextRotate,owner:$$},isX&&{isCategory,isInverted:config.axis_x_inverted,tickMultiline:config.axis_x_tick_multiline,tickWidth:config.axis_x_tick_width,tickTitle:isCategory&&config.axis_x_tick_tooltip&&$$.api.categories(),orgXScale:$$.scale.x});isX||(axisParams.tickStepSize=config["axis_".concat(type,"_tick_stepSize")]);var axis=new AxisRenderer(axisParams).scale(isX&&$$.scale.zoom||scale).orient(orient);if(isX&&this.isTimeSeries()&&tickValues&&!isFunction(tickValues)){var fn_2=parseDate.bind($$);tickValues=tickValues.map(function(v){return fn_2(v)})}else!isX&&this.isTimeSeriesY()&&(axis.ticks(config.axis_y_tick_time_value),tickValues=null);tickValues&&axis.tickValues(tickValues),axis.tickFormat(tickFormat||!isX&&$$.isStackNormalized()&&function(x){return"".concat(x,"%")}),isCategory&&(axis.tickCentered(config.axis_x_tick_centered),isEmpty(config.axis_x_tick_culling)&&(config.axis_x_tick_culling=!1));var tickCount=config["axis_".concat(type,"_tick_count")];return tickCount&&axis.ticks(tickCount),axis},Axis.prototype.updateXAxisTickValues=function(targets,axis){var _a,values,$$=this.owner,config=$$.config,fit=config.axis_x_tick_fit,count=config.axis_x_tick_count;return(fit||count&&fit)&&(values=$$.mapTargetsToUniqueXs(targets),this.isCategorized()&&count>values.length&&(count=values.length),values=this.generateTickValues(values,count,this.isTimeSeries())),axis?axis.tickValues(values):this.x&&(this.x.tickValues(values),null===(_a=this.subX)||void 0===_a||_a.tickValues(values)),values},Axis.prototype.getId=function(id){var _a=this.owner,config=_a.config,scale=_a.scale,axis=config.data_axes[id];return axis&&scale[axis]||(axis="y"),axis},Axis.prototype.getXAxisTickFormat=function(forSubchart){var currFormat,$$=this.owner,config=$$.config,format=$$.format,tickFormat=forSubchart&&config.subchart_axis_x_tick_format||config.axis_x_tick_format,isTimeSeries=this.isTimeSeries(),isCategorized=this.isCategorized();return tickFormat?isFunction(tickFormat)?currFormat=tickFormat.bind($$.api):isTimeSeries&&(currFormat=function(date){return date?format.axisTime(tickFormat)(date):""}):currFormat=isTimeSeries?format.defaultAxisTime:isCategorized?$$.categoryName:function(v){return v<0?v.toFixed(0):v},isFunction(currFormat)?function(v){return currFormat.apply($$,isCategorized?[v,$$.categoryName(v)]:[v])}:currFormat},Axis.prototype.getTickValues=function(id){var $$=this.owner,tickValues=$$.config["axis_".concat(id,"_tick_values")],axis=$$["".concat(id,"Axis")];return(isFunction(tickValues)?tickValues.call($$.api):tickValues)||(axis?axis.tickValues():void 0)},Axis.prototype.getLabelOptionByAxisId=function(id){return this.owner.config["axis_".concat(id,"_label")]},Axis.prototype.getLabelText=function(id){var option=this.getLabelOptionByAxisId(id);return isString(option)?option:option?option.text:null},Axis.prototype.setLabelText=function(id,text){var config=this.owner.config,option=this.getLabelOptionByAxisId(id);isString(option)?config["axis_".concat(id,"_label")]=text:option&&(option.text=text)},Axis.prototype.getLabelPosition=function(id,defaultPosition){var isRotated=this.owner.config.axis_rotated,option=this.getLabelOptionByAxisId(id),position=isObjectType(option)&&option.position?option.position:defaultPosition[+!isRotated],has=function(v){return!!~position.indexOf(v)};return{isInner:has("inner"),isOuter:has("outer"),isLeft:has("left"),isCenter:has("center"),isRight:has("right"),isTop:has("top"),isMiddle:has("middle"),isBottom:has("bottom")}},Axis.prototype.getAxisLabelPosition=function(id){return this.getLabelPosition(id,"x"===id?["inner-top","inner-right"]:["inner-right","inner-top"])},Axis.prototype.getLabelPositionById=function(id){return this.getAxisLabelPosition(id)},Axis.prototype.xForAxisLabel=function(id){var $$=this.owner,_a=$$.state,width=_a.width,height=_a.height,position=this.getAxisLabelPosition(id),x=position.isMiddle?-height/2:0;return this.isHorizontal($$,"x"!==id)?x=position.isLeft?0:position.isCenter?width/2:width:position.isBottom&&(x=-height),x},Axis.prototype.textAnchorForAxisLabel=function(id){var $$=this.owner,position=this.getAxisLabelPosition(id),anchor=position.isMiddle?"middle":"end";return this.isHorizontal($$,"x"!==id)?anchor=position.isLeft?"start":position.isCenter?"middle":"end":position.isBottom&&(anchor="start"),anchor},Axis.prototype.dxForAxisLabel=function(id){var $$=this.owner,position=this.getAxisLabelPosition(id),dx=position.isBottom?"0.5em":"0";return this.isHorizontal($$,"x"!==id)?dx=position.isLeft?"0.5em":position.isRight?"-0.5em":"0":position.isTop&&(dx="-0.5em"),dx},Axis.prototype.dyForAxisLabel=function(id){var dy,$$=this.owner,config=$$.config,isRotated=config.axis_rotated,isInner=this.getAxisLabelPosition(id).isInner,tickRotate=config["axis_".concat(id,"_tick_rotate")]?$$.getHorizontalAxisHeight(id):0,maxTickWidth=this.getMaxTickSize(id).width;if("x"===id){var xHeight=config.axis_x_height;dy=isRotated?isInner?"1.2em":-25-maxTickWidth:isInner?"-0.5em":xHeight?xHeight-10:tickRotate?tickRotate-10:"3em"}else dy={y:["-0.5em",10,"3em","1.2em",10],y2:["1.2em",-20,"-2.2em","-0.5em",15]}[id],dy=isRotated?isInner?dy[0]:tickRotate?tickRotate*("y2"===id?-1:1)-dy[1]:dy[2]:isInner?dy[3]:(dy[4]+(config["axis_".concat(id,"_inner")]?0:maxTickWidth+dy[4]))*("y"===id?-1:1);return dy},Axis.prototype.getMaxTickSize=function(id,withoutRecompute){var $$=this.owner,config=$$.config,_a=$$.state,current=_a.current,resizing=_a.resizing,_b=$$.$el,svg=_b.svg,chart=_b.chart,currentTickMax=current.maxTickSize[id],configPrefix="axis_".concat(id),max={width:0,height:0};if(resizing||withoutRecompute||!config["".concat(configPrefix,"_show")]||currentTickMax.width>0&&0===$$.filterTargetsToShow().length)return currentTickMax;if(svg){var isYAxis_1=/^y2?$/.test(id),targetsToShow=$$.filterTargetsToShow($$.data.targets),scale=$$.scale[id].copy().domain($$["get".concat(isYAxis_1?"Y":"X","Domain")](targetsToShow,id)),domain=scale.domain(),isDomainSame=domain[0]===domain[1]&&domain.every(function(v){return v>0}),isCurrentMaxTickDomainSame=isArray(currentTickMax.domain)&&currentTickMax.domain[0]===currentTickMax.domain[1]&&currentTickMax.domain.every(function(v){return v>0});if(isDomainSame||isCurrentMaxTickDomainSame)return currentTickMax.size;currentTickMax.domain=domain,isYAxis_1||currentTickMax.ticks.splice(0);var axis=this.getAxis(id,scale,!1,!1,!0),tickRotate=config["".concat(configPrefix,"_tick_rotate")],tickCount=config["".concat(configPrefix,"_tick_count")];!config["".concat(configPrefix,"_tick_values")]&&tickCount&&axis.tickValues(this.generateTickValues(domain,tickCount,isYAxis_1?this.isTimeSeriesY():this.isTimeSeries())),!isYAxis_1&&this.updateXAxisTickValues(targetsToShow,axis);var dummy=chart.append("svg").style("visibility","hidden").style("position","fixed").style("top","0").style("left","0"),g=dummy.append("g").attr("class","".concat($AXIS["axis".concat(capitalize(id))]," ").concat($COMMON.dummy));axis.create(g);var sizeFor1Char_1=g.node().sizeFor1Char;dummy.selectAll("text").attr("transform",isNumber(tickRotate)?"rotate(".concat(tickRotate,")"):null).each(function(d,i){var _a=sizeFor1Char_1?{width:this.textContent.length*sizeFor1Char_1.w,height:sizeFor1Char_1.h}:getBoundingRect(this,!0),width=_a.width,height=_a.height;max.width=Math.max(max.width,width),max.height=Math.max(max.height,height),isYAxis_1||(currentTickMax.ticks[i]=width)}),dummy.remove()}return Object.keys(max).forEach(function(key){max[key]>0&&(currentTickMax[key]=max[key])}),currentTickMax},Axis.prototype.getXAxisTickTextY2Overflow=function(defaultPadding){var $$=this.owner,axis=$$.axis,config=$$.config,_a=$$.state,current=_a.current,isLegendRight=_a.isLegendRight,legendItemWidth=_a.legendItemWidth,xAxisTickRotate=$$.getAxisTickRotate("x"),positiveRotation=xAxisTickRotate>0&&xAxisTickRotate<90;if((axis.isCategorized()||axis.isTimeSeries())&&config.axis_x_tick_fit&&(!config.axis_x_tick_culling||isEmpty(config.axis_x_tick_culling))&&!config.axis_x_tick_multiline&&positiveRotation){var y2AxisWidth=config.axis_y2_show&&current.maxTickSize.y2.width||0,legendWidth=isLegendRight&&legendItemWidth||0,widthWithoutCurrentPaddingLeft=current.width-$$.getCurrentPaddingByDirection("left"),maxOverflow=this.getXAxisTickMaxOverflow(xAxisTickRotate,widthWithoutCurrentPaddingLeft-defaultPadding)-y2AxisWidth-legendWidth,xAxisTickTextY2Overflow=Math.max(0,maxOverflow)+defaultPadding;return Math.min(xAxisTickTextY2Overflow,widthWithoutCurrentPaddingLeft/2)}return 0},Axis.prototype.getXAxisTickMaxOverflow=function(xAxisTickRotate,widthWithoutCurrentPaddingLeft){for(var $$=this.owner,axis=$$.axis,config=$$.config,state=$$.state,isTimeSeries=axis.isTimeSeries(),tickTextWidths=state.current.maxTickSize.x.ticks,tickCount=tickTextWidths.length,_a=state.axis.x.padding,left=_a.left,right=_a.right,maxOverflow=0,remaining=tickCount-(isTimeSeries&&config.axis_x_tick_fit?.5:0),i=0;i<tickCount;i++){var tickIndex=i+1,rotatedTickTextWidth=Math.cos(Math.PI*xAxisTickRotate/180)*tickTextWidths[i],ticksBeforeTickText=tickIndex-(isTimeSeries?1:.5)+left;if(!(ticksBeforeTickText<=0)){var tickLength=(widthWithoutCurrentPaddingLeft-rotatedTickTextWidth)/ticksBeforeTickText,overflow=rotatedTickTextWidth-tickLength/2-((remaining-tickIndex)*tickLength+right*tickLength);maxOverflow=Math.max(maxOverflow,overflow)}}var filteredTargets=$$.filterTargetsToShow($$.data.targets),tickOffset=0;if(!isTimeSeries&&config.axis_x_tick_count<=filteredTargets.length&&filteredTargets[0].values.length){var scale=getScale($$.axis.getAxisType("x"),0,widthWithoutCurrentPaddingLeft-maxOverflow).domain([-1*left,$$.getXDomainMax($$.data.targets)+1+right]);tickOffset=(scale(1)-scale(0))/2}return maxOverflow+tickOffset},Axis.prototype.updateLabels=function(withTransition){var _this=this,$$=this.owner,config=$$.config,main=$$.$el.main,$T=$$.$T,isRotated=config.axis_rotated;["x","y","y2"].forEach(function(id){var text=_this.getLabelText(id),selector="axis".concat(capitalize(id)),classLabel=$AXIS["".concat(selector,"Label")];if(text){var axisLabel=main.select("text.".concat(classLabel));axisLabel.empty()&&(axisLabel=main.select("g.".concat($AXIS[selector])).insert("text",":first-child").attr("class",classLabel).attr("transform",["rotate(-90)",null]["x"===id?+!isRotated:+isRotated]).style("text-anchor",function(){return _this.textAnchorForAxisLabel(id)})),$T(axisLabel,withTransition).attr("x",function(){return _this.xForAxisLabel(id)}).attr("dx",function(){return _this.dxForAxisLabel(id)}).attr("dy",function(){return _this.dyForAxisLabel(id)}).text(text)}})},Axis.prototype.getPadding=function(padding,key,defaultValue,domainLength){var p=isNumber(padding)?padding:padding[key];return isValue(p)?this.owner.convertPixelToScale(/(bottom|top)/.test(key)?"y":"x",p,domainLength):defaultValue},Axis.prototype.generateTickValues=function(values,tickCount,forTimeSeries){var tickValues=values;if(tickCount){var targetCount=isFunction(tickCount)?tickCount():tickCount;if(1===targetCount)tickValues=[values[0]];else if(2===targetCount)tickValues=[values[0],values[values.length-1]];else if(targetCount>2){var isCategorized=this.isCategorized(),count=targetCount-2,start=values[0],end=values[values.length-1],interval=(end-start)/(count+1),tickValue=void 0;tickValues=[start];for(var i=0;i<count;i++)tickValue=+start+interval*(i+1),tickValues.push(forTimeSeries?new Date(tickValue):isCategorized?Math.round(tickValue):tickValue);tickValues.push(end)}}return forTimeSeries||(tickValues=tickValues.sort(function(a,b){return a-b})),tickValues},Axis.prototype.generateTransitions=function(withTransition){var $$=this.owner,axis=$$.$el.axis,$T=$$.$T,_a=["x","y","y2","subX"].map(function(v){return $T(axis[v],withTransition)});return{axisX:_a[0],axisY:_a[1],axisY2:_a[2],axisSubX:_a[3]}},Axis.prototype.redraw=function(transitions,isHidden,isInit){var _this=this,$$=this.owner,config=$$.config,state=$$.state,$el=$$.$el,opacity=isHidden?"0":null;["x","y","y2","subX"].forEach(function(id){var axis=_this[id],$axis=$el.axis[id];axis&&$axis&&(isInit||config.transition_duration||(axis.config.withoutTransition=!0),$axis.style("opacity",opacity),axis.create(transitions["axis".concat(capitalize(id))]))}),this.updateAxes(),!state.rendered&&config.axis_tooltip&&this.setAxisTooltip()},Axis.prototype.redrawAxis=function(targetsToShow,wth,transitions,flow,isInit){var _a,_b,_c,xDomainForZoom,_this=this,$$=this.owner,config=$$.config,scale=$$.scale,$el=$$.$el,hasZoom=!!scale.zoom;!hasZoom&&this.isCategorized()&&0===targetsToShow.length&&scale.x.domain([0,$el.axis.x.selectAll(".tick").size()]),scale.x&&targetsToShow.length?(!hasZoom&&$$.updateXDomain(targetsToShow,wth.UpdateXDomain,wth.UpdateOrgXDomain,wth.TrimXDomain),config.axis_x_tick_values||this.updateXAxisTickValues(targetsToShow)):this.x&&(this.x.tickValues([]),null===(_a=this.subX)||void 0===_a||_a.tickValues([])),config.zoom_rescale&&!flow&&(xDomainForZoom=scale.x.orgDomain()),["y","y2"].forEach(function(key){var prefix="axis_".concat(key,"_"),axisScale=scale[key];if(axisScale){var tickValues=config["".concat(prefix,"tick_values")],tickCount=config["".concat(prefix,"tick_count")];if(axisScale.domain($$.getYDomain(targetsToShow,key,xDomainForZoom)),!tickValues&&tickCount){var axis=$$.axis[key],domain=axisScale.domain();axis.tickValues(_this.generateTickValues(domain,domain.every(function(v){return 0===v})?1:tickCount,_this.isTimeSeriesY()))}}}),this.redraw(transitions,$$.hasArcType(),isInit),this.updateLabels(wth.Transition),(wth.UpdateXDomain||wth.UpdateXAxis||wth.Y)&&targetsToShow.length&&this.setCulling(),wth.Y&&(null===(_b=scale.subY)||void 0===_b||_b.domain($$.getYDomain(targetsToShow,"y")),null===(_c=scale.subY2)||void 0===_c||_c.domain($$.getYDomain(targetsToShow,"y2")))},Axis.prototype.setCulling=function(){var $$=this.owner,config=$$.config,_a=$$.state,clip=_a.clip,current=_a.current,$el=$$.$el;["subX","x","y","y2"].forEach(function(type){var axis=$el.axis[type],cullingOptionPrefix="axis_".concat("subX"===type?"x":type,"_tick_culling"),toCull=config[cullingOptionPrefix];if(axis&&toCull){var intervalForCulling_1,tickNodes=axis.selectAll(".tick"),tickValues_1=sortValue(tickNodes.data(),!config["".concat(cullingOptionPrefix,"_reverse")]),tickSize=tickValues_1.length,cullingMax=config["".concat(cullingOptionPrefix,"_max")],lines_1=config["".concat(cullingOptionPrefix,"_lines")];if(tickSize){for(var i=1;i<tickSize;i++)if(tickSize/i<cullingMax){intervalForCulling_1=i;break}tickNodes.each(function(d){var node=lines_1?this.querySelector("text"):this;node&&(node.style.display=tickValues_1.indexOf(d)%intervalForCulling_1?"none":null)})}else tickNodes.style("display",null);if("x"===type){var clipPath=current.maxTickSize.x.clipPath?clip.pathXAxisTickTexts:null;$el.svg.selectAll(".".concat($AXIS.axisX," .tick text")).attr("clip-path",clipPath)}}})},Axis.prototype.setAxisTooltip=function(){var _a,$$=this.owner,_b=$$.config,isRotated=_b.axis_rotated,axis_tooltip=_b.axis_tooltip,_c=$$.$el,axis=_c.axis,axisTooltip=_c.axisTooltip,bgColor=null!==(_a=axis_tooltip.backgroundColor)&&void 0!==_a?_a:"black";$$.generateTextBGColorFilter(bgColor,{x:-.15,y:-.2,width:1.3,height:1.3}),["x","y","y2"].forEach(function(v){var _a,_b,_c;if(isString(bgColor)||bgColor[v])if(axisTooltip[v]=null===(_a=axis[v])||void 0===_a?void 0:_a.append("text").classed($AXIS["axis".concat(v.toUpperCase(),"Tooltip")],!0).attr("filter",$$.updateTextBGColor({id:v},bgColor)),isRotated){var pos="x"===v?"x":"y",val="y"===v?"1.15em":"x"===v?"-0.3em":"-0.4em";null===(_b=axisTooltip[v])||void 0===_b||_b.attr(pos,val).attr("d".concat("x"===v?"y":"x"),"x"===v?"0.4em":"-1.3em").style("text-anchor","x"===v?"end":null)}else{pos="x"===v?"y":"x",val="x"===v?"1.15em":"".concat("y"===v?"-":"","0.4em");null===(_c=axisTooltip[v])||void 0===_c||_c.attr(pos,val).attr("d".concat("x"===v?"x":"y"),"x"===v?"-1em":"0.3em").style("text-anchor","y"===v?"end":null)}})},Axis}(),eventrect={initEventRect:function(){this.$el.main.select(".".concat($COMMON.chart)).append("g").attr("class",$EVENT.eventRects).style("fill-opacity","0")},redrawEventRect:function(){var _a,$$=this,config=$$.config,state=$$.state,$el=$$.$el,isMultipleX=$$.isMultipleX(),isInverted=config.axis_x_inverted;if($el.eventRect)$$.updateEventRect($el.eventRect,!0);else if($$.data.targets.length){var eventRectUpdate=$$.$el.main.select(".".concat($EVENT.eventRects)).style("cursor",config.zoom_enabled&&"drag"!==config.zoom_type?config.axis_rotated?"ns-resize":"ew-resize":null).classed($EVENT.eventRectsMultiple,isMultipleX).classed($EVENT.eventRectsSingle,!isMultipleX).selectAll(".".concat($EVENT.eventRect)).data([0]).enter().append("rect");$$.updateEventRect(eventRectUpdate),$$.updateEventType(eventRectUpdate),eventRectUpdate.call($$.getDraggableSelection()),$el.eventRect=eventRectUpdate,"touch"!==$$.state.inputType||$el.svg.on("touchstart.eventRect")||$$.hasArcType()||$$.bindTouchOnEventRect(),state.rendered&&$$.updateEventRect($el.eventRect,!0)}if(!isMultipleX){var xAxisTickValues=$$.getMaxDataCountTarget();config.data_xSort&&!isInverted||xAxisTickValues.sort(function(a,b){return isInverted?b.x-a.x:a.x-b.x}),$$.updateDataIndexByX(xAxisTickValues),$$.updateXs(xAxisTickValues),null===(_a=$$.updatePointClass)||void 0===_a||_a.call($$,!0),state.eventReceiver.data=xAxisTickValues}$$.updateEventRectData()},bindTouchOnEventRect:function(){var startPx,$$=this,config=$$.config,state=$$.state,_a=$$.$el,eventRect=_a.eventRect,svg=_a.svg,unselectRect=function(){$$.unselectRect(),$$.callOverOutForTouch()},preventDefault=config.interaction_inputType_touch.preventDefault,isPrevented=isBoolean(preventDefault)&&preventDefault||!1,preventThreshold=!isNaN(preventDefault)&&preventDefault||null;eventRect.on("touchstart",function(event){state.event=event,$$.updateEventRect()}).on("touchstart.eventRect touchmove.eventRect",function(event){if(state.event=event,!eventRect.empty()&&eventRect.classed($EVENT.eventRect)){if(state.dragging||state.flowing||$$.hasArcType()||event.touches.length>1)return;!function(event){var eventType=event.type,currentXY=event.changedTouches[0]["client".concat(config.axis_rotated?"Y":"X")];"touchstart"===eventType?isPrevented?event.preventDefault():null!==preventThreshold&&(startPx=currentXY):"touchmove"===eventType&&(isPrevented||!0===startPx||null!==preventThreshold&&Math.abs(startPx-currentXY)>=preventThreshold)&&(startPx=!0,event.preventDefault())}(event),function(context){if($$.isMultipleX())$$.selectRectForMultipleXs(context);else{var index=$$.getDataIndexFromEvent(state.event);$$.callOverOutForTouch(index),-1===index?$$.unselectRect():$$.selectRectForSingle(context,index)}}(eventRect.node())}else unselectRect()},!0).on("touchend.eventRect",function(event){state.event=event,!eventRect.empty()&&eventRect.classed($EVENT.eventRect)&&($$.hasArcType()||!$$.toggleShape||state.cancelClick)&&state.cancelClick&&(state.cancelClick=!1)},!0),svg.on("touchstart",function(event){state.event=event;var target=event.target;target&&target!==eventRect.node()&&unselectRect()})},updateEventRect:function(eventRect,force){void 0===force&&(force=!1);var state=this.state,$el=this.$el,eventReceiver=state.eventReceiver,width=state.width,height=state.height,rendered=state.rendered,resizing=state.resizing,rectElement=eventRect||$el.eventRect;(!rendered||resizing||force)&&(rectElement.attr("x",0).attr("y",0).attr("width",width).attr("height",height),rendered&&!force||rectElement.classed($EVENT.eventRect,!0)),function(){if(eventReceiver){var scrollPos=getScrollPosition($el.chart.node());eventReceiver.rect=getBoundingRect(rectElement.node(),!0).toJSON(),eventReceiver.rect.top+=scrollPos.y,eventReceiver.rect.left+=scrollPos.x}}()},updateEventType:function(target){var isRebindCall=isBoolean(target),eventRect=isRebindCall?this.$el.eventRect:target,unbindEvent=!!isRebindCall&&target!==(null==eventRect?void 0:eventRect.datum().multipleX);eventRect&&(unbindEvent&&(null==eventRect||eventRect.on("mouseover mousemove mouseout click",null)),this.isMultipleX()?this.generateEventRectsForMultipleXs(eventRect):this.generateEventRectsForSingleX(eventRect))},updateEventRectData:function(){var x,y,w,h,$$=this,config=$$.config,scale=$$.scale,state=$$.state,xScale=scale.zoom||scale.x,isRotated=config.axis_rotated,isMultipleX=$$.isMultipleX();if($$.updateEventType(isMultipleX),isMultipleX)x=0,y=0,w=state.width,h=state.height;else{var rectW_1,rectX=void 0;if($$.axis.isCategorized())rectW_1=$$.getEventRectWidth(),rectX=function(d){return xScale(d.x)-rectW_1/2};else{var getPrevNextX_1=function(_a){var index=_a.index;return{prev:$$.getPrevX(index),next:$$.getNextX(index)}};rectW_1=function(d){var val,x=getPrevNextX_1(d),xDomain=xScale.domain();return null===x.prev&&null===x.next?val=isRotated?state.height:state.width:null===x.prev?val=(xScale(x.next)+xScale(d.x))/2:null===x.next?val=xScale(xDomain[1])-(xScale(x.prev)+xScale(d.x))/2:(Object.keys(x).forEach(function(key,i){var _a;x[key]=null!==(_a=x[key])&&void 0!==_a?_a:xDomain[i]}),val=Math.max(0,(xScale(x.next)-xScale(x.prev))/2)),val},rectX=function(d){var x=getPrevNextX_1(d);return null===x.prev&&null===x.next?0:null===x.prev?xScale(xScale.domain()[0]):(xScale(d.x)+xScale(x.prev))/2}}x=isRotated?0:rectX,y=isRotated?rectX:0,w=isRotated?state.width:rectW_1,h=isRotated?rectW_1:state.height}var eventReceiver=state.eventReceiver,call=function(fn,v){return isFunction(fn)?fn(v):fn};eventReceiver.coords.splice(eventReceiver.data.length),eventReceiver.data.forEach(function(d,i){eventReceiver.coords[i]={x:call(x,d),y:call(y,d),w:call(w,d),h:call(h,d)}})},selectRectForSingle:function(context,index){var _a,_b,$$=this,config=$$.config,_c=$$.$el,main=_c.main,circle=_c.circle,isSelectionEnabled=config.data_selection_enabled,isSelectionGrouped=config.data_selection_grouped,isSelectable=config.data_selection_isselectable,isTooltipGrouped=config.tooltip_grouped,selectedData=$$.getAllValuesOnIndex(index);if(!isTooltipGrouped||($$.showTooltip(selectedData,context),null===(_a=$$.showGridFocus)||void 0===_a||_a.call($$,selectedData),isSelectionEnabled&&!isSelectionGrouped)){!circle&&main.selectAll(".".concat($COMMON.EXPANDED,":not(.").concat($SHAPE.shape,"-").concat(index,")")).classed($COMMON.EXPANDED,!1);var shapeAtIndex=main.selectAll(".".concat($SHAPE.shape,"-").concat(index)).classed($COMMON.EXPANDED,!0).style("cursor",isSelectable?"pointer":null).filter(function(d){return $$.isWithinShape(this,d)});shapeAtIndex.empty()&&!isTooltipGrouped&&config.interaction_onout&&(null===(_b=$$.hideGridFocus)||void 0===_b||_b.call($$),$$.hideTooltip(),!isSelectionGrouped&&$$.setExpand(index)),shapeAtIndex.call(function(selected){var _a,_b,d=selected.data();isSelectionEnabled&&(isSelectionGrouped||(null==isSelectable?void 0:isSelectable.bind($$.api)(d)))&&(context.style.cursor="pointer"),isTooltipGrouped||($$.showTooltip(d,context),null===(_a=$$.showGridFocus)||void 0===_a||_a.call($$,d),null===(_b=$$.unexpandCircles)||void 0===_b||_b.call($$),selected.each(function(d){return $$.setExpand(index,d.id)}))})}},selectRectForMultipleXs:function(context,triggerEvent){void 0===triggerEvent&&(triggerEvent=!0);var $$=this,config=$$.config,state=$$.state,targetsToShow=$$.filterTargetsToShow($$.data.targets);if(!state.dragging&&!$$.hasArcType(targetsToShow)){var mouse=getPointer(state.event,context),closest=$$.findClosestFromTargets(targetsToShow,mouse);if(!triggerEvent||!state.mouseover||closest&&closest.id===state.mouseover.id||(config.data_onout.call($$.api,state.mouseover),state.mouseover=void 0),closest){var selectedData=($$.isBubbleType(closest)||$$.isScatterType(closest)||!config.tooltip_grouped?[closest]:$$.filterByX(targetsToShow,closest.x)).map(function(d){return $$.addName(d)});$$.showTooltip(selectedData,context),$$.setExpand(closest.index,closest.id,!0),$$.showGridFocus(selectedData);var dist=$$.dist(closest,mouse);($$.isBarType(closest.id)||dist<$$.getPointSensitivity(closest))&&($$.$el.svg.select(".".concat($EVENT.eventRect)).style("cursor","pointer"),triggerEvent&&!state.mouseover&&(config.data_onover.call($$.api,closest),state.mouseover=closest))}else $$.unselectRect()}},unselectRect:function(){var $$=this,_a=$$.$el,circle=_a.circle,tooltip=_a.tooltip;$$.$el.svg.select(".".concat($EVENT.eventRect)).style("cursor",null),$$.hideGridFocus(),tooltip&&($$.hideTooltip(),$$._handleLinkedCharts(!1)),circle&&!$$.isPointFocusOnly()&&$$.unexpandCircles(),$$.expandBarTypeShapes(!1)},generateEventRectsForSingleX:function(eventRectEnter){var $$=this,config=$$.config,state=$$.state,eventReceiver=state.eventReceiver,rect=eventRectEnter.style("cursor",config.data_selection_enabled&&config.data_selection_grouped?"pointer":null).on("click",function(event){state.event=event;var currentIdx=eventReceiver.currentIdx,d=eventReceiver.data[-1===currentIdx?$$.getDataIndexFromEvent(event):currentIdx];$$.clickHandlerForSingleX.bind(this)(d,$$)}).datum({multipleX:!1});if("mouse"===state.inputType){rect.on("mouseover",function(event){state.event=event,$$.updateEventRect(),Object.values($$.$el.axisTooltip).forEach(function(v){return null==v?void 0:v.style("display",null)})}).on("mousemove",function(event){var d=function(event){var index=event?$$.getDataIndexFromEvent(event):eventReceiver.currentIdx;return index>-1?eventReceiver.data[index]:null}(event);if(state.event=event,d){var index=d.index,stepType=config.line_step_type;if(config.line_step_tooltipMatch&&$$.hasType("step")&&/^step\-(before|after)$/.test(stepType)){var scale=$$.scale.zoom||$$.scale.x,xs=$$.axis.xs[index],inverted=scale.invert(getPointer(event,this)[0]);"step-after"===stepType&&inverted<xs?index-=1:"step-before"===stepType&&inverted>xs&&(index+=1)}$$.showAxisGridFocus();var eventOnSameIdx=config.tooltip_grouped&&index===eventReceiver.currentIdx;state.dragging||state.flowing||$$.hasArcType()||eventOnSameIdx?config.tooltip_show&&eventOnSameIdx&&$$.setTooltipPosition():(index!==eventReceiver.currentIdx&&($$.setOverOut(!1,eventReceiver.currentIdx),eventReceiver.currentIdx=index),-1===index?$$.unselectRect():$$.selectRectForSingle(this,index),$$.setOverOut(-1!==index,index))}}).on("mouseout",function(event){state.event=event,config&&!$$.hasArcType()&&-1!==eventReceiver.currentIdx&&config.interaction_onout&&($$.hideAxisGridFocus(),$$.unselectRect(),$$.setOverOut(!1,eventReceiver.currentIdx),eventReceiver.currentIdx=-1)})}return rect},clickHandlerForSingleX:function(d,ctx){var $$=ctx,config=$$.config,state=$$.state,main=$$.$el.main;if(!d||$$.hasArcType()||state.cancelClick)state.cancelClick&&(state.cancelClick=!1);else{var index=d.index;main.selectAll(".".concat($SHAPE.shape,"-").concat(index)).each(function(d2){var _a;(config.data_selection_grouped||$$.isWithinShape(this,d2))&&(null===(_a=$$.toggleShape)||void 0===_a||_a.call($$,this,d2,index),config.data_onclick.bind($$.api)(d2,this))})}},generateEventRectsForMultipleXs:function(eventRectEnter){var $$=this,config=$$.config,state=$$.state;eventRectEnter.on("click",function(event){state.event=event,$$.clickHandlerForMultipleXS.bind(this)($$)}).datum({multipleX:!0}),"mouse"===state.inputType&&eventRectEnter.on("mouseover mousemove",function(event){state.event=event,$$.selectRectForMultipleXs(this)}).on("mouseout",function(event){state.event=event,$$.config&&!$$.hasArcType()&&config.interaction_onout&&$$.unselectRect()})},clickHandlerForMultipleXS:function(ctx){var $$=ctx,config=$$.config,state=$$.state,targetsToShow=$$.filterTargetsToShow($$.data.targets);if(!$$.hasArcType(targetsToShow)){var mouse=getPointer(state.event,this),closest=$$.findClosestFromTargets(targetsToShow,mouse),sensitivity=$$.getPointSensitivity(closest);closest&&($$.isBarType(closest.id)||$$.dist(closest,mouse)<sensitivity)&&$$.$el.main.selectAll(".".concat($SHAPE.shapes).concat($$.getTargetSelectorSuffix(closest.id))).selectAll(".".concat($SHAPE.shape,"-").concat(closest.index)).each(function(){var _a;(config.data_selection_grouped||$$.isWithinShape(this,closest))&&(null===(_a=$$.toggleShape)||void 0===_a||_a.call($$,this,closest,closest.index),config.data_onclick.bind($$.api)(closest,this))})}}},flow={generateFlow:function(args){var $$=this,data=$$.data,state=$$.state,$el=$$.$el;return function(){var flowLength=args.flow.length;state.flowing=!0,data.targets.forEach(function(d){d.values.splice(0,flowLength)}),$$.updateXGrid&&$$.updateXGrid(!0);var elements={};["axis.x","grid.x","gridLines.x","region.list","text","bar","line","area","circle"].forEach(function(v){var name=v.split("."),node=$el[name[0]];node&&name.length>1&&(node=node[name[1]]),(null==node?void 0:node.size())&&(elements[v]=node)}),$$.hideGridFocus(),$$.setFlowList(elements,args)}},setFlowList:function(elements,args){var n,$$=this,flow=args.flow,targets=args.targets,_a=flow.duration,duration=void 0===_a?args.duration:_a,flowIndex=flow.index,flowLength=flow.length,orgDataCount=flow.orgDataCount,transform=$$.getFlowTransform(targets,orgDataCount,flowIndex,flowLength),wait=generateWait();wait.add(Object.keys(elements).map(function(v){return n=elements[v].transition().ease(src_linear_linear).duration(duration),n="axis.x"===v?n.call(function(g){$$.axis.x.setTransition(g).create(g)}):"region.list"===v?n.filter($$.isRegionOnX).attr("transform",transform):n.attr("transform",transform)})),n.call(wait,function(){$$.cleanUpFlow(elements,args)})},cleanUpFlow:function(elements,args){var $$=this,config=$$.config,state=$$.state,svg=$$.$el.svg,isRotated=config.axis_rotated,flow=args.flow,shape=args.shape,xv=args.xv,_a=shape.pos,cx=_a.cx,cy=_a.cy,xForText=_a.xForText,yForText=_a.yForText,_b=flow.done,done=void 0===_b?function(){}:_b,flowLength=flow.length;flowLength&&(["circle","text","shape","eventRect"].forEach(function(v){for(var target=[],i=0;i<flowLength;i++)target.push(".".concat(CLASS[v],"-").concat(i));svg.selectAll(".".concat(CLASS["".concat(v,"s")])).selectAll(target).remove()}),svg.select(".".concat(CLASS.xgrid)).remove()),Object.keys(elements).forEach(function(v){var n=elements[v];if("axis.x"!==v&&n.attr("transform",null),"grid.x"===v)n.attr(state.xgridAttr);else if("gridLines.x"===v)n.attr("x1",isRotated?0:xv).attr("x2",isRotated?state.width:xv),n.select("text").attr("x",isRotated?state.width:0).attr("y",xv);else if(/^(area|bar|line)$/.test(v))n.attr("d",shape.type[v]);else if("text"===v)n.attr("x",xForText).attr("y",yForText).style("fill-opacity",$$.opacityForText.bind($$));else if("circle"===v)if($$.isCirclePoint())n.attr("cx",cx).attr("cy",cy);else{n.attr("x",function(d){return cx(d)-config.point_r}).attr("y",function(d){return cy(d)-config.point_r})}else"region.list"===v&&n.select("rect").filter($$.isRegionOnX).attr("x",$$.regionX.bind($$)).attr("width",$$.regionWidth.bind($$))}),config.interaction_enabled&&$$.redrawEventRect(),done.call($$.api),state.flowing=!1},getFlowTransform:function(targets,orgDataCount,flowIndex,flowLength){var translateX,$$=this,data=$$.data,x=$$.scale.x,dataValues=data.targets[0].values,flowStart=$$.getValueOnIndex(dataValues,flowIndex),flowEnd=$$.getValueOnIndex(dataValues,flowIndex+flowLength),orgDomain=x.domain(),domain=$$.updateXDomain(targets,!0,!0);orgDataCount?translateX=1===orgDataCount||(null==flowStart?void 0:flowStart.x)===(null==flowEnd?void 0:flowEnd.x)||$$.axis.isTimeSeries()?x(orgDomain[0])-x(domain[0]):x((null==flowStart?void 0:flowStart.x)||0)-x(flowEnd.x):1!==dataValues.length?translateX=x(orgDomain[0])-x(domain[0]):$$.axis.isTimeSeries()?(flowStart=$$.getValueOnIndex(dataValues,0),flowEnd=$$.getValueOnIndex(dataValues,dataValues.length-1),translateX=x(flowStart.x)-x(flowEnd.x)):translateX=diffDomain(domain)/2;var scaleX=diffDomain(orgDomain)/diffDomain(domain);return"translate(".concat(translateX,",0) scale(").concat(scaleX,",1)")}},clip={initClip:function(){var $$=this,_a=$$.state,clip=_a.clip,datetimeId=_a.datetimeId;clip.id="".concat(datetimeId,"-clip"),clip.idXAxis="".concat(clip.id,"-xaxis"),clip.idYAxis="".concat(clip.id,"-yaxis"),clip.idGrid="".concat(clip.id,"-grid"),clip.path=$$.getClipPath(clip.id),clip.pathXAxis=$$.getClipPath(clip.idXAxis),clip.pathYAxis=$$.getClipPath(clip.idYAxis),clip.pathGrid=$$.getClipPath(clip.idGrid)},getClipPath:function(id){var config=this.config;return!config.clipPath&&/-clip$/.test(id)||!config.axis_x_clipPath&&/-clip-xaxis$/.test(id)||!config.axis_y_clipPath&&/-clip-yaxis$/.test(id)?null:"url(#".concat(id,")")},appendClip:function(parent,id){id&&parent.append("clipPath").attr("id",id).append("rect")},setXAxisClipPath:function(node){var config=this.config,_a=this.state,margin=_a.margin,width=_a.width,height=_a.height,isRotated=config.axis_rotated,left=Math.max(30,margin.left)-(isRotated?0:20),h=(isRotated?margin.top+height+10:margin.bottom)+20,x=isRotated?-(1+left):-(left-1),w=isRotated?margin.left+20:width+10+left;node.attr("x",x).attr("y",-15).attr("width",w).attr("height",h)},setYAxisClipPath:function(node){var config=this.config,_a=this.state,margin=_a.margin,width=_a.width,height=_a.height,isRotated=config.axis_rotated,left=Math.max(30,margin.left)-(isRotated?20:0),isInner=config.axis_y_inner,x=isInner&&!isRotated?config.axis_y_label.text?-20:-1:isRotated?-(1+left):-(left-1),y=-(isRotated?20:margin.top),w=(isRotated?width+15+left:margin.left+20)+(isInner?20:0),h=(isRotated?margin.bottom+10:margin.top+height)+10;node.attr("x",x).attr("y",y).attr("width",w).attr("height",h)},updateXAxisTickClip:function(){var $$=this,config=$$.config,_a=$$.state,clip=_a.clip,xAxisHeight=_a.xAxisHeight,defs=$$.$el.defs,newXAxisHeight=$$.getHorizontalAxisHeight("x");if(defs&&!clip.idXAxisTickTexts){var clipId="".concat(clip.id,"-xaxisticktexts");$$.appendClip(defs,clipId),clip.pathXAxisTickTexts=$$.getClipPath(clip.idXAxisTickTexts),clip.idXAxisTickTexts=clipId}!config.axis_x_tick_multiline&&$$.getAxisTickRotate("x")&&newXAxisHeight!==xAxisHeight&&($$.setXAxisTickClipWidth(),$$.setXAxisTickTextClipPathWidth()),$$.state.xAxisHeight=newXAxisHeight},setXAxisTickClipWidth:function(){var config=this.config,maxTickSize=this.state.current.maxTickSize,xAxisTickRotate=this.getAxisTickRotate("x");if(!config.axis_x_tick_multiline&&xAxisTickRotate){var sinRotation=Math.sin(Math.PI/180*Math.abs(xAxisTickRotate));maxTickSize.x.clipPath=(this.getHorizontalAxisHeight("x")-20)/sinRotation}else maxTickSize.x.clipPath=null},setXAxisTickTextClipPathWidth:function(){var _a=this.state,clip=_a.clip,current=_a.current,svg=this.$el.svg;svg&&svg.select("#".concat(clip.idXAxisTickTexts," rect")).attr("width",current.maxTickSize.x.clipPath).attr("height",30)}},getGridTextAnchor=function(d){return isValue(d.position)||"end"},getGridTextDx=function(d){return"start"===d.position?4:"middle"===d.position?0:-4};function getGridTextX(isX,width,height){return function(d){var x=isX?0:width;return"start"===d.position?x=isX?-height:0:"middle"===d.position&&(x=(isX?-height:width)/2),x}}function smoothLines(el,type){el.each(function(){var g=src_select(this);["x1","x2","y1","y2"].forEach(function(v){return g.attr(v,+g.attr(v))})})}var grid={hasGrid:function(){var config=this.config;return["x","y"].some(function(v){return config["grid_".concat(v,"_show")]||config["grid_".concat(v,"_lines")].length})},initGrid:function(){this.hasGrid()&&this.initGridLines(),this.initFocusGrid()},initGridLines:function(){var config=this.config,clip=this.state.clip,$el=this.$el;(config.grid_x_lines.length||config.grid_y_lines.length)&&($el.gridLines.main=$el.main.insert("g",".".concat($COMMON.chart).concat(config.grid_lines_front?" + *":"")).attr("clip-path",clip.pathGrid).attr("class","".concat($GRID.grid," ").concat($GRID.gridLines)),$el.gridLines.main.append("g").attr("class",$GRID.xgridLines),$el.gridLines.main.append("g").attr("class",$GRID.ygridLines),$el.gridLines.x=src_selectAll([]))},updateXGrid:function(withoutUpdate){var $$=this,config=$$.config,scale=$$.scale,state=$$.state,_a=$$.$el,main=_a.main,grid=_a.grid,isRotated=config.axis_rotated,xgridData=$$.generateGridData(config.grid_x_type,scale.x),tickOffset=$$.axis.isCategorized()?$$.axis.x.tickOffset():0,pos=function(d){return(scale.zoom||scale.x)(d)+tickOffset*(isRotated?-1:1)};state.xgridAttr=isRotated?{x1:0,x2:state.width,y1:pos,y2:pos}:{x1:pos,x2:pos,y1:0,y2:state.height},grid.x=main.select(".".concat($GRID.xgrids)).selectAll(".".concat($GRID.xgrid)).data(xgridData),grid.x.exit().remove(),grid.x=grid.x.enter().append("line").attr("class",$GRID.xgrid).merge(grid.x),withoutUpdate||grid.x.each(function(){var grid=src_select(this);Object.keys(state.xgridAttr).forEach(function(id){grid.attr(id,state.xgridAttr[id]).style("opacity",function(){return grid.attr(isRotated?"y1":"x1")===(isRotated?state.height:0)?"0":null})})})},updateYGrid:function(){var $$=this,axis=$$.axis,config=$$.config,scale=$$.scale,state=$$.state,_a=$$.$el,grid=_a.grid,main=_a.main,isRotated=config.axis_rotated,pos=function(d){return scale.y(d)},gridValues=axis.y.getGeneratedTicks(config.grid_y_ticks)||$$.scale.y.ticks(config.grid_y_ticks);grid.y=main.select(".".concat($GRID.ygrids)).selectAll(".".concat($GRID.ygrid)).data(gridValues),grid.y.exit().remove(),grid.y=grid.y.enter().append("line").attr("class",$GRID.ygrid).merge(grid.y),grid.y.attr("x1",isRotated?pos:0).attr("x2",isRotated?pos:state.width).attr("y1",isRotated?0:pos).attr("y2",isRotated?state.height:pos),smoothLines(grid.y)},updateGrid:function(){var $$=this,_a=$$.$el,grid=_a.grid;!_a.gridLines.main&&$$.initGridLines(),grid.main.style("visibility",$$.hasArcType()?"hidden":null),$$.hideGridFocus(),$$.updateGridLines("x"),$$.updateGridLines("y")},updateGridLines:function(type){var config=this.config,_a=this.$el,gridLines=_a.gridLines,main=_a.main,$T=this.$T,isRotated=config.axis_rotated,isX="x"===type;config["grid_".concat(type,"_show")]&&this["update".concat(type.toUpperCase(),"Grid")]();var lines=main.select(".".concat($GRID["".concat(type,"gridLines")])).selectAll(".".concat($GRID["".concat(type,"gridLine")])).data(config["grid_".concat(type,"_lines")]);$T(lines.exit()).style("opacity","0").remove();var gridLine=lines.enter().append("g");gridLine.append("line").style("opacity","0"),(lines=gridLine.merge(lines)).each(function(d){var g=src_select(this);g.select("text").empty()&&d.text&&g.append("text").style("opacity","0")}),$T(lines.attr("class",function(d){return"".concat($GRID["".concat(type,"gridLine")]," ").concat(d.class||"").trim()}).select("text").attr("text-anchor",getGridTextAnchor).attr("transform",function(){return isX?isRotated?null:"rotate(-90)":isRotated?"rotate(-90)":null}).attr("dx",getGridTextDx).attr("dy",-5)).text(function(d){var _a;return null!==(_a=d.text)&&void 0!==_a?_a:this.remove()}),gridLines[type]=lines},redrawGrid:function(withTransition){var $$=this,isRotated=$$.config.axis_rotated,_a=$$.state,width=_a.width,height=_a.height,gridLines=$$.$el.gridLines,$T=$$.$T,xv=$$.xv.bind($$),yv=$$.yv.bind($$),xLines=gridLines.x.select("line"),xTexts=gridLines.x.select("text"),yLines=gridLines.y.select("line"),yTexts=gridLines.y.select("text");return xLines=$T(xLines,withTransition).attr("x1",isRotated?0:xv).attr("x2",isRotated?width:xv).attr("y1",isRotated?xv:0).attr("y2",isRotated?xv:height),xTexts=$T(xTexts,withTransition).attr("x",getGridTextX(!isRotated,width,height)).attr("y",xv),yLines=$T(yLines,withTransition).attr("x1",isRotated?yv:0).attr("x2",isRotated?yv:width).attr("y1",isRotated?0:yv).attr("y2",isRotated?height:yv),yTexts=$T(yTexts,withTransition).attr("x",getGridTextX(isRotated,width,height)).attr("y",yv),[xLines.style("opacity",null),xTexts.style("opacity",null),yLines.style("opacity",null),yTexts.style("opacity",null)]},initFocusGrid:function(){var config=this.config,clip=this.state.clip,$el=this.$el,isFront=config.grid_front,className=".".concat(isFront&&$el.gridLines.main?$GRID.gridLines:$COMMON.chart).concat(isFront?" + *":""),grid=$el.main.insert("g",className).attr("clip-path",clip.pathGrid).attr("class",$GRID.grid);if($el.grid.main=grid,config.grid_x_show&&grid.append("g").attr("class",$GRID.xgrids),config.grid_y_show&&grid.append("g").attr("class",$GRID.ygrids),config.axis_tooltip){var axis=grid.append("g").attr("class","bb-axis-tooltip");axis.append("line").attr("class","bb-axis-tooltip-x"),axis.append("line").attr("class","bb-axis-tooltip-y")}config.interaction_enabled&&config.grid_focus_show&&!config.axis_tooltip&&(grid.append("g").attr("class",$FOCUS.xgridFocus).append("line").attr("class",$FOCUS.xgridFocus),config.grid_focus_y&&!config.tooltip_grouped&&grid.append("g").attr("class",$FOCUS.ygridFocus).append("line").attr("class",$FOCUS.ygridFocus))},showAxisGridFocus:function(){for(var _a,_b,$$=this,config=$$.config,format=$$.format,_c=$$.state,event=_c.event,width=_c.width,height=_c.height,isRotated=config.axis_rotated,_d=getPointer(event,null===(_a=$$.$el.eventRect)||void 0===_a?void 0:_a.node()),x=_d[0],y=_d[1],pos={x,y},_i=0,_e=Object.entries($$.$el.axisTooltip);_i<_e.length;_i++){var _f=_e[_i],axis=_f[0],node=_f[1],attr="x"===axis&&!isRotated||"x"!==axis&&isRotated?"x":"y",value=pos[attr],scaleText=null===(_b=$$.scale[axis])||void 0===_b?void 0:_b.invert(value);scaleText&&(scaleText="x"===axis&&$$.axis.isTimeSeries()?format.xAxisTick(scaleText):null==scaleText?void 0:scaleText.toFixed(2),null==node||node.attr(attr,value).text(scaleText))}$$.$el.main.selectAll("line.bb-axis-tooltip-x, line.bb-axis-tooltip-y").style("visibility",null).each(function(d,i){var line=src_select(this);0===i?line.attr("x1",x).attr("x2",x).attr("y1",i?0:height).attr("y2",i?height:0):line.attr("x1",i?0:width).attr("x2",i?width:0).attr("y1",y).attr("y2",y)})},hideAxisGridFocus:function(){this.$el.main.selectAll("line.".concat($AXIS.axisTooltipX,", line.").concat($AXIS.axisTooltipY)).style("visibility","hidden"),Object.values(this.$el.axisTooltip).forEach(function(v){return null==v?void 0:v.style("display","none")})},showGridFocus:function(data){var _a,$$=this,config=$$.config,_b=$$.state,width=_b.width,height=_b.height,isRotated=config.axis_rotated,focusEl=$$.$el.main.selectAll("line.".concat($FOCUS.xgridFocus,", line.").concat($FOCUS.ygridFocus)),dataToShow=(data||[focusEl.datum()]).filter(function(d){return d&&isValue($$.getBaseValue(d))});if(config.tooltip_show&&0!==dataToShow.length&&(config.axis_x_forceAsSingle||!$$.hasType("bubble"))&&!$$.hasArcType()){var isEdge=config.grid_focus_edge&&!config.tooltip_grouped,xx=$$.xx.bind($$);focusEl.style("visibility",null).data(dataToShow.concat(dataToShow)).each(function(d){var xy,el=src_select(this),pos={x:xx(d),y:$$.getYScaleById(d.id)(d.value)};if(el.classed($FOCUS.xgridFocus))xy=isRotated?[null,pos.x,isEdge?pos.y:width,pos.x]:[pos.x,isEdge?pos.y:null,pos.x,height];else{var isY2="y2"===$$.axis.getId(d.id);xy=isRotated?[pos.y,isEdge&&!isY2?pos.x:null,pos.y,isEdge&&isY2?pos.x:height]:[isEdge&&isY2?pos.x:null,pos.y,isEdge&&!isY2?pos.x:width,pos.y]}["x1","y1","x2","y2"].forEach(function(v,i){return el.attr(v,xy[i])})}),smoothLines(focusEl),null===(_a=$$.showCircleFocus)||void 0===_a||_a.call($$,data)}},hideGridFocus:function(){var _a,_b=this.state,inputType=_b.inputType,resizing=_b.resizing,main=this.$el.main;"mouse"!==inputType&&resizing||(main.selectAll("line.".concat($FOCUS.xgridFocus,", line.").concat($FOCUS.ygridFocus)).style("visibility","hidden"),null===(_a=this.hideCircleFocus)||void 0===_a||_a.call(this))},updateGridFocus:function(){var _a,$$=this,_b=$$.state,inputType=_b.inputType,width=_b.width,height=_b.height,resizing=_b.resizing,xgridFocus=$$.$el.grid.main.select("line.".concat($FOCUS.xgridFocus));if("touch"===inputType)xgridFocus.empty()?resizing&&(null===(_a=$$.showCircleFocus)||void 0===_a||_a.call($$)):$$.showGridFocus();else{var isRotated=$$.config.axis_rotated;xgridFocus.attr("x1",isRotated?0:-10).attr("x2",isRotated?width:-10).attr("y1",isRotated?-10:0).attr("y2",isRotated?-10:height)}return!0},generateGridData:function(type,scale){var tickNum=this.$el.main.select(".".concat($AXIS.axisX)).selectAll(".tick").size(),gridData=[];if("year"===type)for(var _a=this.getXDomain().map(function(v){return v.getFullYear()}),firstYear=_a[0],lastYear=_a[1],i=firstYear;i<=lastYear;i++)gridData.push(new Date("".concat(i,"-01-01 00:00:00")));else(gridData=scale.ticks(10)).length>tickNum&&(gridData=gridData.filter(function(d){return String(d).indexOf(".")<0}));return gridData},getGridFilterToRemove:function(params){return params?function(line){var found=!1;return(isArray(params)?params.concat():[params]).forEach(function(param){("value"in param&&line.value===param.value||"class"in param&&line.class===param.class)&&(found=!0)}),found}:function(){return!0}},removeGridLines:function(params,forX){var config=this.config,$T=this.$T,toRemove=this.getGridFilterToRemove(params),classLines=forX?$GRID.xgridLines:$GRID.ygridLines,classLine=forX?$GRID.xgridLine:$GRID.ygridLine;$T(this.$el.main.select(".".concat(classLines)).selectAll(".".concat(classLine)).filter(toRemove)).style("opacity","0").remove();var gridLines="grid_".concat(forX?"x":"y","_lines");config[gridLines]=config[gridLines].filter(function(line){return!toRemove(line)})}},region={initRegion:function(){var $el=this.$el;$el.region.main=$el.main.insert("g",":first-child").attr("clip-path",this.state.clip.path).attr("class",$REGION.regions)},updateRegion:function(){var $$=this,config=$$.config,region=$$.$el.region,$T=$$.$T;region.main||$$.initRegion(),region.main.style("visibility",$$.hasArcType()?"hidden":null);var regions=region.main.selectAll(".".concat($REGION.region)).data(config.regions);$T(regions.exit()).style("opacity","0").remove();var regionsEnter=regions.enter().append("g");regionsEnter.append("rect").style("fill-opacity","0"),region.list=regionsEnter.merge(regions).attr("class",$$.classRegion.bind($$)),region.list.each(function(d){var _a;src_select(this).select("text").empty()&&(null===(_a=d.label)||void 0===_a?void 0:_a.text)&&src_select(this).append("text").style("opacity","0")})},redrawRegion:function(withTransition){var $$=this,region=$$.$el.region,$T=$$.$T,regionX=$$.regionX.bind($$),regionY=$$.regionY.bind($$),attr=["width","height"],regions=region.list.select("rect"),label=region.list.selectAll("text");return regions=$T(regions,withTransition).attr("x",regionX).attr("y",regionY).attr("width",$$.regionWidth.bind($$)).attr("height",$$.regionHeight.bind($$)),label=$T(label,withTransition).text(function(d){var _a;return null===(_a=d.label)||void 0===_a?void 0:_a.text}).attr("transform",function(_a){return _a.label.rotated?" rotate(-90)":null}).attr("transform",function(d){var _a,_this=this,_b=null!==(_a=d.label)&&void 0!==_a?_a:{},_c=_b.x,x=void 0===_c?0:_c,_d=_b.y,y=void 0===_d?0:_d,_e=_b.center,center=void 0!==_e&&_e,_f=_b.rotated,rotated=void 0!==_f&&_f,rect=this.previousElementSibling,pos={x:0,y:0};return isString(center)&&["x","y"].forEach(function(v,i){center.indexOf(v)>-1&&(pos[v]=(+rect.getAttribute(attr[i])-getBoundingRect(_this)[attr[i]])/2)}),"translate(".concat(regionX(d)+pos.x+x,", ").concat(regionY(d)+pos.y+y,")").concat(rotated?" rotate(-90)":"")}).attr("text-anchor",function(_a){var label=_a.label;return(null==label?void 0:label.rotated)?"end":null}).attr("dy","1em").style("fill",function(_a){var _b,label=_a.label;return null!==(_b=null==label?void 0:label.color)&&void 0!==_b?_b:null}),[regions.style("fill-opacity",function(d){return isValue(d.opacity)?d.opacity:null}).on("end",function(){src_select(this.parentNode).selectAll("rect:not([x])").remove()}),label.style("opacity",null)]},regionX:function(d){return this.getRegionSize("x",d)},regionY:function(d){return this.getRegionSize("y",d)},regionWidth:function(d){return this.getRegionSize("width",d)},regionHeight:function(d){return this.getRegionSize("height",d)},getRegionSize:function(type,d){var currScale,$$=this,config=$$.config,scale=$$.scale,state=$$.state,isRotated=config.axis_rotated,isAxisType=/(x|y|y2)/.test(type),isType=isAxisType?"x"===type:"width"===type,start=!isAxisType&&$$[isType?"regionX":"regionY"](d),key=isAxisType?"start":"end",pos=isAxisType?0:state[type];if("y"===d.axis||"y2"===d.axis?(isAxisType||isType?isAxisType&&!isType&&(key="end"):key="start",(isType?isRotated:!isRotated)&&key in d&&(currScale=scale[d.axis])):(isType?!isRotated:isRotated)&&key in d&&(currScale=scale.zoom||scale.x),currScale){var offset=0;pos=d[key],$$.axis.isTimeSeries(d.axis)?pos=parseDate.call($$,pos):/(x|width)/.test(type)&&$$.axis.isCategorized()&&isNaN(pos)&&(pos=config.axis_x_categories.indexOf(pos),offset=$$.axis.x.tickOffset()*("start"===key?-1:1)),pos=currScale(pos)+offset}return isAxisType?pos:pos<start?0:pos-start},isRegionOnX:function(d){return!d.axis||"x"===d.axis}},sizeAxis={getAxisSize:function(id){var isRotated=this.config.axis_rotated;return isRotated&&"x"===id||!isRotated&&/y2?/.test(id)?this.getAxisWidthByAxisId(id,!0):this.getHorizontalAxisHeight(id)},getAxisWidthByAxisId:function(id,withoutRecompute){var _a,_b;if(this.axis){var position=null===(_a=this.axis)||void 0===_a?void 0:_a.getLabelPositionById(id),width=this.axis.getMaxTickSize(id,withoutRecompute).width,gap=0===width?.5:0;return width+("fit"===(null===(_b=this.config.padding)||void 0===_b?void 0:_b.mode)?position.isInner?10+gap:10:position.isInner?20+gap:40)}return 40},getHorizontalAxisHeight:function(id){var _a,_b,$$=this,config=$$.config,state=$$.state,rotatedPadding=state.rotatedPadding,isLegendRight=state.isLegendRight,isLegendInset=state.isLegendInset,isRotated=config.axis_rotated,isFitPadding="fit"===(null===(_a=config.padding)||void 0===_a?void 0:_a.mode),isInner=config["axis_".concat(id,"_inner")],hasLabelText=config["axis_".concat(id,"_label")].text,h="fit"===(null===(_b=config.padding)||void 0===_b?void 0:_b.mode)?isInner&&!hasLabelText?"y"===id?1:0:20:30;if("x"===id&&!config.axis_x_show)return 8;if("x"===id&&isNumber(config.axis_x_height))return config.axis_x_height;if("y"===id&&!config.axis_y_show)return!config.legend_show||isLegendRight||isLegendInset?1:10;if("y2"===id&&!config.axis_y2_show)return isFitPadding?0:rotatedPadding.top;var maxtickSize=$$.axis.getMaxTickSize(id),isXAxisTickRotated=Math.abs(config.axis_x_tick_rotate)>0&&(!config.axis_x_tick_autorotate||$$.needToRotateXAxisTickTexts());return(config.axis_x_tick_multiline||isXAxisTickRotated)&&maxtickSize.height>13&&(h+=maxtickSize.height-13),h+($$.axis.getLabelPositionById(id).isInner?0:10)+("y2"!==id||isRotated?0:-10)},getEventRectWidth:function(){var config=this.config,axis=this.axis,isInverted=config.axis_x_inverted,tickInterval=axis.x.tickInterval();return Math.max(0,isInverted?Math.abs(tickInterval):tickInterval)},getAxisTickRotate:function(id){var $$=this,axis=$$.axis,config=$$.config,state=$$.state,$el=$$.$el,rotate=config["axis_".concat(id,"_tick_rotate")];if("x"===id){var allowedXAxisTypes=axis.isCategorized()||axis.isTimeSeries();if(config.axis_x_tick_fit&&allowedXAxisTypes){var xTickCount=config.axis_x_tick_count,currentXTicksLength=state.current.maxTickSize.x.ticks.length,tickCount=0;if(xTickCount?tickCount=xTickCount>currentXTicksLength?currentXTicksLength:xTickCount:currentXTicksLength&&(tickCount=currentXTicksLength),tickCount!==state.axis.x.tickCount){var targets=$$.data.targets;state.axis.x.padding=$$.getXDomainPadding([$$.getXDomainMinMax(targets,"min"),$$.getXDomainMinMax(targets,"max")],tickCount)}state.axis.x.tickCount=tickCount}$el.svg&&config.axis_x_tick_autorotate&&config.axis_x_tick_fit&&!config.axis_x_tick_multiline&&!config.axis_x_tick_culling&&allowedXAxisTypes&&(rotate=$$.needToRotateXAxisTickTexts()?config.axis_x_tick_rotate:0)}return rotate},needToRotateXAxisTickTexts:function(){var _a=this.state,axis=_a.axis,current=_a.current,isLegendRight=_a.isLegendRight,legendItemWidth=_a.legendItemWidth,legendWidth=isLegendRight&&legendItemWidth,xAxisLength=current.width-legendWidth-this.getCurrentPaddingByDirection("left")-this.getCurrentPaddingByDirection("right"),tickCountWithPadding=axis.x.tickCount+axis.x.padding.left+axis.x.padding.right;return this.axis.getMaxTickSize("x").width>(tickCountWithPadding?xAxisLength/tickCountWithPadding:0)}},y={axis_y_clipPath:!0,axis_y_show:!0,axis_y_type:"indexed",axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:!1,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_culling:!1,axis_y_tick_culling_max:5,axis_y_tick_culling_lines:!0,axis_y_tick_culling_reverse:!1,axis_y_tick_inner:!1,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_show:!0,axis_y_tick_stepSize:null,axis_y_tick_text_show:!0,axis_y_tick_text_position:{x:0,y:0},axis_y_tick_time_value:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y_axes:[]},y2={axis_y2_show:!1,axis_y2_type:"indexed",axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:!1,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_culling:!1,axis_y2_tick_culling_max:5,axis_y2_tick_culling_lines:!0,axis_y2_tick_culling_reverse:!1,axis_y2_tick_inner:!1,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_rotate:0,axis_y2_tick_count:void 0,axis_y2_tick_show:!0,axis_y2_tick_stepSize:null,axis_y2_tick_text_show:!0,axis_y2_tick_text_position:{x:0,y:0},axis_y2_padding:{},axis_y2_default:void 0,axis_y2_axes:[]},optAxis=__assign(__assign(__assign({axis_evalTextSize:!0,axis_rotated:!1,axis_tooltip:!1},{axis_x_clipPath:!0,axis_x_show:!0,axis_x_forceAsSingle:!1,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_culling_lines:!0,axis_x_tick_culling_reverse:!1,axis_x_tick_count:void 0,axis_x_tick_inner:!1,axis_x_tick_show:!0,axis_x_tick_text_show:!0,axis_x_tick_text_inner:!1,axis_x_tick_text_position:{x:0,y:0},axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_autorotate:!1,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_tick_tooltip:!1,axis_x_max:void 0,axis_x_min:void 0,axis_x_inverted:!1,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_x_axes:[]}),y),y2),api=[apiAxis,apiCategory,apiFlow,apiGrid,apiGroup,apiRegion,apiX],internal={axis:billboard_axis,clip,eventrect,flow,grid,region,sizeAxis},options={optDataAxis:{data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_axes:{},data_regions:{},data_stack_normalize:!1},optAxis,optGrid:{grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:void 0,grid_focus_edge:!1,grid_focus_show:!0,grid_focus_y:!1,grid_front:!1,grid_lines_front:!0}};function getRadiusFn(expandRate){void 0===expandRate&&(expandRate=0);var $$=this,config=$$.config,state=$$.state,hasMultiArcGauge=$$.hasMultiArcGauge(),singleArcWidth=state.gaugeArcWidth/$$.filterTargetsToShow($$.data.targets).length,expandWidth=expandRate?Math.min(state.radiusExpanded*expandRate-state.radius,.8*singleArcWidth-100*(1-expandRate)):0;return{inner:function(d){var innerRadius=$$.getRadius(d).innerRadius;return hasMultiArcGauge?state.radius-singleArcWidth*(d.index+1):isNumber(innerRadius)?innerRadius:0},outer:function(d){var radius,outerRadius=$$.getRadius(d).outerRadius;if(hasMultiArcGauge)radius=state.radius-singleArcWidth*d.index+expandWidth;else if($$.hasType("polar")&&!expandRate)radius=$$.getPolarOuterRadius(d,outerRadius);else if(radius=outerRadius,expandRate){var radiusExpanded=state.radiusExpanded;state.radius!==outerRadius&&(radiusExpanded-=Math.abs(state.radius-outerRadius)),radius=radiusExpanded*expandRate}return radius},corner:function(d,outerRadius){var _a=config.arc_cornerRadius_ratio,ratio=void 0===_a?0:_a,_b=config.arc_cornerRadius,cornerRadius=void 0===_b?0:_b,id=d.data.id,value=d.value;return ratio?ratio*outerRadius:isNumber(cornerRadius)?cornerRadius:cornerRadius.call($$.api,id,value,outerRadius)}}}function getAttrTweenFn(fn){return function(d){var getAngleKeyValue=function(_a){var _b=_a.startAngle,startAngle=void 0===_b?0:_b,_c=_a.endAngle,endAngle=void 0===_c?0:_c,_d=_a.padAngle;return{startAngle,endAngle,padAngle:void 0===_d?0:_d}},interpolate$1=value(getAngleKeyValue(this._current),getAngleKeyValue(d));return this._current=d,function(t){var interpolated=interpolate$1(t),data=d.data,index=d.index,value=d.value;return fn(__assign(__assign({},interpolated),{data,index,value}))}}}var shapeArc={initPie:function(){var config=this.config,dataType=config.data_type,padding=config["".concat(dataType,"_padding")],startingAngle=config["".concat(dataType,"_startingAngle")]||0,padAngle=(padding?.01*padding:config["".concat(dataType,"_padAngle")])||0;this.pie=function pie(){var value=d3_shape_src_identity,sortValues=src_descending,sort=null,startAngle=d3_shape_src_constant(0),endAngle=d3_shape_src_constant(tau),padAngle=d3_shape_src_constant(0);function pie(data){var i,j,k,a1,v,n=(data=d3_shape_src_array(data)).length,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(tau,Math.max(-tau,endAngle.apply(this,arguments)-a0)),p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1);for(i=0;i<n;++i)(v=arcs[index[i]=i]=+value(data[i],i,data))>0&&(sum+=v);for(null!=sortValues?index.sort(function(i,j){return sortValues(arcs[i],arcs[j])}):null!=sort&&index.sort(function(i,j){return sort(data[i],data[j])}),i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1)j=index[i],a1=a0+((v=arcs[j])>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p};return arcs}return pie.value=function(_){return arguments.length?(value="function"==typeof _?_:d3_shape_src_constant(+_),pie):value},pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues},pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):padAngle},pie}().startAngle(startingAngle).endAngle(startingAngle+2*Math.PI).padAngle(padAngle).value(function(d){var _a,_b;return null!==(_b=null===(_a=d.values)||void 0===_a?void 0:_a.reduce(function(a,b){return a+b.value},0))&&void 0!==_b?_b:d}).sort(this.getSortCompareFn.bind(this)(!0))},updateRadius:function(){var $$=this,config=$$.config,state=$$.state,dataType=config.data_type,padding=config["".concat(dataType,"_padding")],w=config.gauge_width||config.donut_width,gaugeArcWidth=$$.filterTargetsToShow($$.data.targets).length*config.gauge_arcs_minWidth;state.radiusExpanded=Math.min(state.arcWidth,state.arcHeight)/2*($$.hasMultiArcGauge()&&config.gauge_label_show?.85:1),state.radius=.95*state.radiusExpanded,state.innerRadiusRatio=w?(state.radius-w)/state.radius:.6,state.gaugeArcWidth=w||(gaugeArcWidth<=state.radius-state.innerRadius?state.radius-state.innerRadius:gaugeArcWidth<=state.radius?gaugeArcWidth:state.radius);var innerRadius=config.pie_innerRadius||(padding?padding*(state.innerRadiusRatio+.1):0);state.outerRadius=config.pie_outerRadius,state.innerRadius=$$.hasType("donut")||$$.hasType("gauge")?state.radius*state.innerRadiusRatio:innerRadius},getRadius:function(d){var data=null==d?void 0:d.data,_a=this.state,innerRadius=_a.innerRadius,outerRadius=_a.outerRadius;return!isNumber(innerRadius)&&data&&(innerRadius=innerRadius[data.id]||0),isObject(outerRadius)&&data&&data.id in outerRadius?outerRadius=outerRadius[data.id]:isNumber(outerRadius)||(outerRadius=this.state.radius),{innerRadius,outerRadius}},updateArc:function(){var $$=this;$$.updateRadius(),$$.svgArc=$$.getSvgArc(),$$.svgArcExpanded=$$.getSvgArcExpanded()},getArcLength:function(){var arcLengthInPercent=3.6*this.config.gauge_arcLength,len=arcLengthInPercent/360*2;return arcLengthInPercent<-360?len=-2:arcLengthInPercent>360&&(len=2),len*Math.PI},getStartingAngle:function(){var config=this.config,dataType=config.data_type,isFullCircle=!!this.hasType("gauge")&&config.gauge_fullCircle,defaultStartAngle=-1*Math.PI/2,defaultEndAngle=Math.PI/2,startAngle=config["".concat(dataType,"_startingAngle")]||0;return!isFullCircle&&startAngle<=defaultStartAngle?startAngle=defaultStartAngle:!isFullCircle&&startAngle>=defaultEndAngle?startAngle=defaultEndAngle:(startAngle>Math.PI||startAngle<-1*Math.PI)&&(startAngle=Math.PI),startAngle},updateAngle:function(dValue,forRange){var _a;void 0===forRange&&(forRange=!1);var $$=this,config=$$.config,state=$$.state,hasGauge=forRange&&$$.hasType("gauge"),pie=$$.pie,d=dValue,found=!1;if(!config)return null;var gStart=$$.getStartingAngle(),radius=config.gauge_fullCircle||forRange&&!hasGauge?$$.getArcLength():-2*gStart;if(d.data&&$$.isGaugeType(d.data)&&!$$.hasMultiArcGauge()){var gMin=config.gauge_min,gMax=config.gauge_max,gEnd=radius*(($$.getTotalDataSum(state.rendered)-gMin)/(gMax-gMin));pie=pie.startAngle(gStart).endAngle(gEnd+gStart)}if(!1===forRange&&pie($$.filterTargetsToShow()).forEach(function(t,i){var _a;found||t.data.id!==(null===(_a=d.data)||void 0===_a?void 0:_a.id)||(found=!0,(d=t).index=i)}),isNaN(d.startAngle)&&(d.startAngle=0),isNaN(d.endAngle)&&(d.endAngle=d.startAngle),forRange||d.data&&(config.gauge_enforceMinMax||$$.hasMultiArcGauge())){gMin=config.gauge_min,gMax=config.gauge_max;var max=forRange&&!hasGauge?$$.getTotalDataSum(state.rendered):gMax,gTic=radius/(max-gMin),value=null!==(_a=d.value)&&void 0!==_a?_a:0,gValue=value<gMin?0:value<max?value-gMin:max-gMin;d.startAngle=gStart,d.endAngle=gStart+gTic*gValue}return found||forRange?d:null},getSvgArc:function(){var $$=this,_a=getRadiusFn.call($$),inner=_a.inner,outer=_a.outer,corner=_a.corner,arc$1=arc().innerRadius(inner).outerRadius(outer),newArc=function(d,withoutUpdate){var _a,path="M 0 0";if(d.value||d.data){var data=withoutUpdate?d:null!==(_a=$$.updateAngle(d))&&void 0!==_a?_a:null;data&&(path=arc$1.cornerRadius(corner(data,outer(data)))(data))}return path};return newArc.centroid=arc$1.centroid,newArc},getSvgArcExpanded:function(rate){void 0===rate&&(rate=1);var $$=this,_a=getRadiusFn.call($$,rate),inner=_a.inner,outer=_a.outer,corner=_a.corner,arc$1=arc().innerRadius(inner).outerRadius(outer);return function(d){var updated=$$.updateAngle(d),outerR=outer(updated),cornerR=0;return updated&&(cornerR=corner(updated,outerR)),updated?arc$1.cornerRadius(cornerR)(updated):"M 0 0"}},getArc:function(d,withoutUpdate,force){return force||this.isArcType(d.data)?this.svgArc(d,withoutUpdate):"M 0 0"},redrawArcRangeText:function(){var $$=this,config=$$.config,arcs=$$.$el.arcs,state=$$.state,$T=$$.$T,format=config.arc_rangeText_format,fixed=$$.hasType("gauge")&&config.arc_rangeText_fixed,values=config.arc_rangeText_values;if(null==values?void 0:values.length){var isPercent_1="%"===config.arc_rangeText_unit,totalSum_1=$$.getTotalDataSum(state.rendered);isPercent_1&&(values=values.map(function(v){return totalSum_1/100*v}));var pieData_1=$$.pie(values).map(function(d,i){return d.index=i,d}),rangeText=arcs.selectAll(".".concat($ARC.arcRange)).data(values);rangeText.exit(),rangeText=$T(rangeText.enter().append("text").attr("class",$ARC.arcRange).style("text-anchor","middle").style("pointer-events","none").style("opacity","0").text(function(v){var range=isPercent_1?v/totalSum_1*100:v;return isFunction(format)?format(range):"".concat(range).concat(isPercent_1?"%":"")}).merge(rangeText)),(!state.rendered||state.rendered&&!fixed)&&totalSum_1>0&&rangeText.attr("transform",function(d,i){return $$.transformForArcLabel(this,pieData_1[i],!0)}),rangeText.style("opacity",function(d){return!fixed&&(d>totalSum_1||0===totalSum_1)?"0":null})}},transformForArcLabel:function(textNode,d,forRange){var _a,_b,_c;void 0===forRange&&(forRange=!1);var $$=this,config=$$.config,radiusExpanded=$$.state.radiusExpanded,updated=$$.updateAngle(d,forRange),pos={x:0,y:0},translate="",ratio=1;if(updated){if(forRange||$$.hasMultiArcGauge()){var y1=Math.sin(updated.endAngle-Math.PI/2),rangeTextPosition=config.arc_rangeText_position;if(pos.x=Math.cos(updated.endAngle-Math.PI/2)*(radiusExpanded+(forRange?5:25)),pos.y=y1*(radiusExpanded+15-Math.abs(10*y1))+3,forRange&&rangeTextPosition){var rangeValues=config.arc_rangeText_values,position=isFunction(rangeTextPosition)?rangeTextPosition(rangeValues[d.index]):rangeTextPosition;pos.x+=null!==(_a=null==position?void 0:position.x)&&void 0!==_a?_a:0,pos.y+=null!==(_b=null==position?void 0:position.y)&&void 0!==_b?_b:0}}else if(!$$.hasType("gauge")||$$.data.targets.length>1){var outerRadius=$$.getRadius(d).outerRadius;$$.hasType("polar")&&(outerRadius=$$.getPolarOuterRadius(d,outerRadius));var _d=this.svgArc.centroid(updated).map(function(v){return isNaN(v)?0:v}),x=_d[0],y=_d[1],h=Math.sqrt(x*x+y*y);pos.x=x,pos.y=y,ratio=(ratio=null===(_c=["donut","gauge","pie","polar"].filter($$.hasType.bind($$)).map(function(v){return config["".concat(v,"_label_ratio")]}))||void 0===_c?void 0:_c[0])?isFunction(ratio)?ratio.bind($$.api)(d,outerRadius,h):ratio:outerRadius&&(h?(36/outerRadius>.375?1.175-36/outerRadius:.8)*outerRadius/h:0)}updateTextImagePos.call($$,textNode,pos),translate="translate(".concat(pos.x*ratio,",").concat(pos.y*ratio,")")}return translate},convertToArcData:function(d){return this.addName({id:"data"in d?d.data.id:d.id,value:d.value,ratio:this.getRatio("arc",d),index:d.index})},textForArcLabel:function(selection){var $$=this,hasGauge=$$.hasType("gauge");$$.shouldShowArcLabel()&&selection.style("fill",$$.updateTextColor.bind($$)).attr("filter",function(d){return $$.updateTextBGColor.bind($$)(d,$$.config.data_labels_backgroundColors)}).each(function(d){var _a,node=src_select(this),updated=$$.updateAngle(d),ratio=$$.getRatio("arc",updated);if(meetsLabelThreshold.call($$,ratio,null===(_a=["donut","gauge","pie","polar"].filter($$.hasType.bind($$)))||void 0===_a?void 0:_a[0])){var value=(updated||d).value;setTextValue(node,($$.getArcLabelConfig("format")||$$.defaultArcValueFormat)(value,ratio,d.data.id).toString(),[-1,1],hasGauge)}else node.text("")})},expandArc:function(targetIds){var $$=this,transiting=$$.state.transiting,$el=$$.$el;if(transiting)var interval_1=setInterval(function(){transiting||(clearInterval(interval_1),$el.legend.selectAll(".".concat($FOCUS.legendItemFocused)).size()>0&&$$.expandArc(targetIds))},10);else{var newTargetIds=$$.mapToTargetIds(targetIds);$el.svg.selectAll($$.selectorTargets(newTargetIds,".".concat($ARC.chartArc))).each(function(d){if($$.shouldExpand(d.data.id)){var expandDuration=$$.getExpandConfig(d.data.id,"duration"),svgArcExpandedSub=$$.getSvgArcExpanded($$.getExpandConfig(d.data.id,"rate"));src_select(this).selectAll("path").transition().duration(expandDuration).attrTween("d",getAttrTweenFn($$.svgArcExpanded.bind($$))).transition().duration(2*expandDuration).attrTween("d",getAttrTweenFn(svgArcExpandedSub.bind($$)))}})}},unexpandArc:function(targetIds){var $$=this,transiting=$$.state.transiting,svg=$$.$el.svg;if(!transiting){var newTargetIds=$$.mapToTargetIds(targetIds);svg.selectAll($$.selectorTargets(newTargetIds,".".concat($ARC.chartArc))).selectAll("path").transition().duration(function(d){return $$.getExpandConfig(d.data.id,"duration")}).attrTween("d",getAttrTweenFn($$.svgArc.bind($$))),svg.selectAll("".concat($ARC.arc)).style("opacity",null)}},getExpandConfig:function(id,key){var type,config=this.config;return this.isDonutType(id)?type="donut":this.isGaugeType(id)?type="gauge":this.isPieType(id)&&(type="pie"),type?config["".concat(type,"_expand_").concat(key)]:{duration:50,rate:.98}[key]},shouldExpand:function(id){var config=this.config;return this.isDonutType(id)&&config.donut_expand||this.isGaugeType(id)&&config.gauge_expand||this.isPieType(id)&&config.pie_expand},shouldShowArcLabel:function(){var $$=this,config=$$.config;return["donut","gauge","pie","polar"].some(function(v){return $$.hasType(v)&&config["".concat(v,"_label_show")]})},getArcLabelConfig:function(name){void 0===name&&(name="format");var config=this.config,fn=function(v){return v};return["donut","gauge","pie","polar"].filter(this.hasType.bind(this)).forEach(function(v){fn=config["".concat(v,"_label_").concat(name)]}),"format"===name&&isFunction(fn)?fn.bind(this.api):fn},updateTargetsForArc:function(targets){var $$=this,$el=$$.$el,hasGauge=$$.hasType("gauge"),classChartArc=$$.getChartClass("Arc"),classArcs=$$.getClass("arcs",!0),classFocus=$$.classFocus.bind($$),chartArcs=$el.main.select(".".concat($ARC.chartArcs)),mainPieUpdate=chartArcs.selectAll(".".concat($ARC.chartArc)).data($$.pie(targets)).attr("class",function(d){return classChartArc(d)+classFocus(d.data)}),mainPieEnter=mainPieUpdate.enter().append("g").attr("class",classChartArc).call(this.setCssRule(!1,".".concat($ARC.chartArcs," text"),["pointer-events:none","text-anchor:middle"]));mainPieEnter.append("g").attr("class",classArcs).merge(mainPieUpdate),mainPieEnter.append("text").attr("dy",hasGauge&&!$$.hasMultiTargets()?"-.1em":".35em").style("opacity","0").style("text-anchor",$$.getStylePropValue("middle")).style("pointer-events",$$.getStylePropValue("none")),$el.text=chartArcs.selectAll(".".concat($COMMON.target," text"))},initArc:function(){var $el=this.$el;$el.arcs=$el.main.select(".".concat($COMMON.chart)).append("g").attr("class",$ARC.chartArcs).attr("transform",this.getTranslate("arc")),this.setArcTitle()},setArcTitle:function(str){var title=str||this.getArcTitle(),hasGauge=this.hasType("gauge");if(title){var className=hasGauge?$GAUGE.chartArcsGaugeTitle:$ARC.chartArcsTitle,text=this.$el.arcs.select(".".concat(className));text.empty()&&(text=this.$el.arcs.append("text").attr("class",className).style("text-anchor","middle")),hasGauge&&text.attr("dy","-0.3em"),setTextValue(text,title,hasGauge?void 0:[-.6,1.35],!0)}},getArcTitle:function(){var type=this.hasType("donut")?"donut":this.hasType("gauge")&&"gauge";return type?this.config["".concat(type,"_title")]:""},getArcTitleWithNeedleValue:function(){var config=this.config,state=this.state,title=this.getArcTitle();if(title&&this.config.arc_needle_show&&/{=[A-Z_]+}/.test(title)){var value=state.current.needle;return isNumber(value)||(value=config.arc_needle_value),tplProcess(title,{NEEDLE_VALUE:~~value})}return!1},redrawArc:function(duration,durationForExit,withTransform){var $$=this,config=$$.config,state=$$.state,main=$$.$el.main,hasInteraction=config.interaction_enabled,isSelectable=hasInteraction&&config.data_selection_isselectable,mainArc=main.selectAll(".".concat($ARC.arcs)).selectAll(".".concat($ARC.arc)).data($$.arcData.bind($$));mainArc.exit().transition().duration(durationForExit).style("opacity","0").remove(),mainArc=mainArc.enter().append("path").attr("class",$$.getClass("arc",!0)).style("fill",function(d){return $$.color(d.data)}).style("cursor",function(d){var _a;return(null===(_a=null==isSelectable?void 0:isSelectable.bind)||void 0===_a?void 0:_a.call(isSelectable,$$.api)(d))?"pointer":null}).style("opacity","0").each(function(d){$$.isGaugeType(d.data)&&(d.startAngle=config.gauge_startingAngle,d.endAngle=config.gauge_startingAngle),this._current=d}).merge(mainArc),$$.hasType("gauge")&&($$.updateGaugeMax(),$$.hasMultiArcGauge()&&$$.redrawArcGaugeLine()),mainArc.attr("transform",function(d){return!$$.isGaugeType(d.data)&&withTransform?"scale(0)":""}).style("opacity",function(d){return d===this._current?"0":null}).each(function(){state.transiting=!0}).transition().duration(duration).attrTween("d",function(d){var updated=$$.updateAngle(d);if(!updated)return function(){return"M 0 0"};isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle);var interpolate$1=value(this._current,updated);return this._current=interpolate$1(0),function(t){var interpolated=interpolate$1(t);return interpolated.data=d.data,$$.getArc(interpolated,!0)}}).attr("transform",withTransform?"scale(1)":"").style("fill",function(d){var color;return $$.levelColor?(color=$$.levelColor(d.data.values[0].value),config.data_colors[d.data.id]=color):color=$$.color(d.data),color}).style("opacity",null).call(endall,function(){if($$.levelColor){var path=src_select(this),d=path.datum(this._current);$$.updateLegendItemColor(d.data.id,path.style("fill"))}state.transiting=!1,callFn(config.onrendered,$$.api)}),hasInteraction&&$$.bindArcEvent(mainArc),$$.hasType("polar")&&$$.redrawPolar(),$$.hasType("gauge")&&$$.redrawBackgroundArcs(),config.arc_needle_show&&$$.redrawNeedle(),$$.redrawArcText(duration),$$.redrawArcRangeText()},redrawNeedle:function(){var $$=this,$el=$$.$el,config=$$.config,_a=$$.state,hiddenTargetIds=_a.hiddenTargetIds,length=(_a.radius-1)/100*config.arc_needle_length,hasDataToShow=hiddenTargetIds.length!==$$.data.targets.length,needle=$$.$el.arcs.select(".".concat($ARC.needle)),pathFn=config.arc_needle_path,baseWidth=config.arc_needle_bottom_width/2,topWidth=config.arc_needle_top_width/2,topRx=config.arc_needle_top_rx,topRy=config.arc_needle_top_ry,bottomLen=config.arc_needle_bottom_len,bottomRx=config.arc_needle_bottom_rx,bottomRy=config.arc_needle_bottom_ry,needleAngle=$$.getNeedleAngle(),updateNeedleValue=function(){var title=$$.getArcTitleWithNeedleValue();title&&$$.setArcTitle(title)};if(updateNeedleValue(),needle.empty()&&(needle=$el.arcs.append("path").classed($ARC.needle,!0),$el.needle=needle,$el.needle.updateHelper=function(v,updateConfig){void 0===updateConfig&&(updateConfig=!1),"none"!==$el.needle.style("display")&&$$.$T($el.needle).style("transform","rotate(".concat($$.getNeedleAngle(v),"deg)")).call(endall,function(){updateConfig&&(config.arc_needle_value=v),updateNeedleValue()})}),hasDataToShow){var path=isFunction(pathFn)?pathFn.call($$,length):"M-".concat(baseWidth," ").concat(bottomLen," A").concat(bottomRx," ").concat(bottomRy," 0 0 0 ").concat(baseWidth," ").concat(bottomLen," L").concat(topWidth," -").concat(length," A").concat(topRx," ").concat(topRy," 0 0 0 -").concat(topWidth," -").concat(length," L-").concat(baseWidth," ").concat(bottomLen," Z");$$.$T(needle).attr("d",path).style("fill",config.arc_needle_color).style("display",null).style("transform","rotate(".concat(needleAngle,"deg)"))}else needle.style("display","none")},getNeedleAngle:function(v){var $$=this,config=$$.config,state=$$.state,arcLength=$$.getArcLength(),hasGauge=$$.hasType("gauge"),total=$$.getTotalDataSum(!0),value=isDefined(v)?v:config.arc_needle_value,startingAngle=config["".concat(config.data_type,"_startingAngle")]||0,radian=0;if(isNumber(value)||(value=hasGauge&&1===$$.data.targets.length?total:0),state.current.needle=value,hasGauge){startingAngle=$$.getStartingAngle();var radius=config.gauge_fullCircle?arcLength:-2*startingAngle,min=config.gauge_min;radian=radius*((value-min)/(config.gauge_max-min))}else radian=arcLength*(value/total);return(startingAngle+radian)*(180/Math.PI)},redrawBackgroundArcs:function(){var $$=this,config=$$.config,state=$$.state,hasMultiArcGauge=$$.hasMultiArcGauge(),isFullCircle=config.gauge_fullCircle,showEmptyTextLabel=0===$$.filterTargetsToShow($$.data.targets).length&&!!config.data_empty_label_text,startAngle=$$.getStartingAngle(),endAngle=isFullCircle?startAngle+$$.getArcLength():-1*startAngle,backgroundArc=$$.$el.arcs.select("".concat(hasMultiArcGauge?"g":"",".").concat($ARC.chartArcsBackground));if(hasMultiArcGauge){var index_1=0;(backgroundArc=backgroundArc.selectAll("path.".concat($ARC.chartArcsBackground)).data($$.data.targets)).enter().append("path").attr("class",function(d,i){return"".concat($ARC.chartArcsBackground," ").concat($ARC.chartArcsBackground,"-").concat(i)}).merge(backgroundArc).style("fill",config.gauge_background||null).attr("d",function(_a){var id=_a.id;if(showEmptyTextLabel||state.hiddenTargetIds.indexOf(id)>=0)return"M 0 0";var d={data:[{value:config.gauge_max}],startAngle,endAngle,index:index_1++};return $$.getArc(d,!0,!0)}),backgroundArc.exit().remove()}else backgroundArc.attr("d",showEmptyTextLabel?"M 0 0":function(){var d={data:[{value:config.gauge_max}],startAngle,endAngle};return $$.getArc(d,!0,!0)})},bindArcEvent:function(arc){var $$=this,config=$$.config,state=$$.state,isTouch="touch"===state.inputType,isMouse="mouse"===state.inputType;function selectArc(_this,arcData,id){$$.expandArc(id),$$.api.focus(id),$$.toggleFocusLegend(id,!0),$$.showTooltip([arcData],_this)}function unselectArc(arcData){$$.unexpandArc(undefined),$$.api.revert(),$$.revertLegend(),$$.hideTooltip()}if(arc.on("click",function(event,d,i){var _a,arcData,updated=$$.updateAngle(d);updated&&(arcData=$$.convertToArcData(updated),null===(_a=$$.toggleShape)||void 0===_a||_a.call($$,this,arcData,i),config.data_onclick.bind($$.api)(arcData,this))}),isMouse&&arc.on("mouseover",function(event,d){if(!state.transiting){state.event=event;var updated=$$.updateAngle(d),arcData=updated?$$.convertToArcData(updated):null;selectArc(this,arcData,(null==arcData?void 0:arcData.id)||void 0),$$.setOverOut(!0,arcData)}}).on("mouseout",function(event,d){if(!state.transiting&&config.interaction_onout){state.event=event;var updated=$$.updateAngle(d),arcData=updated?$$.convertToArcData(updated):null;unselectArc(),$$.setOverOut(!1,arcData)}}).on("mousemove",function(event,d){var updated=$$.updateAngle(d),arcData=updated?$$.convertToArcData(updated):null;state.event=event,$$.showTooltip([arcData],this)}),isTouch&&$$.hasArcType()&&!$$.radars){$$.$el.svg.on("touchstart touchmove",function(event){if(!state.transiting){state.event=event;var eventArc=function(event){var _a,_b,_c=null!==(_b=null===(_a=event.changedTouches)||void 0===_a?void 0:_a[0])&&void 0!==_b?_b:{clientX:0,clientY:0},clientX=_c.clientX,clientY=_c.clientY;return src_select(doc.elementFromPoint(clientX,clientY))}(event),datum=eventArc.datum(),updated=(null==datum?void 0:datum.data)&&datum.data.id?$$.updateAngle(datum):null,arcData=updated?$$.convertToArcData(updated):null,id=(null==arcData?void 0:arcData.id)||void 0;$$.callOverOutForTouch(arcData),isUndefined(id)?unselectArc():selectArc(this,arcData,id)}})}},redrawArcText:function(duration){var text,$$=this,config=$$.config,state=$$.state,_a=$$.$el,main=_a.main,arcs=_a.arcs,hasGauge=$$.hasType("gauge"),hasMultiArcGauge=$$.hasMultiArcGauge();if(hasGauge&&1===$$.data.targets.length&&config.gauge_title||(text=main.selectAll(".".concat($ARC.chartArc)).select("text").style("opacity","0").attr("class",function(d){return $$.isGaugeType(d.data)?$GAUGE.gaugeValue:null}).call($$.textForArcLabel.bind($$)).style("font-size",function(d){return $$.isGaugeType(d.data)&&1===$$.data.targets.length&&!hasMultiArcGauge?"".concat(Math.round(state.radius/5),"px"):null}),updateTextImage.call($$),text.attr("transform",function(d){return $$.transformForArcLabel.bind($$)(this,d)}).transition().duration(duration).style("opacity",function(d){return $$.isTargetToShow(d.data.id)&&$$.isArcType(d.data)?null:"0"}),hasMultiArcGauge&&text.attr("dy","-.1em")),main.select(".".concat($ARC.chartArcsTitle)).style("opacity",$$.hasType("donut")||hasGauge?null:"0"),hasGauge){var isFullCircle=config.gauge_fullCircle;isFullCircle&&(null==text||text.attr("dy","".concat(hasMultiArcGauge?0:Math.round(state.radius/14)))),config.gauge_label_show&&(arcs.select(".".concat($GAUGE.chartArcsGaugeUnit)).attr("dy","".concat(isFullCircle?1.5:.75,"em")).text(config.gauge_units),arcs.select(".".concat($GAUGE.chartArcsGaugeMin)).attr("dx","".concat(-1*(state.innerRadius+(state.radius-state.innerRadius)/(isFullCircle?1:2)),"px")).attr("dy","1.2em").text($$.textForGaugeMinMax(config.gauge_min,!1)),!isFullCircle&&arcs.select(".".concat($GAUGE.chartArcsGaugeMax)).attr("dx","".concat(state.innerRadius+(state.radius-state.innerRadius)/2,"px")).attr("dy","1.2em").text($$.textForGaugeMinMax(config.gauge_max,!0)))}},getArcElementByIdOrIndex:function(value){var arcs=this.$el.arcs,filterFn=isNumber(value)?function(d){return d.index===value}:function(d){return d.data.id===value};return null==arcs?void 0:arcs.selectAll(".".concat($COMMON.target," path")).filter(filterFn)}},shapeArea={initArea:function(mainLine){var config=this.config;mainLine.insert("g",".".concat(config.area_front?$CIRCLE.circles:$LINE.lines)).attr("class",this.getClass("areas",!0))},updateAreaColor:function(d){return this.config.area_linearGradient?this.getGradienColortUrl(d.id):this.color(d)},updateArea:function(withTransition,isSub){void 0===isSub&&(isSub=!1);var $$=this,config=$$.config,state=$$.state,$el=$$.$el,$T=$$.$T,$root=isSub?$el.subchart:$el;config.area_linearGradient&&$$.updateLinearGradient();var area=$root.main.selectAll(".".concat($AREA.areas)).selectAll(".".concat($AREA.area)).data($$.lineData.bind($$));$T(area.exit(),withTransition).style("opacity","0").remove(),$root.area=area.enter().append("path").attr("class",$$.getClass("area",!0)).style("fill",$$.updateAreaColor.bind($$)).style("opacity",function(){return state.orgAreaOpacity=src_select(this).style("opacity"),"0"}).merge(area),area.style("opacity",state.orgAreaOpacity),$$.setRatioForGroupedData($root.area.data())},redrawArea:function(drawFn,withTransition,isSub){void 0===isSub&&(isSub=!1);var $$=this,area=(isSub?this.$el.subchart:this.$el).area,orgAreaOpacity=$$.state.orgAreaOpacity;return[$$.$T(area,withTransition,getRandom()).attr("d",drawFn).style("fill",$$.updateAreaColor.bind($$)).style("opacity",function(d){return String($$.isAreaRangeType(d)?orgAreaOpacity/1.75:orgAreaOpacity)})]},generateDrawArea:function(areaIndices,isSub){var $$=this,config=$$.config,lineConnectNull=config.line_connectNull,isRotated=config.axis_rotated,getPoints=$$.generateGetAreaPoints(areaIndices,isSub),yScale=$$.getYScaleById.bind($$),xValue=function(d){return(isSub?$$.subxx:$$.xx).call($$,d)},value0=function(d,i){return $$.isGrouped(d.id)?getPoints(d,i)[0][1]:yScale(d.id,isSub)($$.isAreaRangeType(d)?$$.getRangedData(d,"high"):$$.getShapeYMin(d.id))},value1=function(d,i){return $$.isGrouped(d.id)?getPoints(d,i)[1][1]:yScale(d.id,isSub)($$.isAreaRangeType(d)?$$.getRangedData(d,"low"):d.value)};return function(d){var path,values=lineConnectNull?$$.filterRemoveNull(d.values):d.values,x0=0,y0=0;if($$.isAreaType(d)){var area=function src_area(x0,y0,y1){var x1=null,defined=d3_shape_src_constant(!0),context=null,curve=curve_linear,output=null,path=withPath(area);function area(data){var i,j,k,d,buffer,n=(data=d3_shape_src_array(data)).length,defined0=!1,x0z=new Array(n),y0z=new Array(n);for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0)if(defined0=!defined0)j=i,output.areaStart(),output.lineStart();else{for(output.lineEnd(),output.lineStart(),k=i-1;k>=j;--k)output.point(x0z[k],y0z[k]);output.lineEnd(),output.areaEnd()}defined0&&(x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data),output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i]))}if(buffer)return output=null,buffer+""||null}function arealine(){return src_line().defined(defined).curve(curve).context(context)}return x0="function"==typeof x0?x0:void 0===x0?point_x:d3_shape_src_constant(+x0),y0="function"==typeof y0?y0:d3_shape_src_constant(void 0===y0?0:+y0),y1="function"==typeof y1?y1:void 0===y1?point_y:d3_shape_src_constant(+y1),area.x=function(_){return arguments.length?(x0="function"==typeof _?_:d3_shape_src_constant(+_),x1=null,area):x0},area.x0=function(_){return arguments.length?(x0="function"==typeof _?_:d3_shape_src_constant(+_),area):x0},area.x1=function(_){return arguments.length?(x1=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),area):x1},area.y=function(_){return arguments.length?(y0="function"==typeof _?_:d3_shape_src_constant(+_),y1=null,area):y0},area.y0=function(_){return arguments.length?(y0="function"==typeof _?_:d3_shape_src_constant(+_),area):y0},area.y1=function(_){return arguments.length?(y1=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),area):y1},area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)},area.lineY1=function(){return arealine().x(x0).y(y1)},area.lineX1=function(){return arealine().x(x1).y(y0)},area.defined=function(_){return arguments.length?(defined="function"==typeof _?_:d3_shape_src_constant(!!_),area):defined},area.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),area):curve},area.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),area):context},area}();area=isRotated?area.y(xValue).x0(value0).x1(value1):area.x(xValue).y0(config.area_above?0:config.area_below?$$.state.height:value0).y1(value1),lineConnectNull||(area=area.defined(function(d){return null!==$$.getBaseValue(d)})),$$.isStepType(d)&&(values=$$.convertValuesToStep(values)),path=area.curve($$.getCurve(d))(values)}else values[0]&&(x0=$$.scale.x(values[0].x),y0=$$.getYScaleById(d.id)(values[0].value)),path=isRotated?"M ".concat(y0," ").concat(x0):"M ".concat(x0," ").concat(y0);return path||"M 0 0"}},generateGetAreaPoints:function(areaIndices,isSub){var $$=this,config=$$.config,x=$$.getShapeX(0,areaIndices,isSub),y=$$.getShapeY(!!isSub),areaOffset=$$.getShapeOffset($$.isAreaType,areaIndices,isSub),yScale=$$.getYScaleById.bind($$);return function(d,i){var y0=yScale.call($$,d.id,isSub)($$.getShapeYMin(d.id)),offset=areaOffset(d,i)||y0,posX=x(d),value=d.value,posY=y(d);return config.axis_rotated&&(value>0&&posY<y0||value<0&&y0<posY)&&(posY=y0),[[posX,offset],[posX,posY-(y0-offset)],[posX,posY-(y0-offset)],[posX,offset]]}}};function getConnectLineType(id){var connectLine=this.config.bar_connectLine,type=(null==connectLine?void 0:connectLine[id])||connectLine;return/^(start|end)\-(start|end)$/.test(type)?type:null}var shapeBar={initBar:function(){var $el=this.$el,config=this.config,clip=this.state.clip;$el.bar=$el.main.select(".".concat($COMMON.chart)),$el.bar=config.bar_front?$el.bar.append("g"):$el.bar.insert("g",":first-child"),$el.bar.attr("class",$BAR.chartBars).call(this.setCssRule(!1,".".concat($BAR.chartBars),["pointer-events:none"])),!1===config.clipPath&&(config.bar_radius||config.bar_radius_ratio)&&$el.bar.attr("clip-path",clip.pathXAxis.replace(/#[^)]*/,"#".concat(clip.id)))},updateTargetsForBar:function(targets){var $$=this,config=$$.config,$el=$$.$el,classChartBar=$$.getChartClass("Bar"),classBars=$$.getClass("bars",!0),classFocus=$$.classFocus.bind($$),isSelectable=config.interaction_enabled&&config.data_selection_isselectable;$el.bar||$$.initBar(),$el.main.select(".".concat($BAR.chartBars)).selectAll(".".concat($BAR.chartBar)).data($$.filterNullish(targets)).attr("class",function(d){return classChartBar(d)+classFocus(d)}).enter().append("g").attr("class",classChartBar).style("opacity","0").style("pointer-events",$$.getStylePropValue("none")).append("g").attr("class",classBars).style("cursor",function(d){var _a;return(null===(_a=null==isSelectable?void 0:isSelectable.bind)||void 0===_a?void 0:_a.call(isSelectable,$$.api)(d))?"pointer":null}).call(function(selection){$$.setCssRule(!0," .".concat($BAR.bar),["fill"],$$.color)(selection),selection.each(function(d){getConnectLineType.call($$,d.id)&&src_select(this).append("path").attr("class",$BAR.barConnectLine)})})},updateBar:function(withTransition,isSub){void 0===isSub&&(isSub=!1);var $$=this,config=$$.config,$el=$$.$el,$T=$$.$T,$root=isSub?$el.subchart:$el,classBar=$$.getClass("bar",!0),initialOpacity=$$.initialOpacity.bind($$);config.bar_linearGradient&&$$.updateLinearGradient();var bar=$root.main.selectAll(".".concat($BAR.bars)).selectAll(".".concat($BAR.bar)).data($$.labelishData.bind($$));$T(bar.exit(),withTransition).style("opacity","0").remove(),$root.bar=bar.enter().append("path").attr("class",classBar).style("fill",$$.updateBarColor.bind($$)).merge(bar).style("opacity",initialOpacity),$$.setRatioForGroupedData($root.bar.data())},updateBarColor:function(d){var fn=this.getStylePropValue(this.color);return this.config.bar_linearGradient?this.getGradienColortUrl(d.id):fn?fn(d):null},redrawBar:function(drawFn,withTransition,isSub){void 0===isSub&&(isSub=!1);var $$=this,bar=(isSub?$$.$el.subchart:$$.$el).bar,barPath=[];return[$$.$T(bar,withTransition,getRandom()).attr("d",function(d,i,arr){var path=(isNumber(d.value)||$$.isBarRangeType(d))&&drawFn(d,i),connectLineType=getConnectLineType.call($$,d.id);if(path.length>1&&(barPath.push(path[1]),i===arr.length-1)){var barConnectLineNode=$$.$T(src_select(this.parentNode.querySelector(".".concat($BAR.barConnectLine))),withTransition,getRandom());$$.updateConnectLine(barConnectLineNode,connectLineType,barPath),barPath.splice(0)}return path[0]}).style("fill",$$.updateBarColor.bind($$)).style("clip-path",function(d){return d.clipPath}).style("opacity",null)]},generateDrawBar:function(barIndices,isSub){var $$=this,config=$$.config,getPoints=$$.generateGetBarPoints(barIndices,isSub),isRotated=config.axis_rotated,barRadius=config.bar_radius,barRadiusRatio=config.bar_radius_ratio,getRadius=isNumber(barRadius)&&barRadius>0?function(){return barRadius}:isNumber(barRadiusRatio)?function(w){return w*barRadiusRatio}:null;return function(d,i){var points=getPoints(d,i),indexX=+isRotated,indexY=+!indexX,isUnderZero=d.value<0,isInverted=config["axis_".concat($$.axis.getId(d.id),"_inverted")],isNegative=!isInverted&&isUnderZero||isInverted&&!isUnderZero,pathRadius=["",""],isGrouped=$$.isGrouped(d.id),isRadiusData=!(!getRadius||!isGrouped)&&$$.isStackingRadiusData(d),init=[points[0][indexX],points[0][indexY]],radius=0;if(d.clipPath=null,getRadius){var index=isRotated?indexY:indexX,barW=points[2][index]-points[0][index];radius=!isGrouped||isRadiusData?getRadius(barW):0;var arc="a".concat(radius," ").concat(radius," ").concat(isNegative?"1 0 0":"0 0 1"," ");pathRadius[+!isRotated]="".concat(arc).concat(radius,",").concat(radius),pathRadius[+isRotated]="".concat(arc).concat([-radius,radius][isRotated?"sort":"reverse"]()),isNegative&&pathRadius.reverse()}var pos=isRotated?points[1][indexX]+(isNegative?radius:-radius):points[1][indexY]+(isNegative?-radius:radius);if(radius){var clipPath="";isRotated?isNegative&&init[0]<pos?clipPath="0 ".concat(pos-init[0],"px 0 0"):!isNegative&&init[0]>pos&&(clipPath="0 0 0 ".concat(init[0]-pos,"px")):isNegative&&init[1]>pos?clipPath="".concat(init[1]-pos,"px 0 0 0"):!isNegative&&init[1]<pos&&(clipPath="0 0 ".concat(pos-init[1],"px 0")),clipPath&&(d.clipPath="inset(".concat(clipPath,")"))}var path=isRotated?"H".concat(pos," ").concat(pathRadius[0],"V").concat(points[2][indexY]-radius," ").concat(pathRadius[1],"H").concat(points[3][indexX]):"V".concat(pos," ").concat(pathRadius[0],"H").concat(points[2][indexX]-radius," ").concat(pathRadius[1],"V").concat(points[3][indexY]),coords=["M".concat(points[0][indexX],",").concat(points[0][indexY]).concat(path,"z")];return getConnectLineType.call($$,d.id)&&coords.push(isRotated?{x:points[0][indexX],y:points[0][indexY],width:points[0][indexX]-pos,height:points[2][indexY]-points[0][indexY]}:{x:points[0][indexX],y:pos,width:points[2][indexX]-points[0][indexX],height:points[3][indexY]-pos}),coords}},isStackingRadiusData:function(d){var $$=this,$el=$$.$el,config=$$.config,data=$$.data,state=$$.state,id=d.id,index=d.index,value=d.value;if(state.hiddenTargetIds.indexOf(id)>-1){var target=$el.bar.filter(function(d){return d.id===id&&d.value===value});return!target.empty()&&/a\d+/i.test(target.attr("d"))}var keys=config.data_groups.find(function(v){return v.indexOf(id)>-1}),sortedIds=$$.orderTargets($$.filterTargetsToShow(data.targets.filter($$.isBarType,$$))).filter(function(v){return keys.indexOf(v.id)>-1}).map(function(v){return v.values.filter(function(v2){return v2.index===index&&(isNumber(value)&&value>0?v2.value>0:v2.value<0)})[0]}).filter(Boolean).map(function(v){return v.id});return 0!==value&&sortedIds.indexOf(id)===sortedIds.length-1},generateGetBarPoints:function(barIndices,isSub){var $$=this,config=$$.config,axis=isSub?$$.axis.subX:$$.axis.x,barTargetsNum=$$.getIndicesMax(barIndices)+1,barW=$$.getBarW("bar",axis,barTargetsNum),barX=$$.getShapeX(barW,barIndices,!!isSub),barY=$$.getShapeY(!!isSub),barOffset=$$.getShapeOffset($$.isBarType,barIndices,!!isSub),yScale=$$.getYScaleById.bind($$);return function(d,i){var id=d.id,y0=yScale.call($$,id,isSub)($$.getShapeYMin(id)),offset=barOffset(d,i)||y0,width=isNumber(barW)?barW:barW[d.id]||barW._$width,isInverted=config["axis_".concat($$.axis.getId(id),"_inverted")],value=d.value,posX=barX(d),posY=barY(d);config.axis_rotated&&!isInverted&&(value>0&&posY<y0||value<0&&y0<posY)&&(posY=y0),$$.isBarRangeType(d)||(posY-=y0-offset);var startPosX=posX+width;return[[posX,offset],[posX,posY],[startPosX,posY],[startPosX,offset]]}},updateConnectLine:function(node,type,barPath){var _this=this,path=barPath.map(function(v,i,arr){var isRotated=_this.config.axis_rotated,isStart=/^start-(start|end)$/.test(type),isEnd=/^end-(start|end)$/.test(type),path=[],x=isRotated?isEnd?v.x-v.width:v.x:v.x+v.width,y=isRotated||isStart?v.y+v.height:v.y;return 0===i?path.push("".concat(x,",").concat(y)):(path.push(isRotated?"L".concat(v.x-(/\w+-end$/.test(type)?v.width:0),",").concat(v.y):"L".concat(v.x,",").concat(v.y+(/\w+-start$/.test(type)?v.height:0))),i<arr.length-1&&path.push("M".concat(x,",").concat(y))),path.join(" ")});node.attr("d","M".concat(path.join(""),"z"))}};function getStrokeDashArray(start,end,pattern,isLastX){void 0===isLastX&&(isLastX=!1);for(var out_i_1,dash=start?[start,0]:pattern,_loop_1=function(i){pattern.forEach(function(v){i+v<=end&&dash.push(v),i+=v}),out_i_1=i},i=start||pattern.reduce(function(a,c){return a+c});i<=end;)_loop_1(i),i=out_i_1;return dash.length%2!=0&&dash.push(isLastX?pattern[1]:0),{dash:dash.join(" "),length:dash.reduce(function(a,b){return a+b},0)}}function getRegions(d,_regions,isTimeSeries){var $$=this,regions=[];if(isDefined(_regions))for(var getValue=function(v,def){return isUndefined(v)?def:isTimeSeries?parseDate.call($$,v):v},i=0,reg=void 0;reg=_regions[i];i++){var start=getValue(reg.start,d[0].x),end=getValue(reg.end,d[d.length-1].x),style=reg.style||{dasharray:"2 2"};regions[i]={start,end,style}}return regions}var shapeLine={initLine:function(){var $el=this.$el;$el.line=$el.main.select(".".concat($COMMON.chart)).append("g").attr("class",$LINE.chartLines).call(this.setCssRule(!1,".".concat($LINE.chartLines),["pointer-events:none"]))},updateTargetsForLine:function(t){var $$=this,_a=$$.$el,area=_a.area,line=_a.line,main=_a.main,classChartLine=$$.getChartClass("Line"),classLines=$$.getClass("lines",!0),classFocus=$$.classFocus.bind($$);line||$$.initLine();var targets=t.filter(function(d){return!($$.isScatterType(d)||$$.isBubbleType(d))}),mainLineUpdate=main.select(".".concat($LINE.chartLines)).selectAll(".".concat($LINE.chartLine)).data($$.filterNullish(targets)).attr("class",function(d){return classChartLine(d)+classFocus(d)}),mainLineEnter=mainLineUpdate.enter().append("g").attr("class",classChartLine).style("opacity","0").style("pointer-events",$$.getStylePropValue("none"));if(mainLineEnter.append("g").attr("class",classLines),$$.hasTypeOf("Area")){var mainLine=(!area&&mainLineEnter.empty()?mainLineUpdate:mainLineEnter).filter($$.isAreaType.bind($$));$$.initArea(mainLine)}$$.updateTargetForCircle(targets,mainLineEnter)},updateLine:function(withTransition,isSub){void 0===isSub&&(isSub=!1);var $$=this,extraLineClasses=$$.format.extraLineClasses,$el=$$.$el,$T=$$.$T,$root=isSub?$el.subchart:$el,line=$root.main.selectAll(".".concat($LINE.lines)).selectAll(".".concat($LINE.line)).data($$.lineData.bind($$));$T(line.exit(),withTransition).style("opacity","0").remove(),$root.line=line.enter().append("path").attr("class",function(d){return"".concat($$.getClass("line",!0)(d)," ").concat(extraLineClasses(d)||"")}).style("stroke",$$.color).merge(line).style("opacity",$$.initialOpacity.bind($$)).attr("transform",null)},redrawLine:function(drawFn,withTransition,isSub){void 0===isSub&&(isSub=!1);var $el=this.$el;return[(0,this.$T)((isSub?$el.subchart:$el).line,withTransition,getRandom()).attr("d",drawFn).style("stroke",this.color).style("opacity",null)]},getCurve:function(d){var $$=this;return $$.config.axis_rotated&&$$.isStepType(d)?function(context){var step=$$.getInterpolate(d)(context);return step.orgPoint=step.point,step.pointRotated=function(x,y){1===this._point&&(this._point=2);var y1=this._y*(1-this._t)+y*this._t;this._context.lineTo(this._x,y1),this._context.lineTo(x,y1),this._x=x,this._y=y},step.point=function(x,y){0===this._point?this.orgPoint(x,y):this.pointRotated(x,y)},step}:$$.getInterpolate(d)},generateDrawLine:function(lineIndices,isSub){var $$=this,config=$$.config,scale=$$.scale,lineConnectNull=config.line_connectNull,isRotated=config.axis_rotated,getPoints=$$.generateGetLinePoints(lineIndices,isSub),yScale=$$.getYScaleById.bind($$),xValue=function(d){return(isSub?$$.subxx:$$.xx).call($$,d)},yValue=function(d,i){return $$.isGrouped(d.id)?getPoints(d,i)[0][1]:yScale(d.id,isSub)($$.getBaseValue(d))},line=src_line();line=isRotated?line.x(yValue).y(xValue):line.x(xValue).y(yValue),lineConnectNull||(line=line.defined(function(d){return null!==$$.getBaseValue(d)}));var x=isSub?scale.subX:scale.x;return function(d){var path,y=yScale(d.id,isSub),values=lineConnectNull?$$.filterRemoveNull(d.values):d.values,x0=0,y0=0;if($$.isLineType(d)){var regions=config.data_regions[d.id];regions?($$.isAreaRangeType(d)&&(values=values.map(function(dv){return __assign(__assign({},dv),{value:$$.getRangedData(dv,"mid")})})),path=$$.lineWithRegions(values,scale.zoom||x,y,regions)):($$.isStepType(d)&&(values=$$.convertValuesToStep(values)),path=line.curve($$.getCurve(d))(values))}else values[0]&&(x0=x(values[0].x),y0=y(values[0].value)),path=isRotated?"M ".concat(y0," ").concat(x0):"M ".concat(x0," ").concat(y0);return path||"M 0 0"}},lineWithRegions:function(d,x,y,_regions){for(var xp,yp,diff,diffx2,$$=this,isRotated=$$.config.axis_rotated,isTimeSeries=$$.axis.isTimeSeries(),regions=getRegions.bind($$)(d,_regions,isTimeSeries),hasNullDataValue=$$.hasNullDataValue(d),xValue=isRotated?function(dt){return y(dt.value)}:function(dt){return x(dt.x)},yValue=isRotated?function(dt){return x(dt.x)}:function(dt){return y(dt.value)},generateM=function(points){return"M".concat(points[0][0],",").concat(points[0][1],"L").concat(points[1][0],",").concat(points[1][1])},sWithRegion=isTimeSeries?function(d0,d1,k,timeseriesDiff){var x0=d0.x.getTime(),xDiff=d1.x-d0.x,xv0=new Date(x0+xDiff*k),xv1=new Date(x0+xDiff*(k+timeseriesDiff)),points=isRotated?[[y(yp(k)),x(xv0)],[y(yp(k+diff)),x(xv1)]]:[[x(xv0),y(yp(k))],[x(xv1),y(yp(k+diff))]];return generateM(points)}:function(d0,d1,k,otherDiff){var x0=x(d1.x,!isRotated),y0=y(d1.value,isRotated),gap=k+otherDiff,xValue=x(xp(k),!isRotated),yValue=y(yp(k),isRotated),xDiff=x(xp(gap),!isRotated),yDiff=y(yp(gap),isRotated);xDiff>x0&&(xDiff=x0),d0.value>d1.value&&(isRotated?yDiff<y0:yDiff>y0)&&(yDiff=y0);var points=[[xValue,yValue],[xDiff,yDiff]];return isRotated&&points.forEach(function(v){return v.reverse()}),generateM(points)},axisType={x:$$.axis.getAxisType("x"),y:$$.axis.getAxisType("y")},path="",target=$$.$el.line.filter(function(_a){return _a.id===d[0].id}),tempNode=target.clone().style("display","none"),getLength=function(node,path){return node.attr("d",path).node().getTotalLength()},dashArray={dash:[],lastLength:0},isLastX=!1,i=0,data=void 0;data=d[i];i++){var prevData=d[i-1],hasPrevData=prevData&&isValue(prevData.value),style=$$.isWithinRegions(data.x,regions);if(isValue(data.value))if(!isUndefined(regions)&&style&&hasPrevData){if(hasPrevData)if(style=((null==style?void 0:style.dasharray)||"2 2").split(" ").map(Number),xp=getScale(axisType.x,prevData.x,data.x),yp=getScale(axisType.y,prevData.value,data.value),hasNullDataValue){var dx=x(data.x)-x(prevData.x),dy=y(data.value)-y(prevData.value),dd=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2));diffx2=(diff=style[0]/dd)*style[1];for(var j=diff;j<=1;j+=diffx2)path+=sWithRegion(prevData,data,j,diff),j+diffx2>=1&&(path+=sWithRegion(prevData,data,1,0))}else{var points=[];if(isLastX=data.x===d[d.length-1].x,isTimeSeries){var x0=+prevData.x,xv0=new Date(x0),xv1=new Date(x0+(+data.x-x0));points=[[x(xv0),y(yp(0))],[x(xv1),y(yp(1))]]}else points=[[x(xp(0)),y(yp(0))],[x(xp(1)),y(yp(1))]];isRotated&&points.forEach(function(v){return v.reverse()});var startLength=getLength(tempNode,path),endLength=getLength(tempNode,path+="L".concat(points[1].join(","))),strokeDashArray=getStrokeDashArray(startLength-dashArray.lastLength,endLength-dashArray.lastLength,style,isLastX);dashArray.lastLength+=strokeDashArray.length,dashArray.dash.push(strokeDashArray.dash)}}else path+="".concat(i&&hasPrevData?"L":"M").concat(xValue(data),",").concat(yValue(data))}return dashArray.dash.length&&(!isLastX&&dashArray.dash.push(getLength(tempNode,path)),tempNode.remove(),target.attr("stroke-dasharray",dashArray.dash.join(" "))),path},isWithinRegions:function(withinX,withinRegions){for(var i=0,reg=void 0;reg=withinRegions[i];i++)if(reg.start<withinX&&withinX<=reg.end)return reg.style;return!1},isWithinStep:function(that,y){return Math.abs(y-getPointer(this.state.event,that)[1])<30},shouldDrawPointsForLine:function(d){var linePoint=this.config.line_point;return!0===linePoint||isArray(linePoint)&&-1!==linePoint.indexOf(d.id)}},getTransitionName=function(){return getRandom()},shapePoint={initialOpacityForCircle:function(d){var config=this.config,withoutFadeIn=this.state.withoutFadeIn,opacity=config.point_opacity;return isUndefined(opacity)&&(opacity=null!==this.getBaseValue(d)&&withoutFadeIn[d.id]?this.opacityForCircle(d):"0"),opacity},opacityForCircle:function(d){var _a,config=this.config,opacity=config.point_opacity;return isUndefined(opacity)&&(opacity=config.point_show&&!(null===(_a=this.isPointFocusOnly)||void 0===_a?void 0:_a.call(this))?null:"0",opacity=isValue(this.getBaseValue(d))?this.isBubbleType(d)||this.isScatterType(d)?"0.5":opacity:"0"),opacity},initCircle:function(){var $$=this,main=$$.$el.main;!$$.point&&($$.point=$$.generatePoint()),($$.hasType("bubble")||$$.hasType("scatter"))&&main.select(".".concat($COMMON.chart," > .").concat($CIRCLE.chartCircles)).empty()&&main.select(".".concat($COMMON.chart)).append("g").attr("class",$CIRCLE.chartCircles)},updateTargetForCircle:function(targetsValue,enterNodeValue){var _this=this,$$=this,config=$$.config,data=$$.data,$el=$$.$el,selectionEnabled=config.interaction_enabled&&config.data_selection_enabled,isSelectable=selectionEnabled&&config.data_selection_isselectable,classCircles=$$.getClass("circles",!0);if(config.point_show){$$.initCircle();var targets=targetsValue,enterNode=enterNodeValue;if(!targets){targets=$$.filterNullish(data.targets).filter(function(d){return _this.isScatterType(d)||_this.isBubbleType(d)});var mainCircle=$el.main.select(".".concat($CIRCLE.chartCircles)).style("pointer-events","none").selectAll(".".concat($CIRCLE.circles)).data(targets);mainCircle.exit().remove(),enterNode=mainCircle.enter()}selectionEnabled&&enterNode.append("g").attr("class",function(d){return $$.generateClass($SELECT.selectedCircles,d.id)}),enterNode.append("g").attr("class",classCircles).call(function(selection){$$.setCssRule(!0,".".concat($CIRCLE.circles),["cursor:pointer"],isSelectable)(selection),$$.setCssRule(!0," .".concat($CIRCLE.circle),["fill","stroke"],$$.color)(selection)}).style("opacity",function(){return src_select(this.parentNode).attr("class").indexOf($CIRCLE.chartCircles)>-1?"0":null}),selectionEnabled&&targets.forEach(function(t){$el.main.selectAll(".".concat($SELECT.selectedCircles).concat($$.getTargetSelectorSuffix(t.id))).selectAll("".concat($SELECT.selectedCircle)).each(function(d){d.value=t.values[d.index].value})})}},updateCircle:function(isSub){void 0===isSub&&(isSub=!1);var $$=this,config=$$.config,state=$$.state,$el=$$.$el,focusOnly=$$.isPointFocusOnly(),$root=isSub?$el.subchart:$el;if(config.point_show&&!state.toggling){config.point_radialGradient&&$$.updateLinearGradient();var circles=$root.main.selectAll(".".concat($CIRCLE.circles)).selectAll(".".concat($CIRCLE.circle)).data(function(d){var data=$$.isLineType(d)&&$$.shouldDrawPointsForLine(d)||$$.isBubbleType(d)||$$.isRadarType(d)||$$.isScatterType(d)?focusOnly?[d.values[0]]:d.values:[];return $$.filterNullish(data)});circles.exit().remove(),circles.enter().filter(Boolean).append($$.point("create",this,$$.pointR.bind($$),$$.updateCircleColor.bind($$))),$root.circle=$root.main.selectAll(".".concat($CIRCLE.circles," .").concat($CIRCLE.circle)).style("stroke",$$.getStylePropValue($$.color)).style("opacity",$$.initialOpacityForCircle.bind($$))}},updateCircleColor:function(d){var fn=this.getStylePropValue(this.color);return this.config.point_radialGradient?this.getGradienColortUrl(d.id):fn?fn(d):null},redrawCircle:function(cx,cy,withTransition,flow,isSub){void 0===isSub&&(isSub=!1);var $$=this,rendered=$$.state.rendered,$el=$$.$el,$T=$$.$T,$root=isSub?$el.subchart:$el,selectedCircles=$root.main.selectAll(".".concat($SELECT.selectedCircle));if(!$$.config.point_show)return[];var fn=$$.point("update",$$,cx,cy,$$.updateCircleColor.bind($$),withTransition,flow,selectedCircles),posAttr=$$.isCirclePoint()?"c":"",t=getRandom(),opacityStyleFn=$$.opacityForCircle.bind($$),mainCircles=[];return $root.circle.each(function(d){var result=fn.bind(this)(d);result=$T(result,withTransition||!rendered,t).style("opacity",opacityStyleFn),mainCircles.push(result)}),[mainCircles,$T(selectedCircles,withTransition).attr("".concat(posAttr,"x"),cx).attr("".concat(posAttr,"y"),cy)]},showCircleFocus:function(d){var $$=this,_a=$$.state,hasRadar=_a.hasRadar,resizing=_a.resizing,toggling=_a.toggling,transiting=_a.transiting,circle=$$.$el.circle;if(!1===transiting&&circle&&$$.isPointFocusOnly()){var cx=(hasRadar?$$.radarCircleX:$$.circleX).bind($$),cy=(hasRadar?$$.radarCircleY:$$.circleY).bind($$),withTransition=toggling||isUndefined(d),fn_1=$$.point("update",$$,cx,cy,$$.getStylePropValue($$.color),!resizing&&withTransition);d&&(circle=circle.filter(function(t){var _a,data=null===(_a=d.filter)||void 0===_a?void 0:_a.call(d,function(v){return v.id===t.id});return!!data.length&&src_select(this).datum(data[0])})),circle.attr("class",this.updatePointClass.bind(this)).style("opacity",null).each(function(d){var id=d.id,index=d.index,value=d.value,visibility="hidden";isValue(value)&&(fn_1.bind(this)(d),$$.expandCircles(index,id),visibility=""),this.style.visibility=visibility})}},hideCircleFocus:function(){var circle=this.$el.circle;this.isPointFocusOnly()&&circle&&(this.unexpandCircles(),circle.style("visibility","hidden"))},circleX:function(d){return this.xx(d)},updateCircleY:function(isSub){void 0===isSub&&(isSub=!1);var $$=this,getPoints=$$.generateGetLinePoints($$.getShapeIndices($$.isLineType),isSub);return function(d,i){var id=d.id;return $$.isGrouped(id)?getPoints(d,i)[0][1]:$$.getYScaleById(id,isSub)($$.getBaseValue(d))}},expandCircles:function(i,id,reset){var $$=this,r=$$.pointExpandedR.bind($$);reset&&$$.unexpandCircles();var circles=$$.getShapeByIndex("circle",i,id).classed($COMMON.EXPANDED,!0),scale=r(circles)/$$.config.point_r,ratio=1-scale;$$.isCirclePoint()?circles.attr("r",r):circles.each(function(){var point=src_select(this);if("circle"===this.tagName)point.attr("r",r);else{var _a=getBBox(this),width=_a.width,height=_a.height,x=ratio*(+point.attr("x")+width/2),y=ratio*(+point.attr("y")+height/2);point.attr("transform","translate(".concat(x," ").concat(y,") scale(").concat(scale,")"))}})},unexpandCircles:function(i){var $$=this,r=$$.pointR.bind($$),circles=$$.getShapeByIndex("circle",i).filter(function(){return src_select(this).classed($COMMON.EXPANDED)}).classed($COMMON.EXPANDED,!1);if(circles.attr("r",r),!$$.isCirclePoint()){var scale=r(circles)/$$.config.point_r;circles.attr("transform",1!==scale?"scale(".concat(scale,")"):null)}},pointR:function(d){var pointR=this.config.point_r,r=pointR;return this.isBubbleType(d)?r=this.getBubbleR(d):isFunction(pointR)&&(r=pointR.bind(this.api)(d)),d.r=r,r},pointExpandedR:function(d){var config=this.config,scale=this.isBubbleType(d)?1.15:1.75;return config.point_focus_expand_enabled?config.point_focus_expand_r||this.pointR(d)*scale:this.pointR(d)},pointSelectR:function(d){var selectR=this.config.point_select_r;return isFunction(selectR)?selectR(d):selectR||4*this.pointR(d)},isPointFocusOnly:function(){return this.config.point_focus_only&&!this.hasType("bubble")&&!this.hasType("scatter")&&!this.hasArcType(null,["radar"])},isWithinCircle:function(node,r){var mouse=getPointer(this.state.event,node),element=src_select(node),prefix=this.isCirclePoint(node)?"c":"",pointSensitivity=this.getPointSensitivity(null==element?void 0:element.datum()),cx=+element.attr("".concat(prefix,"x")),cy=+element.attr("".concat(prefix,"y"));if(!cx&&!cy&&1===node.nodeType){var _a=getBoundingRect(node);cx=_a.x,cy=_a.y}return Math.sqrt(Math.pow(cx-mouse[0],2)+Math.pow(cy-mouse[1],2))<(r||pointSensitivity)},getPointSensitivity:function(d){var sensitivity=this.config.point_sensitivity;return d?(isFunction(sensitivity)?sensitivity=sensitivity.call(this.api,d):"radius"===sensitivity&&(sensitivity=d.r),sensitivity):sensitivity},updatePointClass:function(d){var $$=this,circle=$$.$el.circle,pointClass=!1;return(isObject(d)||circle)&&(pointClass=!0===d?circle.each(function(d){var className=$$.getClass("circle",!0)(d);this.getAttribute("class").indexOf($COMMON.EXPANDED)>-1&&(className+=" ".concat($COMMON.EXPANDED)),this.setAttribute("class",className)}):$$.getClass("circle",!0)(d)),pointClass},generateGetLinePoints:function(lineIndices,isSub){var $$=this,config=$$.config,x=$$.getShapeX(0,lineIndices,isSub),y=$$.getShapeY(isSub),lineOffset=$$.getShapeOffset($$.isLineType,lineIndices,isSub),yScale=$$.getYScaleById.bind($$);return function(d,i){var y0=yScale.call($$,d.id,isSub)($$.getShapeYMin(d.id)),offset=lineOffset(d,i)||y0,posX=x(d),posY=y(d);config.axis_rotated&&(d.value>0&&posY<y0||d.value<0&&y0<posY)&&(posY=y0);var point=[posX,posY-(y0-offset)];return[point,point,point,point]}},custom:{create:function(element,id,fillStyleFn){return element.append("use").attr("xlink:href","#".concat(id)).attr("class",this.updatePointClass.bind(this)).style("fill",fillStyleFn).node()},update:function(element,xPosFn,yPosFn,fillStyleFn,withTransition,flow,selectedCircles){var _a=getBBox(element.node()),width=_a.width,height=_a.height,xPosFn2=function(d){return isValue(d.value)?xPosFn(d)-width/2:0},mainCircles=element;return withTransition&&(flow&&mainCircles.attr("x",xPosFn2),mainCircles=this.$T(mainCircles,withTransition,getTransitionName()),selectedCircles&&this.$T(selectedCircles,withTransition,getTransitionName())),mainCircles.attr("x",xPosFn2).attr("y",function(d){return isValue(d.value)?yPosFn(d)-height/2:0}).style("fill",fillStyleFn)}},circle:{create:function(element,sizeFn,fillStyleFn){return element.append("circle").attr("class",this.updatePointClass.bind(this)).attr("r",sizeFn).style("fill",fillStyleFn).node()},update:function(element,xPosFn,yPosFn,fillStyleFn,withTransition,flow,selectedCircles){var $$=this,mainCircles=element;return $$.hasType("bubble")&&mainCircles.attr("r",$$.pointR.bind($$)),withTransition&&(flow&&mainCircles.attr("cx",xPosFn),mainCircles.attr("cx")&&(mainCircles=$$.$T(mainCircles,withTransition,getTransitionName())),selectedCircles&&$$.$T(mainCircles,withTransition,getTransitionName())),mainCircles.attr("cx",xPosFn).attr("cy",yPosFn).style("fill",fillStyleFn)}},rectangle:{create:function(element,sizeFn,fillStyleFn){var rectSizeFn=function(d){return 2*sizeFn(d)};return element.append("rect").attr("class",this.updatePointClass.bind(this)).attr("width",rectSizeFn).attr("height",rectSizeFn).style("fill",fillStyleFn).node()},update:function(element,xPosFn,yPosFn,fillStyleFn,withTransition,flow,selectedCircles){var r=this.config.point_r,rectXPosFn=function(d){return xPosFn(d)-r},mainCircles=element;return withTransition&&(flow&&mainCircles.attr("x",rectXPosFn),mainCircles=this.$T(mainCircles,withTransition,getTransitionName()),selectedCircles&&this.$T(selectedCircles,withTransition,getTransitionName())),mainCircles.attr("x",rectXPosFn).attr("y",function(d){return yPosFn(d)-r}).style("fill",fillStyleFn)}}};function insertPointInfoDefs(point,id){var _a,copyAttr=function(from,target){for(var name_1,attribs=from.attributes,i=0;name_1=attribs[i];i++)name_1=name_1.name,target.setAttribute(name_1,from.getAttribute(name_1))},node=(new DOMParser).parseFromString(point,"image/svg+xml").documentElement,clone=doc.createElementNS(namespaces.svg,node.nodeName.toLowerCase());if(clone.id=id,clone.style.fill="inherit",clone.style.stroke="inherit",copyAttr(node,clone),null===(_a=node.childNodes)||void 0===_a?void 0:_a.length){var parent_1=src_select(clone);"innerHTML"in clone?parent_1.html(node.innerHTML):toArray(node.childNodes).forEach(function(v){copyAttr(v,parent_1.append(v.tagName).node())})}this.$el.defs.node().appendChild(clone)}var shapePointCommon={hasValidPointType:function(type){return/^(circle|rect(angle)?|polygon|ellipse|use)$/i.test(type||this.config.point_type)},hasLegendDefsPoint:function(){var _a,config=this.config;return config.legend_show&&(null===(_a=config.point_pattern)||void 0===_a?void 0:_a.length)&&config.legend_usePoint},getDefsPointId:function(id){var datetimeId=this.state.datetimeId;return"".concat(datetimeId,"-point").concat(id)},generatePoint:function(){var $$=this,$el=$$.$el,config=$$.config,ids=[],pattern=notEmpty(config.point_pattern)?config.point_pattern:[config.point_type];return function(method,context){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return function(d){var _a,_b,_c,_d,id=$$.getTargetSelectorSuffix(d.id||(null===(_a=d.data)||void 0===_a?void 0:_a.id)||d),element=src_select(this);ids.indexOf(id)<0&&ids.push(id);var point=pattern[ids.indexOf(id)%pattern.length];if($$.hasValidPointType(point))point=$$[point];else if(!function hasValidPointDrawMethods(point){return isObjectType(point)&&isFunction(point.create)&&isFunction(point.update)}(point||config.point_type)){var pointId=$$.getDefsPointId(id);if($el.defs.select("#".concat(pointId)).size()<1&&insertPointInfoDefs.bind($$)(point,pointId),"create"===method)return null===(_b=$$.custom)||void 0===_b?void 0:_b.create.bind(context).apply(void 0,__spreadArray([element,pointId],args,!1));if("update"===method)return null===(_c=$$.custom)||void 0===_c?void 0:_c.update.bind(context).apply(void 0,__spreadArray([element],args,!1))}return null===(_d=point[method])||void 0===_d?void 0:_d.bind(context).apply(void 0,__spreadArray([element],args,!1))}}}};var optPoint={point_show:!0,point_r:2.5,point_radialGradient:!1,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_focus_only:!1,point_opacity:void 0,point_pattern:[],point_select_r:void 0,point_type:"circle"},optArea={area_above:!1,area_below:!1,area_front:!0,area_linearGradient:!1,area_zerobased:!0},optBar={bar_connectLine:!1,bar_front:!1,bar_indices_removeNull:!1,bar_label_threshold:0,bar_linearGradient:!1,bar_overlap:!1,bar_padding:0,bar_radius:void 0,bar_radius_ratio:void 0,bar_sensitivity:2,bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0},optLine={line_connectNull:!1,line_step_type:"step",line_step_tooltipMatch:!1,line_zerobased:!1,line_classes:void 0,line_point:!0},optSpline={spline_interpolation_type:"cardinal"},optArc={arc_cornerRadius:0,arc_cornerRadius_ratio:0,arc_needle_show:!1,arc_needle_color:void 0,arc_needle_value:void 0,arc_needle_path:void 0,arc_needle_length:100,arc_needle_top_rx:0,arc_needle_top_ry:0,arc_needle_top_width:0,arc_needle_bottom_rx:1,arc_needle_bottom_ry:1,arc_needle_bottom_width:15,arc_needle_bottom_len:0,arc_rangeText_values:void 0,arc_rangeText_unit:"absolute",arc_rangeText_fixed:!1,arc_rangeText_format:void 0,arc_rangeText_position:void 0},optDonut={donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_image:void 0,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_rate:.98,donut_expand_duration:50,donut_padAngle:0,donut_startingAngle:0},optPie=(Math.PI,{pie_label_show:!0,pie_label_format:void 0,pie_label_ratio:void 0,pie_label_threshold:.05,pie_label_image:void 0,pie_expand:{},pie_expand_rate:.98,pie_expand_duration:50,pie_innerRadius:0,pie_outerRadius:void 0,pie_padAngle:0,pie_padding:0,pie_startingAngle:0});function extendAxis(module,option){billboard_extend(ChartInternal.prototype,Object.values(internal).concat(module)),billboard_extend(Chart.prototype,api),Options.setOptions(Object.values(options).concat(option||[]))}function extendLine(module,option){extendAxis([shapePointCommon,shapePoint,shapeLine].concat(module||[])),Options.setOptions([optPoint,optLine].concat(option||[]))}function extendArc(module,option){billboard_extend(ChartInternal.prototype,[shapeArc,shapePointCommon].concat(module||[])),Options.setOptions([optPoint].concat(option||[]))}var billboard_area=function(){return extendLine(shapeArea,[optArea]),(billboard_area=function(){return TYPE.AREA})()},line=function(){return extendLine(),(line=function(){return TYPE.LINE})()},spline=function(){return extendLine(void 0,[optSpline]),(spline=function(){return TYPE.SPLINE})()},donut=function(){return extendArc(void 0,[optArc,optDonut]),(donut=function(){return TYPE.DONUT})()},billboard_pie=function(){return extendArc(void 0,[optArc,optPie]),(billboard_pie=function(){return TYPE.PIE})()},bar=function(){return extendAxis([shapeBar,shapePointCommon],[optBar,optPoint]),(bar=function(){return TYPE.BAR})()};var subchart$1=function(domainValue){var _a,domain,$$=this.internal,axis=$$.axis,brush=$$.brush,config=$$.config,_b=$$.scale,x=_b.x,subX=_b.subX,state=$$.state;config.subchart_show&&(domain=domainValue,Array.isArray(domain)?(axis.isTimeSeries()&&(domain=domain.map(function(x){return parseDate.bind($$)(x)})),$$.withinRange(domain,$$.getZoomDomain("subX",!0),$$.getZoomDomain("subX"))&&(state.domain=domain,brush.move(brush.getSelection(),domain.map(subX)))):domain=null!==(_a=state.domain)&&void 0!==_a?_a:x.orgDomain());return domain};billboard_extend(subchart$1,{show:function(){var _a,_b,$$=this.internal,subchart=$$.$el.subchart,config=$$.config,show=config.subchart_show;if(!show){$$.unbindZoomEvent(),config.subchart_show=!show,!subchart.main&&$$.initSubchart();var $target=subchart.main.selectAll(".".concat($COMMON.target));$$.data.targets.length!==$target.size()&&($$.updateSizes(),$$.updateTargetsForSubchart($$.data.targets),$target=null===(_a=subchart.main)||void 0===_a?void 0:_a.selectAll(".".concat($COMMON.target))),null==$target||$target.style("opacity",null),null===(_b=subchart.main)||void 0===_b||_b.style("display",null),this.resize()}},hide:function(){var $$=this.internal,main=$$.$el.subchart.main,config=$$.config;config.subchart_show&&"none"!==(null==main?void 0:main.style("display"))&&(config.subchart_show=!1,main.style("display","none"),this.resize())},toggle:function(){var config=this.internal.config;this.subchart[config.subchart_show?"hide":"show"]()},reset:function(){var brush=this.internal.brush;brush.clear(brush.getSelection())}});var zoom$1=function(domainValue){var _a,domain,$$=this.internal,axis=$$.axis,config=$$.config,org=$$.org,scale=$$.scale,state=$$.state,isCategorized=axis.isCategorized();if(config.zoom_enabled)if(domain=domainValue,Array.isArray(domain)){if(axis.isTimeSeries()&&(domain=domain.map(function(x){return parseDate.bind($$)(x)})),$$.withinRange(domain,$$.getZoomDomain("zoom",!0),$$.getZoomDomain("zoom"))){if(state.domain=domain,domain=$$.getZoomDomainValue(domain),$$.api.tooltip.hide(),config.subchart_show){var x=scale.zoom||scale.x;$$.brush.getSelection().call($$.brush.move,domain.map(x))}else{x=isCategorized?scale.x.orgScale():org.xScale||scale.x;$$.updateCurrentZoomTransform(x,domain)}$$.setZoomResetButton()}}else domain=$$.zoom.getDomain();return null!==(_a=state.domain)&&void 0!==_a?_a:domain};billboard_extend(zoom$1,{enable:function(enabled){var $$=this.internal,config=$$.config;/^(drag|wheel)$/.test(enabled)&&(config.zoom_type=enabled),config.zoom_enabled=!!enabled,$$.zoom?!1===enabled&&$$.bindZoomEvent(!1):($$.initZoom(),$$.bindZoomEvent()),$$.updateAndRedraw()},max:function(max){var $$=this.internal,config=$$.config,xDomain=$$.org.xDomain;return(0===max||max)&&(config.zoom_x_max=getMinMax$1("max",[xDomain[1],max])),config.zoom_x_max},min:function(min){var $$=this.internal,config=$$.config,xDomain=$$.org.xDomain;return(0===min||min)&&(config.zoom_x_min=getMinMax$1("min",[xDomain[0],min])),config.zoom_x_min},range:function(range){var zoom=this.zoom;if(isObject(range)){var min=range.min,max=range.max;isDefined(min)&&zoom.min(min),isDefined(max)&&zoom.max(max)}return{min:zoom.min(),max:zoom.max()}}});var billboard_drag={drag:function(mouse){var $$=this,config=$$.config,state=$$.state,main=$$.$el.main,isSelectionGrouped=config.data_selection_grouped,isSelectable=config.interaction_enabled&&config.data_selection_isselectable;if(!$$.hasArcType()&&config.data_selection_enabled&&(!config.zoom_enabled||$$.zoom.altDomain)&&config.data_selection_multiple){var _a=state.dragStart||[0,0],sx=_a[0],sy=_a[1],mx=mouse[0],my=mouse[1],minX=Math.min(sx,mx),maxX=Math.max(sx,mx),minY=isSelectionGrouped?state.margin.top:Math.min(sy,my),maxY=isSelectionGrouped?state.height:Math.max(sy,my);main.select(".".concat($DRAG.dragarea)).attr("x",minX).attr("y",minY).attr("width",maxX-minX).attr("height",maxY-minY),main.selectAll(".".concat($SHAPE.shapes)).selectAll(".".concat($SHAPE.shape)).filter(function(d){return null==isSelectable?void 0:isSelectable.bind($$.api)(d)}).each(function(d,i){var toggle,shape=src_select(this),isSelected=shape.classed($SELECT.SELECTED),isIncluded=shape.classed($DRAG.INCLUDED),isWithin=!1;if(shape.classed($CIRCLE.circle)){var x=1*+shape.attr("cx"),y=1*+shape.attr("cy");toggle=$$.togglePoint,isWithin=minX<x&&x<maxX&&minY<y&&y<maxY}else{if(!shape.classed($BAR.bar))return;var _a=getPathBox(this),width=(x=_a.x,y=_a.y,_a.width),height=_a.height;toggle=$$.togglePath,isWithin=!(maxX<x||x+width<minX||maxY<y||y+height<minY)}isWithin^isIncluded&&(shape.classed($DRAG.INCLUDED,!isIncluded),shape.classed($SELECT.SELECTED,!isSelected),toggle.call($$,!isSelected,shape,d,i))})}},dragstart:function(mouse){var $$=this,config=$$.config,state=$$.state,main=$$.$el.main;!$$.hasArcType()&&config.data_selection_enabled&&(state.dragStart=mouse,main.select(".".concat($COMMON.chart)).append("rect").attr("class",$DRAG.dragarea).style("opacity","0.1"),$$.setDragStatus(!0))},dragend:function(){var $$=this,config=$$.config,main=$$.$el.main,$T=$$.$T;!$$.hasArcType()&&config.data_selection_enabled&&($T(main.select(".".concat($DRAG.dragarea))).style("opacity","0").remove(),main.selectAll(".".concat($SHAPE.shape)).classed($DRAG.INCLUDED,!1),$$.setDragStatus(!1))}},defaults=(__assign(__assign({},billboard_drag),{selectPoint:function(target,d,i){var $$=this,config=$$.config,main=$$.$el.main,$T=$$.$T,isRotated=config.axis_rotated,cx=(isRotated?$$.circleY:$$.circleX).bind($$),cy=(isRotated?$$.circleX:$$.circleY).bind($$),r=$$.pointSelectR.bind($$);callFn(config.data_onselected,$$.api,d,target.node()),$T(main.select(".".concat($SELECT.selectedCircles).concat($$.getTargetSelectorSuffix(d.id))).selectAll(".".concat($SELECT.selectedCircle,"-").concat(i)).data([d]).enter().append("circle").attr("class",function(){return $$.generateClass($SELECT.selectedCircle,i)}).attr("cx",cx).attr("cy",cy).attr("stroke",$$.color).attr("r",function(d2){return 1.4*$$.pointSelectR(d2)})).attr("r",r)},unselectPoint:function(target,d,i){var $$=this,config=$$.config,main=$$.$el.main,$T=$$.$T;callFn(config.data_onunselected,$$.api,d,null==target?void 0:target.node()),$T(main.select(".".concat($SELECT.selectedCircles).concat($$.getTargetSelectorSuffix(d.id))).selectAll(".".concat($SELECT.selectedCircle,"-").concat(i))).attr("r",0).remove()},togglePoint:function(selected,target,d,i){this["".concat(selected?"":"un","selectPoint")](target,d,i)},selectPath:function(target,d){var config=this.config;callFn(config.data_onselected,this.api,d,target.node()),config.interaction_brighten&&target.style("filter","brightness(1.25)")},unselectPath:function(target,d){var config=this.config;callFn(config.data_onunselected,this.api,d,target.node()),config.interaction_brighten&&target.style("filter",null)},togglePath:function(selected,target,d,i){this["".concat(selected?"":"un","selectPath")](target,d,i)},getToggle:function(that,d){return"path"===that.nodeName?this.togglePath:this.isStepType(d)?function(){}:this.togglePoint},toggleShape:function(that,d,i){var _a,$$=this,config=$$.config,main=$$.$el.main;if(config.data_selection_enabled&&config.data_selection_isselectable.bind($$.api)(d)){var toggledShape_1,shape=src_select(that),isSelected=shape.classed($SELECT.SELECTED),toggle_1=$$.getToggle(that,d).bind($$);if(!config.data_selection_multiple){var focusOnly=null===(_a=$$.isPointFocusOnly)||void 0===_a?void 0:_a.call($$),selector=".".concat(focusOnly?$SELECT.selectedCircles:$SHAPE.shapes);config.data_selection_grouped&&(selector+=$$.getTargetSelectorSuffix(d.id)),main.selectAll(selector).selectAll(focusOnly?".".concat($SELECT.selectedCircle):".".concat($SHAPE.shape,".").concat($SELECT.SELECTED)).classed($SELECT.SELECTED,!1).each(function(d){var shape=src_select(this);toggledShape_1=shape,toggle_1(!1,shape,d,d.index)})}toggledShape_1&&toggledShape_1.node()===shape.node()||(shape.classed($SELECT.SELECTED,!isSelected),toggle_1(!isSelected,shape,d,i))}}}),Object.create(null)),bb={version:"3.17.2",generate:function(config){var options=mergeObj(Object.create(null),defaults,config),inst=new Chart(options);return inst.internal.charts=this.instance,this.instance.push(inst),inst},defaults:function(options){return isObject(options)&&(defaults=options),defaults},instance:[],plugin:{}}},"./node_modules/rxjs/dist/esm5/internal/observable/of.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{of:()=>of});var util_isFunction=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");function last(arr){return arr[arr.length-1]}function popScheduler(args){return function isScheduler(value){return value&&(0,util_isFunction.T)(value.schedule)}(last(args))?args.pop():void 0}var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),isArrayLike=function(x){return x&&"number"==typeof x.length&&"function"!=typeof x};function isPromise(value){return(0,util_isFunction.T)(null==value?void 0:value.then)}var Observable=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),observable=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/symbol/observable.js");function isInteropObservable(input){return(0,util_isFunction.T)(input[observable.s])}function isAsyncIterable(obj){return Symbol.asyncIterator&&(0,util_isFunction.T)(null==obj?void 0:obj[Symbol.asyncIterator])}function createInvalidObservableTypeError(input){return new TypeError("You provided "+(null!==input&&"object"==typeof input?"an invalid object":"'"+input+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var iterator_iterator=function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function isIterable(input){return(0,util_isFunction.T)(null==input?void 0:input[iterator_iterator])}function readableStreamLikeToAsyncGenerator(readableStream){return(0,tslib_es6.AQ)(this,arguments,function readableStreamLikeToAsyncGenerator_1(){var reader,_a,value;return(0,tslib_es6.YH)(this,function(_b){switch(_b.label){case 0:reader=readableStream.getReader(),_b.label=1;case 1:_b.trys.push([1,,9,10]),_b.label=2;case 2:return[4,(0,tslib_es6.N3)(reader.read())];case 3:return _a=_b.sent(),value=_a.value,_a.done?[4,(0,tslib_es6.N3)(void 0)]:[3,5];case 4:return[2,_b.sent()];case 5:return[4,(0,tslib_es6.N3)(value)];case 6:return[4,_b.sent()];case 7:return _b.sent(),[3,2];case 8:return[3,10];case 9:return reader.releaseLock(),[7];case 10:return[2]}})})}function isReadableStreamLike(obj){return(0,util_isFunction.T)(null==obj?void 0:obj.getReader)}var reportUnhandledError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js");function innerFrom(input){if(input instanceof Observable.c)return input;if(null!=input){if(isInteropObservable(input))return function fromInteropObservable(obj){return new Observable.c(function(subscriber){var obs=obj[observable.s]();if((0,util_isFunction.T)(obs.subscribe))return obs.subscribe(subscriber);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(input);if(isArrayLike(input))return function fromArrayLike(array){return new Observable.c(function(subscriber){for(var i=0;i<array.length&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.complete()})}(input);if(isPromise(input))return function fromPromise(promise){return new Observable.c(function(subscriber){promise.then(function(value){subscriber.closed||(subscriber.next(value),subscriber.complete())},function(err){return subscriber.error(err)}).then(null,reportUnhandledError.m)})}(input);if(isAsyncIterable(input))return fromAsyncIterable(input);if(isIterable(input))return function fromIterable(iterable){return new Observable.c(function(subscriber){var e_1,_a;try{for(var iterable_1=(0,tslib_es6.Ju)(iterable),iterable_1_1=iterable_1.next();!iterable_1_1.done;iterable_1_1=iterable_1.next()){var value=iterable_1_1.value;if(subscriber.next(value),subscriber.closed)return}}catch(e_1_1){e_1={error:e_1_1}}finally{try{iterable_1_1&&!iterable_1_1.done&&(_a=iterable_1.return)&&_a.call(iterable_1)}finally{if(e_1)throw e_1.error}}subscriber.complete()})}(input);if(isReadableStreamLike(input))return function fromReadableStreamLike(readableStream){return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream))}(input)}throw createInvalidObservableTypeError(input)}function fromAsyncIterable(asyncIterable){return new Observable.c(function(subscriber){(function process(asyncIterable,subscriber){var asyncIterable_1,asyncIterable_1_1,e_2,_a;return(0,tslib_es6.sH)(this,void 0,void 0,function(){var value,e_2_1;return(0,tslib_es6.YH)(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,11]),asyncIterable_1=(0,tslib_es6.xN)(asyncIterable),_b.label=1;case 1:return[4,asyncIterable_1.next()];case 2:if((asyncIterable_1_1=_b.sent()).done)return[3,4];if(value=asyncIterable_1_1.value,subscriber.next(value),subscriber.closed)return[2];_b.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return e_2_1=_b.sent(),e_2={error:e_2_1},[3,11];case 6:return _b.trys.push([6,,9,10]),asyncIterable_1_1&&!asyncIterable_1_1.done&&(_a=asyncIterable_1.return)?[4,_a.call(asyncIterable_1)]:[3,8];case 7:_b.sent(),_b.label=8;case 8:return[3,10];case 9:if(e_2)throw e_2.error;return[7];case 10:return[7];case 11:return subscriber.complete(),[2]}})})})(asyncIterable,subscriber).catch(function(err){return subscriber.error(err)})})}function executeSchedule(parentSubscription,scheduler,work,delay,repeat){void 0===delay&&(delay=0),void 0===repeat&&(repeat=!1);var scheduleSubscription=scheduler.schedule(function(){work(),repeat?parentSubscription.add(this.schedule(null,delay)):this.unsubscribe()},delay);if(parentSubscription.add(scheduleSubscription),!repeat)return scheduleSubscription}var lift=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/lift.js"),OperatorSubscriber=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js");function observeOn(scheduler,delay){return void 0===delay&&(delay=0),(0,lift.N)(function(source,subscriber){source.subscribe((0,OperatorSubscriber._)(subscriber,function(value){return executeSchedule(subscriber,scheduler,function(){return subscriber.next(value)},delay)},function(){return executeSchedule(subscriber,scheduler,function(){return subscriber.complete()},delay)},function(err){return executeSchedule(subscriber,scheduler,function(){return subscriber.error(err)},delay)}))})}function subscribeOn(scheduler,delay){return void 0===delay&&(delay=0),(0,lift.N)(function(source,subscriber){subscriber.add(scheduler.schedule(function(){return source.subscribe(subscriber)},delay))})}function scheduleAsyncIterable(input,scheduler){if(!input)throw new Error("Iterable cannot be null");return new Observable.c(function(subscriber){executeSchedule(subscriber,scheduler,function(){var iterator=input[Symbol.asyncIterator]();executeSchedule(subscriber,scheduler,function(){iterator.next().then(function(result){result.done?subscriber.complete():subscriber.next(result.value)})},0,!0)})})}function scheduled(input,scheduler){if(null!=input){if(isInteropObservable(input))return function scheduleObservable(input,scheduler){return innerFrom(input).pipe(subscribeOn(scheduler),observeOn(scheduler))}(input,scheduler);if(isArrayLike(input))return function scheduleArray(input,scheduler){return new Observable.c(function(subscriber){var i=0;return scheduler.schedule(function(){i===input.length?subscriber.complete():(subscriber.next(input[i++]),subscriber.closed||this.schedule())})})}(input,scheduler);if(isPromise(input))return function schedulePromise(input,scheduler){return innerFrom(input).pipe(subscribeOn(scheduler),observeOn(scheduler))}(input,scheduler);if(isAsyncIterable(input))return scheduleAsyncIterable(input,scheduler);if(isIterable(input))return function scheduleIterable(input,scheduler){return new Observable.c(function(subscriber){var iterator;return executeSchedule(subscriber,scheduler,function(){iterator=input[iterator_iterator](),executeSchedule(subscriber,scheduler,function(){var _a,value,done;try{value=(_a=iterator.next()).value,done=_a.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():subscriber.next(value)},0,!0)}),function(){return(0,util_isFunction.T)(null==iterator?void 0:iterator.return)&&iterator.return()}})}(input,scheduler);if(isReadableStreamLike(input))return function scheduleReadableStreamLike(input,scheduler){return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input),scheduler)}(input,scheduler)}throw createInvalidObservableTypeError(input)}function of(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return function from(input,scheduler){return scheduler?scheduled(input,scheduler):innerFrom(input)}(args,popScheduler(args))}}}]);