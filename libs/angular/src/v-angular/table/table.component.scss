@use '@sebgroup/chlorophyll/src/scss/tokens/mixin-sys-light-2016' as
  light-tokens;
@use '@sebgroup/chlorophyll/src/scss/tokens/shape';
@use '@sebgroup/chlorophyll/src/scss/components/table/mixins' as table;
@use '../../../../chlorophyll/src/scss/components/checkbox/mixins' as checkbox;
@use '../../../../chlorophyll/src/scss/components/form/mixins' as form-mixins;

:host {
  @include light-tokens.add-variables();
  @include shape.add-tokens();
}

::ng-deep .gds-table {
  @include table.add-table();
  width: 100%;

  border-bottom: none;

  .web-view {
    display: table-cell;
  }

  .mobile-view {
    display: none;
  }

  tr:hover td {
    background-color: var(--gds-sys-color-base-100);
  }

  .gds-table__numeric-col {
    text-align: right;
  }

  thead tr th.gds-table__numeric-col .gds-table-sort {
    justify-content: end;
  }

  th button {
    background-color: rgba(0, 0, 0, 0);
    border: 0;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    padding: 0;
    cursor: pointer;
  }

  tbody {
    border-bottom: var(--sg-table-border-width) solid
      var(--sg-table-border-color);
  }

  td {
    cursor: pointer;
  }

  tfoot {
    border-top: 1px solid;
    border-bottom: none;
    font-weight: var(--sg-table-row-expand-font-weight, 500);

    ::ng-deep {
      td {
        padding: 0.6875rem 0.5rem;
      }
    }
  }

  th.column {
    &__check {
      height: vanilla-px-to-rem(40px - 8px);
      width: vanilla-px-to-rem(40px);

      div {
        min-height: 100%;
      }

      input:checked + label {
        &::after {
          top: 0.6rem;
          display: inline;
        }
      }

      label {
        display: inline;
        padding: 0;

        &::before {
          top: 0.55rem;
        }
      }
    }
  }

  td.column {
    &__check {
      width: vanilla-px-to-rem(40px);

      div {
        min-height: unset;
      }

      label {
        padding: 0;

        &::before {
          margin: 0;
        }
      }
    }
  }

  tr.row {
    &__expand {
      background-color: var(--gds-sys-color-base-100);

      .gds-item-field-wrap {
        display: flex;
        flex-wrap: nowrap;

        &.no-sub-items {
          padding-left: 1.5rem;
        }

        .chevron-field {
          width: 1.5rem;

          svg {
            transition: transform 0.3s ease;
          }

          &[aria-expanded='true'] svg {
            transform: rotate(-180deg);
          }
        }

        .gds-item-field-text {
          padding-left: 0.2rem;
          .gds-item-field-extra-label {
            font-weight: var(--sg-table-row-expand-font-weight-light, 400);
          }
        }
      }

      td {
        font-weight: var(--sg-table-row-expand-font-weight, 500);
      }
    }
  }

  @include checkbox.add-checkbox();

  .gds-field-checkbox-wrap .gds-form-control:has(input[type='checkbox']) {
    @include form-mixins.add-form-control;
    line-height: 1.125rem;
    padding: 0;
  }

  #thead-checkbox input[type='checkbox'] ~ i {
    box-shadow: inset 0 0 0 1px var(--gds-sys-color-text-inverted);
    background-color: transparent;

    &:after {
      box-sizing: border-box;
    }
  }

  #thead-checkbox:has(input[type='checkbox']:focus-visible):focus-within {
    outline-color: var(--gds-sys-color-white);
  }

  #thead-checkbox input[type='checkbox']:hover {
    &:not(:checked) ~ i {
      box-shadow: inset 0 0 0 1px #ababab;

      &::after {
        border-color: #ababab;
      }
    }

    &:checked ~ i {
      box-shadow: inset 0 0 0 1px #ababab;

      &::after {
        border-color: #ababab;
      }
    }
  }
}

@media screen and (max-width: 600px) {
  .gds-table {
    thead {
      display: none;
    }

    .row__expand td:not(:first-child) {
      display: none;
    }

    .row__expand td {
      display: table-cell;
    }

    .web-view {
      display: none;
    }

    .mobile-view {
      display: flex;
      align-items: center;

      .mobile-view-field-wrap {
        display: grid;
        grid-template-columns: 1fr 1fr;
        width: 100%;

        .mobile-view-field {
          display: flex;
          flex-direction: column;
          padding-bottom: 0.3rem;

          &:nth-child(2n + 1) {
            justify-self: start;
            align-items: start;
            text-align: start;
          }

          &:nth-child(2n) {
            align-items: end;
            justify-self: end;
            text-align: end;
          }
        }
      }

      .nav-chevron-field {
        width: 1.5rem;
        padding-left: 0.5rem;

        svg {
          transition: transform 0.3s ease;
        }

        &[aria-expanded='true'] svg {
          transform: rotate(-90deg);
        }
      }

      .settings-field {
        width: 1.5rem;
        padding: 0 1rem;

        svg {
          transition: all 0.3s ease;
        }

        &:hover svg {
          fill: var(--gds-sys-color-blue-dark-2);
        }
      }
    }
  }
}
