"use strict";(self.webpackChunkgreen=self.webpackChunkgreen||[]).push([[6964],{"./node_modules/dagre-d3-es/src/graphlib/json.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>write});var lodash_es__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash-es/isUndefined.js"),lodash_es__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash-es/clone.js"),lodash_es__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/lodash-es/map.js");__webpack_require__("./node_modules/dagre-d3-es/src/graphlib/graph.js");function write(g){var json={options:{directed:g.isDirected(),multigraph:g.isMultigraph(),compound:g.isCompound()},nodes:writeNodes(g),edges:writeEdges(g)};return lodash_es__WEBPACK_IMPORTED_MODULE_1__.A(g.graph())||(json.value=lodash_es__WEBPACK_IMPORTED_MODULE_2__.A(g.graph())),json}function writeNodes(g){return lodash_es__WEBPACK_IMPORTED_MODULE_3__.A(g.nodes(),(function(v){var nodeValue=g.node(v),parent=g.parent(v),node={v};return lodash_es__WEBPACK_IMPORTED_MODULE_1__.A(nodeValue)||(node.value=nodeValue),lodash_es__WEBPACK_IMPORTED_MODULE_1__.A(parent)||(node.parent=parent),node}))}function writeEdges(g){return lodash_es__WEBPACK_IMPORTED_MODULE_3__.A(g.edges(),(function(e){var edgeValue=g.edge(e),edge={v:e.v,w:e.w};return lodash_es__WEBPACK_IMPORTED_MODULE_1__.A(e.name)||(edge.name=e.name),lodash_es__WEBPACK_IMPORTED_MODULE_1__.A(edgeValue)||(edge.value=edgeValue),edge}))}},"./node_modules/lodash-es/clone.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _baseClone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_baseClone.js");const __WEBPACK_DEFAULT_EXPORT__=function clone(value){return(0,_baseClone_js__WEBPACK_IMPORTED_MODULE_0__.A)(value,4)}},"./node_modules/mermaid/dist/index-01f381cb.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>render});var dagre_d3_es_src_dagre_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dagre-d3-es/src/dagre/index.js"),dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/dagre-d3-es/src/graphlib/json.js"),_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/mermaid/dist/edges-066a5561.js"),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/mermaid/dist/mermaid-6dc72991.js"),dagre_d3_es_src_graphlib_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/dagre-d3-es/src/graphlib/index.js"),_createText_ca0c5216_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/mermaid/dist/createText-ca0c5216.js"),d3__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/d3/src/index.js");let clusterDb={},descendants={},parents={};const isDescendant=(id,ancestorId)=>(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("In isDescendant",ancestorId," ",id," = ",descendants[ancestorId].includes(id)),!!descendants[ancestorId].includes(id)),copy=(clusterId,graph,newGraph,rootId)=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Copying children of ",clusterId,"root",rootId,"data",graph.node(clusterId),rootId);const nodes=graph.children(clusterId)||[];clusterId!==rootId&&nodes.push(clusterId),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Copying (nodes) clusterId",clusterId,"nodes",nodes),nodes.forEach((node=>{if(graph.children(node).length>0)copy(node,graph,newGraph,rootId);else{const data=graph.node(node);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("cp ",node," to ",rootId," with parent ",clusterId),newGraph.setNode(node,data),rootId!==graph.parent(node)&&(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Setting parent",node,graph.parent(node)),newGraph.setParent(node,graph.parent(node))),clusterId!==rootId&&node!==clusterId?(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Setting parent",node,clusterId),newGraph.setParent(node,clusterId)):(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("In copy ",clusterId,"root",rootId,"data",graph.node(clusterId),rootId),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Not Setting parent for node=",node,"cluster!==rootId",clusterId!==rootId,"node!==clusterId",node!==clusterId));const edges=graph.edges(node);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Copying Edges",edges),edges.forEach((edge=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge",edge);const data2=graph.edge(edge.v,edge.w,edge.name);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge data",data2,rootId);try{((edge,clusterId)=>(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Descendants of ",clusterId," is ",descendants[clusterId]),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge is ",edge),edge.v!==clusterId&&edge.w!==clusterId&&(descendants[clusterId]?descendants[clusterId].includes(edge.v)||isDescendant(edge.v,clusterId)||isDescendant(edge.w,clusterId)||descendants[clusterId].includes(edge.w):(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Tilt, ",clusterId,",not in descendants"),!1))))(edge,rootId)?(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Copying as ",edge.v,edge.w,data2,edge.name),newGraph.setEdge(edge.v,edge.w,data2,edge.name),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("newGraph edges ",newGraph.edges(),newGraph.edge(newGraph.edges()[0]))):_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Skipping copy of edge ",edge.v,"--\x3e",edge.w," rootId: ",rootId," clusterId:",clusterId)}catch(e){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.error(e)}}))}_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Removing node",node),graph.removeNode(node)}))},extractDescendants=(id,graph)=>{const children=graph.children(id);let res=[...children];for(const child of children)parents[child]=id,res=[...res,...extractDescendants(child,graph)];return res},findNonClusterChild=(id,graph)=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Searching",id);const children=graph.children(id);if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Searching children of id ",id,children),children.length<1)return _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("This is a valid node",id),id;for(const child of children){const _id=findNonClusterChild(child,graph);if(_id)return _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Found replacement for",id," => ",_id),_id}},getAnchorId=id=>clusterDb[id]&&clusterDb[id].externalConnections&&clusterDb[id]?clusterDb[id].id:id,extractor=(graph,depth)=>{if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("extractor - ",depth,dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph),graph.children("D")),depth>10)return void _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.error("Bailing out");let nodes=graph.nodes(),hasChildren=!1;for(const node of nodes){const children=graph.children(node);hasChildren=hasChildren||children.length>0}if(hasChildren){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Nodes = ",nodes,depth);for(const node of nodes)if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Extracting node",node,clusterDb,clusterDb[node]&&!clusterDb[node].externalConnections,!graph.parent(node),graph.node(node),graph.children("D")," Depth ",depth),clusterDb[node])if(!clusterDb[node].externalConnections&&graph.children(node)&&graph.children(node).length>0){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Cluster without external connections, without a parent and with children",node,depth);let dir="TB"===graph.graph().rankdir?"LR":"TB";clusterDb[node]&&clusterDb[node].clusterData&&clusterDb[node].clusterData.dir&&(dir=clusterDb[node].clusterData.dir,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fixing dir",clusterDb[node].clusterData.dir,dir));const clusterGraph=new dagre_d3_es_src_graphlib_index_js__WEBPACK_IMPORTED_MODULE_2__.T({multigraph:!0,compound:!0}).setGraph({rankdir:dir,nodesep:50,ranksep:50,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}}));_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Old graph before copy",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph)),copy(node,graph,clusterGraph,node),graph.setNode(node,{clusterNode:!0,id:node,clusterData:clusterDb[node].clusterData,labelText:clusterDb[node].labelText,graph:clusterGraph}),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("New graph after copy node: (",node,")",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(clusterGraph)),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Old graph after copy",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph))}else _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Cluster ** ",node," **not meeting the criteria !externalConnections:",!clusterDb[node].externalConnections," no parent: ",!graph.parent(node)," children ",graph.children(node)&&graph.children(node).length>0,graph.children("D"),depth),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug(clusterDb);else _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Not a cluster",node,depth);nodes=graph.nodes(),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("New list of nodes",nodes);for(const node of nodes){const data=graph.node(node);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn(" Now next level",node,data),data.clusterNode&&extractor(data.graph,depth+1)}}else _mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Done, no node has children",graph.nodes())},sorter=(graph,nodes)=>{if(0===nodes.length)return[];let result=Object.assign(nodes);return nodes.forEach((node=>{const children=graph.children(node),sorted=sorter(graph,children);result=[...result,...sorted]})),result},shapes={rect:(parent,node)=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Creating subgraph rect for ",node.id,node);const siteConfig=(0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.c)(),shapeSvg=parent.insert("g").attr("class","cluster"+(node.class?" "+node.class:"")).attr("id",node.id),rect2=shapeSvg.insert("rect",":first-child"),useHtmlLabels=(0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.m)(siteConfig.flowchart.htmlLabels),label=shapeSvg.insert("g").attr("class","cluster-label"),text="markdown"===node.labelType?(0,_createText_ca0c5216_js__WEBPACK_IMPORTED_MODULE_5__.a)(label,node.labelText,{style:node.labelStyle,useHtmlLabels}):label.node().appendChild((0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.c)(node.labelText,node.labelStyle,void 0,!0));let bbox=text.getBBox();if((0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.m)(siteConfig.flowchart.htmlLabels)){const div=text.children[0],dv=(0,d3__WEBPACK_IMPORTED_MODULE_3__.Ltv)(text);bbox=div.getBoundingClientRect(),dv.attr("width",bbox.width),dv.attr("height",bbox.height)}const padding=0*node.padding,halfPadding=padding/2,width=node.width<=bbox.width+padding?bbox.width+padding:node.width;node.width<=bbox.width+padding?node.diff=(bbox.width-node.width)/2-node.padding/2:node.diff=-node.padding/2,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Data ",node,JSON.stringify(node)),rect2.attr("style",node.style).attr("rx",node.rx).attr("ry",node.ry).attr("x",node.x-width/2).attr("y",node.y-node.height/2-halfPadding).attr("width",width).attr("height",node.height+padding);const{subGraphTitleTopMargin}=(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.g)(siteConfig);useHtmlLabels?label.attr("transform",`translate(${node.x-bbox.width/2}, ${node.y-node.height/2+subGraphTitleTopMargin})`):label.attr("transform",`translate(${node.x}, ${node.y-node.height/2+subGraphTitleTopMargin})`);const rectBox=rect2.node().getBBox();return node.width=rectBox.width,node.height=rectBox.height,node.intersect=function(point){return(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.i)(node,point)},shapeSvg},roundedWithTitle:(parent,node)=>{const siteConfig=(0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.c)(),shapeSvg=parent.insert("g").attr("class",node.classes).attr("id",node.id),rect2=shapeSvg.insert("rect",":first-child"),label=shapeSvg.insert("g").attr("class","cluster-label"),innerRect=shapeSvg.append("rect"),text=label.node().appendChild((0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.c)(node.labelText,node.labelStyle,void 0,!0));let bbox=text.getBBox();if((0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.m)(siteConfig.flowchart.htmlLabels)){const div=text.children[0],dv=(0,d3__WEBPACK_IMPORTED_MODULE_3__.Ltv)(text);bbox=div.getBoundingClientRect(),dv.attr("width",bbox.width),dv.attr("height",bbox.height)}bbox=text.getBBox();const padding=0*node.padding,halfPadding=padding/2,width=node.width<=bbox.width+node.padding?bbox.width+node.padding:node.width;node.width<=bbox.width+node.padding?node.diff=(bbox.width+0*node.padding-node.width)/2:node.diff=-node.padding/2,rect2.attr("class","outer").attr("x",node.x-width/2-halfPadding).attr("y",node.y-node.height/2-halfPadding).attr("width",width+padding).attr("height",node.height+padding),innerRect.attr("class","inner").attr("x",node.x-width/2-halfPadding).attr("y",node.y-node.height/2-halfPadding+bbox.height-1).attr("width",width+padding).attr("height",node.height+padding-bbox.height-3);const{subGraphTitleTopMargin}=(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.g)(siteConfig);label.attr("transform",`translate(${node.x-bbox.width/2}, ${node.y-node.height/2-node.padding/3+((0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.m)(siteConfig.flowchart.htmlLabels)?5:3)+subGraphTitleTopMargin})`);const rectBox=rect2.node().getBBox();return node.height=rectBox.height,node.intersect=function(point){return(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.i)(node,point)},shapeSvg},noteGroup:(parent,node)=>{const shapeSvg=parent.insert("g").attr("class","note-cluster").attr("id",node.id),rect2=shapeSvg.insert("rect",":first-child"),padding=0*node.padding,halfPadding=padding/2;rect2.attr("rx",node.rx).attr("ry",node.ry).attr("x",node.x-node.width/2-halfPadding).attr("y",node.y-node.height/2-halfPadding).attr("width",node.width+padding).attr("height",node.height+padding).attr("fill","none");const rectBox=rect2.node().getBBox();return node.width=rectBox.width,node.height=rectBox.height,node.intersect=function(point){return(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.i)(node,point)},shapeSvg},divider:(parent,node)=>{const shapeSvg=parent.insert("g").attr("class",node.classes).attr("id",node.id),rect2=shapeSvg.insert("rect",":first-child"),padding=0*node.padding,halfPadding=padding/2;rect2.attr("class","divider").attr("x",node.x-node.width/2-halfPadding).attr("y",node.y-node.height/2).attr("width",node.width+padding).attr("height",node.height+padding);const rectBox=rect2.node().getBBox();return node.width=rectBox.width,node.height=rectBox.height,node.diff=-node.padding/2,node.intersect=function(point){return(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.i)(node,point)},shapeSvg}};let clusterElems={};const recursiveRender=async(_elem,graph,diagramType,id,parentCluster,siteConfig)=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Graph in recursive render: XXX",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph),parentCluster);const dir=graph.graph().rankdir;_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Dir in recursive render - dir:",dir);const elem=_elem.insert("g").attr("class","root");graph.nodes()?_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Recursive render XXX",graph.nodes()):_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("No nodes found for",graph),graph.edges().length>0&&_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Recursive edges",graph.edge(graph.edges()[0]));const clusters=elem.insert("g").attr("class","clusters"),edgePaths=elem.insert("g").attr("class","edgePaths"),edgeLabels=elem.insert("g").attr("class","edgeLabels"),nodes=elem.insert("g").attr("class","nodes");await Promise.all(graph.nodes().map((async function(v){const node=graph.node(v);if(void 0!==parentCluster){const data=JSON.parse(JSON.stringify(parentCluster.clusterData));_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Setting data for cluster XXX (",v,") ",data,parentCluster),graph.setNode(parentCluster.id,data),graph.parent(v)||(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Setting parent",v,parentCluster.id),graph.setParent(v,parentCluster.id,data))}if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("(Insert) Node XXX"+v+": "+JSON.stringify(graph.node(v))),node&&node.clusterNode){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Cluster identified",v,node.width,graph.node(v));const o=await recursiveRender(nodes,node.graph,diagramType,id,graph.node(v),siteConfig),newEl=o.elem;(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.u)(node,newEl),node.diff=o.diff||0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Node bounds (abc123)",v,node,node.width,node.x,node.y),(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.s)(newEl,node),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Recursive render complete ",newEl,node)}else graph.children(v).length>0?(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Cluster - the non recursive path XXX",v,node.id,node,graph),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info(findNonClusterChild(node.id,graph)),clusterDb[node.id]={id:findNonClusterChild(node.id,graph),node}):(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Node - the non recursive path",v,node.id,node),await(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.e)(nodes,graph.node(v),dir))}))),graph.edges().forEach((function(e){const edge=graph.edge(e.v,e.w,e.name);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(e)),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge "+e.v+" -> "+e.w+": ",e," ",JSON.stringify(graph.edge(e))),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Fix",clusterDb,"ids:",e.v,e.w,"Translating: ",clusterDb[e.v],clusterDb[e.w]),(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.f)(edgeLabels,edge)})),graph.edges().forEach((function(e){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(e))})),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("#############################################"),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("###                Layout                 ###"),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("#############################################"),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info(graph),(0,dagre_d3_es_src_dagre_index_js__WEBPACK_IMPORTED_MODULE_0__.Zp)(graph),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Graph after layout:",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph));let diff=0;const{subGraphTitleTotalMargin}=(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.g)(siteConfig);return(graph=>sorter(graph,graph.children()))(graph).forEach((function(v){const node=graph.node(v);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Position "+v+": "+JSON.stringify(graph.node(v))),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Position "+v+": ("+node.x,","+node.y,") width: ",node.width," height: ",node.height),node&&node.clusterNode?(node.y+=subGraphTitleTotalMargin,(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.p)(node)):graph.children(v).length>0?(node.height+=subGraphTitleTotalMargin,((elem,node)=>{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace("Inserting cluster");const shape=node.shape||"rect";clusterElems[node.id]=shapes[shape](elem,node)})(clusters,node),clusterDb[node.id].node=node):(node.y+=subGraphTitleTotalMargin/2,(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.p)(node))})),graph.edges().forEach((function(e){const edge=graph.edge(e);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(edge),edge),edge.points.forEach((point=>point.y+=subGraphTitleTotalMargin/2));const paths=(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.h)(edgePaths,e,edge,clusterDb,diagramType,graph,id);(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.j)(edge,paths)})),graph.nodes().forEach((function(v){const n=graph.node(v);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.info(v,n.type,n.diff),"group"===n.type&&(diff=n.diff)})),{elem,diff}},render=async(elem,graph,markers,diagramType,id)=>{(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.a)(elem,markers,diagramType,id),(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.b)(),(0,_edges_066a5561_js__WEBPACK_IMPORTED_MODULE_6__.d)(),clusterElems={},descendants={},parents={},clusterDb={},_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Graph at first:",JSON.stringify(dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph))),((graph,depth)=>{if(!graph||depth>10)_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Opting out, no graph ");else{_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Opting in, graph "),graph.nodes().forEach((function(id){graph.children(id).length>0&&(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Cluster identified",id," Replacement id in edges: ",findNonClusterChild(id,graph)),descendants[id]=extractDescendants(id,graph),clusterDb[id]={id:findNonClusterChild(id,graph),clusterData:graph.node(id)})})),graph.nodes().forEach((function(id){const children=graph.children(id),edges=graph.edges();children.length>0?(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Cluster identified",id,descendants),edges.forEach((edge=>{edge.v!==id&&edge.w!==id&&isDescendant(edge.v,id)^isDescendant(edge.w,id)&&(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Edge: ",edge," leaves cluster ",id),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Descendants of XXX ",id,": ",descendants[id]),clusterDb[id].externalConnections=!0)}))):_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.debug("Not a cluster ",id,descendants)}));for(let id of Object.keys(clusterDb)){const nonClusterChild=clusterDb[id].id,parent=graph.parent(nonClusterChild);parent!==id&&clusterDb[parent]&&!clusterDb[parent].externalConnections&&(clusterDb[id].id=parent)}graph.edges().forEach((function(e){const edge=graph.edge(e);_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(e)),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(graph.edge(e)));let v=e.v,w=e.w;if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fix XXX",clusterDb,"ids:",e.v,e.w,"Translating: ",clusterDb[e.v]," --- ",clusterDb[e.w]),clusterDb[e.v]&&clusterDb[e.w]&&clusterDb[e.v]===clusterDb[e.w]){_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fixing and trixing link to self - removing XXX",e.v,e.w,e.name),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fixing and trixing - removing XXX",e.v,e.w,e.name),v=getAnchorId(e.v),w=getAnchorId(e.w),graph.removeEdge(e.v,e.w,e.name);const specialId=e.w+"---"+e.v;graph.setNode(specialId,{domId:specialId,id:specialId,labelStyle:"",labelText:edge.label,padding:0,shape:"labelRect",style:""});const edge1=structuredClone(edge),edge2=structuredClone(edge);edge1.label="",edge1.arrowTypeEnd="none",edge2.label="",edge1.fromCluster=e.v,edge2.toCluster=e.v,graph.setEdge(v,specialId,edge1,e.name+"-cyclic-special"),graph.setEdge(specialId,w,edge2,e.name+"-cyclic-special")}else if(clusterDb[e.v]||clusterDb[e.w]){if(_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fixing and trixing - removing XXX",e.v,e.w,e.name),v=getAnchorId(e.v),w=getAnchorId(e.w),graph.removeEdge(e.v,e.w,e.name),v!==e.v){const parent=graph.parent(v);clusterDb[parent].externalConnections=!0,edge.fromCluster=e.v}if(w!==e.w){const parent=graph.parent(w);clusterDb[parent].externalConnections=!0,edge.toCluster=e.w}_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Fix Replacing with XXX",v,w,e.name),graph.setEdge(v,w,edge,e.name)}})),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Adjusted Graph",dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph)),extractor(graph,0),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.trace(clusterDb)}})(graph),_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.l.warn("Graph after:",JSON.stringify(dagre_d3_es_src_graphlib_json_js__WEBPACK_IMPORTED_MODULE_1__.M(graph)));const siteConfig=(0,_mermaid_6dc72991_js__WEBPACK_IMPORTED_MODULE_4__.c)();await recursiveRender(elem,graph,diagramType,id,void 0,siteConfig)}}}]);